#Region "Compile Options"
Option Strict Off
Option Explicit On
#End Region
#Region "Import Namespaces"
Imports OpenQA.Selenium.Firefox
Imports OpenQA.Selenium.IE
Imports OpenQA.Selenium.Chrome
Imports OpenQA.Selenium
Imports OpenQA.Selenium.Support.UI
Imports OpenQA.Selenium.Interactions
Imports Selenium.DefaultSelenium
Imports System.Collections.ObjectModel
Imports SNAGITLib
Imports MosaicDBAccess
Imports System.Text
Imports System
Imports System.Data
Imports System.Data.SqlClient
Imports System.Linq
Imports System.Xml
Imports System.Data.DataTableExtensions
Imports System.IO
Imports Microsoft.Office.Interop
Imports Oracle.DataAccess.Client







#End Region
Public Class ClassFunctions



    Public myLocator As LocatorAdvance
    Public allLocators As List(Of LocatorAdvance) = New List(Of LocatorAdvance)
    Public dt As DataTable = New DataTable()
    Dim WaitForTime As Integer = 20

    Dim allActivity As List(Of activityTypeForSelectedAppType) = New List(Of activityTypeForSelectedAppType)


    Public Sub New()

        'The locators class is used to define methods and information for locating html elements on page.

        myLocator = New LocatorAdvance()

        myLocator.sName = "loginButton"
        myLocator.sID = "loginButton"
        myLocator.AbsoluteXPATH = "//input[@id='loginButton']"
        myLocator.RelativeXPATH = "//input[@id='loginButton']"
        myLocator.s_LookupKey = "MockLogin"
        allLocators.Add(myLocator)

        myLocator = New LocatorAdvance()

        myLocator.sName = "pageTemplateForm:userName"
        myLocator.sID = "pageTemplateForm:userName"
        myLocator.AbsoluteXPATH = "pageTemplateForm:userName"
        myLocator.RelativeXPATH = "pageTemplateForm:userName"
        myLocator.s_LookupKey = "MockLogin"

        allLocators.Add(myLocator)




        dt.Columns.Add("sName", GetType(String))
        dt.Columns.Add("sID", GetType(String))
        dt.Columns.Add("AbsoluteXPATH", GetType(String))
        dt.Columns.Add("RelativeXPATH", GetType(String))
        dt.Columns.Add("LookupKey", GetType(String))

        'locator values for project type and name
        dt.Rows.Add("ProjectName", "pname", "//input[@id='pname']", "Intiate application")
        dt.Rows.Add("ProjectType", "ptype", "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[2]/td/table/tbody/tr/td[2]/select", "Intiate application")

        'locator values for Login id and Paswword use for non mock Loging)
        dt.Rows.Add("user", "placeholder", "//input[@name=user]", "/html/body/form/table[2]/tbody/tr[2]/td/table/tbody/tr[4]/td[2]/input", "NonMockLogin")
        dt.Rows.Add("password", "placeholder", "//input[@name='password']", "/html/body/form/table[2]/tbody/tr[2]/td/table/tbody/tr[5]/td[2]/input", "NonMockLogin")
        dt.Rows.Add("submitButton", "submitButton", "//input[@id='submitButton']", "/html/body/form/table[2]/tbody/tr[2]/td/table/tbody/tr[7]/td[2]/input", "NonMockLogin")
    End Sub
    Public Class AutomationObject

        Private _Object As Object = Nothing
        Private _Element As IWebElement = Nothing

        Public Property aObject() As Object
            Get
                Return _Object
            End Get
            Set(ByVal value As Object)
                _Object = value
            End Set
        End Property
        Public Property aElement() As IWebElement
            Get
                Return _Element
            End Get
            Set(ByVal value As IWebElement)
                _Element = value
            End Set
        End Property



    End Class
    Public Class activityTypeForSelectedAppType

        Private _sLocType As String
        Private _iLocNumber As Integer

        Public Property sLocType() As String
            Get
                Return _sLocType.ToString
            End Get
            Set(ByVal value As String)
                _sLocType = value
            End Set
        End Property

        Public Property iLocNumber() As Integer
            Get
                Return _iLocNumber
            End Get
            Set(ByVal value As Integer)
                _iLocNumber = value
            End Set
        End Property
    End Class
    Public Class Locator
        Private _name As String
        Private _loctype As String
        Private _locText As String
        Private _PageName As String
        Private _LookupKey As String

        Public Property sName() As String
            Get
                Return _name.ToString
            End Get
            Set(ByVal value As String)
                _name = value
            End Set
        End Property

        Public Property sLocType() As String
            Get
                Return _loctype.ToString()
            End Get
            Set(ByVal value As String)
                _loctype = value
            End Set
        End Property

        Public Property sLocText() As String
            Get
                Return _locText.ToString()
            End Get
            Set(ByVal value As String)
                _locText = value
            End Set
        End Property

        Public Property sPageName() As String
            Get
                Return _PageName.ToString()
            End Get
            Set(ByVal value As String)
                _PageName = value
            End Set
        End Property

        Public Property s_LookupKey() As String
            Get
                Return _LookupKey.ToString
            End Get
            Set(ByVal value As String)
                _LookupKey = value
            End Set
        End Property


    End Class
    Public Class LocatorAdvance



        Private _name As String
        Private _ID As String
        Private _AbsoluteXPATH As String
        Private _RelativeXPATH As String
        Private _LookupKey As String

        Public Property sName() As String
            Get
                Return _name.ToString
            End Get
            Set(ByVal value As String)
                _name = value
            End Set
        End Property

        Public Property sID() As String
            Get
                Return _ID.ToString()
            End Get
            Set(ByVal value As String)
                _ID = value
            End Set
        End Property

        Public Property AbsoluteXPATH() As String
            Get
                Return _AbsoluteXPATH.ToString()
            End Get
            Set(ByVal value As String)
                _AbsoluteXPATH = value
            End Set
        End Property

        Public Property RelativeXPATH() As String
            Get
                Return _RelativeXPATH.ToString()
            End Get
            Set(ByVal value As String)
                _RelativeXPATH = value
            End Set
        End Property

        Public Property s_LookupKey() As String
            Get
                Return _LookupKey.ToString
            End Get
            Set(ByVal value As String)
                _LookupKey = value
            End Set
        End Property

        Public Function FindElementOnPage(ByRef driver As IWebDriver, ByVal sName As String, ByVal sID As String, ByVal sByRelXPath As String, sByAbsXPath As String, ByVal sControlType As String) As IWebElement
            Const WaitTime As Integer = 2
            Dim retval As IWebElement = Nothing
            Dim c As New ClassFunctions()

            Console.WriteLine("Trying find by ID")
            retval = c.WaitForElement(driver, WaitTime, By.Id(sID))
            If retval Is Nothing Then
                Console.WriteLine("Trying find by name")
                retval = c.WaitForElement(driver, WaitTime, By.Name(sName))
                If retval Is Nothing Then
                    Console.WriteLine("Trying find by relative XPath")
                    retval = c.WaitForElement(driver, WaitTime, By.XPath(sByRelXPath))
                    If retval Is Nothing Then
                        Console.WriteLine("Trying find by absolute XPath")
                        retval = c.WaitForElement(driver, WaitTime, By.XPath(sByAbsXPath))
                    End If
                End If
            End If
            FindElementOnPage = retval
        End Function
        'Public Function FindElementOnPage(ByRef driver As IWebDriver, ByVal sName As String, ByVal sID As String, ByVal sByRelXPath As String, sByAbsXPath As String, ByVal sControlType As String) As IWebElement

        '    Const WaitTime As Integer = 10
        '    Dim retval As IWebElement = Nothing
        '    Dim c As New ClassFunctions()



        '    Try
        '        'Check for element using the id

        '        If c.WaitForElement(WaitTime, By.Id(sID)) Is Nothing Then
        '            If c.WaitForElement(WaitTime, By.XPath(sByRelXPath)) Is Nothing Then
        '                If c.WaitForElement(WaitTime, By.XPath(sByAbsXPath)) Is Nothing Then
        '                Else
        '                    retval = driver.FindElement(By.XPath(sByAbsXPath))
        '                End If
        '            Else
        '                retval = driver.FindElement(By.XPath(sByRelXPath))
        '            End If
        '        Else
        '            retval = driver.FindElement(By.Id(sID))
        '        End If



        '        'Check all input fields
        '        If retval Is Nothing Then
        '            Dim AllInputFields As IList(Of IWebElement)


        '            AllInputFields = CType(driver.FindElements(By.XPath("//" & sControlType)), IList(Of IWebElement))
        '            For Each element As IWebElement In AllInputFields
        '                Debug.Print(element.GetAttribute("Name"))
        '                If sName.ToUpper.ToString = "SUBMITBUTTON" Then
        '                    If Not element.GetAttribute("id").ToUpper.ToString() Is Nothing Then
        '                        If element.GetAttribute("id").ToUpper.ToString() = sName.ToUpper.ToString Then
        '                            retval = element
        '                        End If
        '                    End If
        '                Else
        '                    If Not element.GetAttribute("Name").ToUpper.ToString() Is Nothing Then
        '                        If element.GetAttribute("Name").ToUpper.ToString() = sName.ToUpper.ToString Then
        '                            retval = element
        '                        End If
        '                    End If
        '                End If


        '            Next
        '        End If



        '    Catch ex As Exception
        '        Dim msg As String = ex.Message

        '    End Try

        '    FindElementOnPage = retval


        'End Function

        Public Function CheckAttribute(ByVal Expression As Object) As Boolean
            Dim mycheck As Boolean = False

            Try

                mycheck = IsError(Expression)


            Catch ex As Exception
                CheckAttribute = False

            End Try

            CheckAttribute = mycheck

        End Function
    End Class

    
#Region "Class Properties"

    Property LogPath() As String
        Get
            Return myLogPath
        End Get
        Set(ByVal value As String)
            myLogPath = value
        End Set
    End Property

    Property ExecutableHistoryRecordID() As Integer
        Get
            Return myExecutableHistoryRecordID
        End Get
        Set(ByVal value As Integer)
            myExecutableHistoryRecordID = value
        End Set
    End Property

#End Region
#Region "Private variables"
    Private driver As IWebDriver                                                    ' Interface contract...generic object to invoke Selenium actions.
    Private snagIt As SNAGITLib.IImageCapture2 = New SNAGITLib.ImageCaptureClass()  ' Using IImageCapture2 to get new functionality in SnagIt 8.1.
    Private myLogPath As String
    Private myExecutableHistoryRecordID As Integer
    Private sqlConn As SqlConnection = Nothing

    Private Const dbError As Integer = -1                                           ' Return values for DB open/close functions.
    Private Const dbClosed As Integer = 0
    Private Const dbOpen As Integer = 1
    Private Const dbChanged As Integer = 2

    Private Const snapSuccess As Integer = 0                                        ' Return values for CaptureScreenshot()
    Private Const snapFail As Integer = -1
    Private Const snapExpired As Integer = -2
    Private Const snapUnknownException As Integer = -3

    Private Const nulFlg As String = "DBNull"
    Private Const exceptionErrorMsg As String = "Actual Result|Exception occurred. See log for details." ' Don't remove "Actual Result|" from beginning!




#End Region
#Region "Private functions and procedures"
    Public Function AttachCommitmentLetter(ByVal oCLet As CommitLetterParms, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sDescr As String = "") As Boolean
        Dim attach As New AutomationObject
        Dim Did_it_work As Boolean = True
        ' Click attach
        attach.aObject = WaitForElement(driver, WaitForTime, By.XPath(oCLet.AttachXPATH))
        If Not attach.aObject Is Nothing Then
            attach.aElement = DirectCast(attach.aObject, IWebElement)
            attach.aElement.Click()

            'Browse for Commitment Letter
            Dim FileToUpload As New BrowseFileParms
            FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/div/div/div[2]/table[3]/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
            FileToUpload.AttachPath = "//input[@id='pageTemplateForm:commitmentLetterFile']"
            FileToUpload.FileToAttach = oCLet.LetterToAttach
            Did_it_work = AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Commitment Letter For " & sDescr)

            'Click Update to save commitment letter
            attach.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/div/div/div[2]/table[1]/tbody/tr/td[2]/input"))

            Dim numRetry As Integer = 1

            If Not attach.aObject Is Nothing Then
                attach.aElement = DirectCast(attach.aObject, IWebElement)
                Try
                    attach.aElement.Click()
                Catch ex As Exception
                    Dim Chksave As New AutomationObject
                    Dim WaitForSave As Integer = 40
                    Chksave.aObject = WaitForElement(driver, WaitForSave, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
                End Try

            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click Update for Letter: " & oCLet.LetterToAttach.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Update for Letter: " & oCLet.LetterToAttach.ToString, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False
            End If
        Else
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & " Could not click attach link for Letter: " & oCLet.LetterToAttach.ToString
            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click attach link for Letter: " & oCLet.LetterToAttach.ToString, myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Did_it_work = False
        End If
        AttachCommitmentLetter = Did_it_work
    End Function
    ''' <summary>
    ''' Waits for a specified number of seconds for a WebElement to exist.
    ''' </summary>
    ''' <param name="delaySeconds">The time in seconds to wait for the element.</param>
    ''' <param name="locator">An OpenQA.Selenium.By class used to specify the WebElement in question.</param>
    ''' <returns>The specified element, or Nothing if the element can't be located within the time limit.</returns>
    ''' <remarks></remarks>
    Function WaitForElement(ByRef driver As IWebDriver, ByVal delaySeconds As Integer, ByVal locator As OpenQA.Selenium.By) As IWebElement
        Try
            Dim Wait As New WebDriverWait(driver, TimeSpan.FromSeconds(CDbl(delaySeconds)))
            WaitForElement = Wait.Until(Of IWebElement)(
                Function(d)
                    Return d.FindElement(locator)
                End Function
            )
        Catch ex As Exception
            ' Doesn't discriminate between a timeout and the Web Driver giving up from "no response." This just puts an upper
            ' limit on how long it can wait. delaySeconds can't be longer than the amount of time the Web Driver waits before
            ' it throws a "no response" exception.
            WaitForElement = Nothing
        End Try
    End Function
    Public Function WaitForElement(ByVal delaySeconds As Integer, ByVal locator As OpenQA.Selenium.By) As IWebElement
        Try
            Dim Wait As New WebDriverWait(driver, TimeSpan.FromSeconds(CDbl(delaySeconds)))
            WaitForElement = Wait.Until(Of IWebElement)(Function(d)
                                                            Return d.FindElement(locator)
                                                        End Function)
        Catch ex As Exception           ' Doesn't discriminate between a timeout and the Web Driver giving up from "no response." This just puts an upper
            WaitForElement = Nothing    ' limit on how long it can wait. delaySeconds can't be longer than the amount of time the Web Driver waits before
        End Try                         ' it throws a "no response" exception.
    End Function
    Public Function WaitForElements(ByRef driver As IWebDriver, ByVal delaySeconds As Integer, ByVal t As IWebElement, ByVal locator As OpenQA.Selenium.By) As ReadOnlyCollection(Of IWebElement)
        Try
            Dim Wait As New WebDriverWait(driver, TimeSpan.FromSeconds(CDbl(delaySeconds)))
            WaitForElements = Wait.Until(Of ReadOnlyCollection(Of IWebElement))(
                Function(d)
                    Return t.FindElements(locator)
                End Function
            )
        Catch ex As Exception
            ' Doesn't discriminate between a timeout and the Web Driver giving up from "no response." This just puts an upper
            ' limit on how long it can wait. delaySeconds can't be longer than the amount of time the Web Driver waits before
            ' it throws a "no response" exception.
            WaitForElements = Nothing
        End Try
    End Function
    ''' <summary>
    ''' Opens the (class scoped) connection to the SQL Server database for obtaining verification data.
    ''' </summary>
    ''' <param name="serverToUse"></param>
    ''' <returns>Integer value representing result of the call.</returns>
    ''' <remarks>Unlike the function below, does not constrain successive calls to the same DB server as the 1st call.</remarks>
    Private Function OpenSqlDB(ByVal serverToUse As String) As Integer
        Try
            If sqlConn IsNot Nothing AndAlso sqlConn.State = ConnectionState.Open Then
                Return dbOpen
            End If
            Dim connStr As String = "Server=" & serverToUse & ";Trusted_Connection=True;"
            If sqlConn Is Nothing Then
                sqlConn = New SqlConnection()
            End If
            sqlConn.ConnectionString = connStr
            sqlConn.Open()
            Return dbOpen
        Catch ex As Exception
            Return dbError
        End Try
    End Function
    ''' <summary>
    ''' Opens the (class scoped) connection to the SQL Server database for obtaining verification data.
    ''' </summary>
    ''' <param name="serverToUse"></param>
    ''' <returns>Integer value representing result of the call.</returns>
    ''' <remarks>After the first call to this function, all additional calls must specify the same DB server as the one used for the first call.</remarks>
    Private Function OpenConstantSqlDB(ByVal serverToUse As String) As Integer
        Static openServer As String = ""
        Try
            If sqlConn IsNot Nothing AndAlso sqlConn.State = ConnectionState.Open Then
                If sqlConn.DataSource.Trim() = serverToUse.Trim() Then
                    Return dbOpen
                Else
                    Return dbChanged
                End If
            End If
            If openServer <> "" AndAlso openServer <> serverToUse.Trim() Then
                Return dbChanged
            End If
            Dim connStr As String = "Server=" & serverToUse & ";Trusted_Connection=True;"
            If sqlConn Is Nothing Then
                sqlConn = New SqlConnection()
            End If
            sqlConn.ConnectionString = connStr
            sqlConn.Open()
            ' If this is the first successful call of the run, save the server string for subsequent calls.
            If openServer = "" Then
                openServer = serverToUse.Trim()
            End If
            Return dbOpen
        Catch ex As Exception
            Return dbError
        End Try
    End Function
    ''' <summary>
    ''' Closes the (class scoped) connection to the SQL Server database for obtaining verification data.
    ''' </summary>
    ''' <returns>Integer value representing result of the call.</returns>
    ''' <remarks>If the connection is already closed, or Nothing, returns dbClosed.</remarks>
    Private Function CloseSqlDB() As Integer
        If sqlConn Is Nothing OrElse sqlConn.State = ConnectionState.Closed Then
            Return dbClosed
        End If
        Try
            sqlConn.Close()
            sqlConn = Nothing
            Return dbClosed
        Catch ex As Exception
            Return dbError
        End Try
        sqlConn.Close()
        sqlConn = Nothing
    End Function
    ''' <summary>
    ''' Pads a numeric value stored in numberStr with leading zeros to make it totalLength long.
    ''' </summary>
    ''' <param name="numberStr">The String containing a positive numeric value.</param>
    ''' <param name="totalLength">The desired length of the returned String including any added leading zeros.</param>
    ''' <returns>The String containing the original numeric value with sufficient leading zeros added to make its length totalLength.</returns>
    ''' <remarks>If the length of numberStr is equal to or longer than totalLength, just returns numberStr unmodified.</remarks>
    Private Function PadWithLeadingZeros(ByVal numberStr As String, totalLength As Integer) As String
        Const excepMsg As String = "PadWithZeros(): Parameter ""numberStr"" cannot "
        If numberStr.Length < totalLength Then
            If IsNumeric(numberStr) Then
                If CLng(numberStr) < 0 Then
                    Throw New Exception(excepMsg & "contain a negative value.")
                End If
                PadWithLeadingZeros = CUInt(numberStr).ToString("D" & totalLength.ToString())
            Else
                Throw New Exception(excepMsg & "be converted into a numeric value.")
            End If
        Else
            PadWithLeadingZeros = numberStr
        End If
    End Function
    ''' <summary>
    ''' Removes commas and dollar sign from a string representing a monetary value.
    ''' </summary>
    ''' <param name="value">The string to be cleaned.</param>
    ''' <returns>String with the characters removed.</returns>
    ''' <remarks>Also removes leading and trailing white space. Input string values that contain parentheses are made negative.</remarks>
    Private Function CleanMonetaryString(ByVal value As String) As String
        Dim result As String = value.Replace(",", "").Replace("$", "").Trim()
        If result.Contains("(") AndAlso result.Contains(")") Then               ' It's a negative value, so...
            result = "-" & result.Replace("(", "").Replace(")", "").Trim()      ' ...remove the "()" and prepend a "negative sign" (hyphen).
        End If
        Return result
    End Function
    ''' <summary>
    ''' Takes a snapshot of the current screen with SnagIt.
    ''' </summary>
    ''' <param name="actionHistoryRecordID">The action history record ID</param>
    ''' <returns>An Integer signifying the outcome.</returns>
    ''' <remarks>The function also adds information to the log describing the outcome.</remarks>
    Private Function CaptureScreenshot(ByVal actionHistoryRecordID As Integer) As Integer
        Dim snagItDirectory As String = ""
        Dim snagItFileName As String = ""       ' File name w/o the extension.
        Dim snagItFileExtension As String = ""  ' Extension of the image file.
        Try
            ' Get the directory for the SnagIt path.
            snagItDirectory = My.Computer.FileSystem.CombinePath(
                My.Computer.FileSystem.GetParentPath(My.Computer.FileSystem.GetParentPath(myLogPath)), "Screenshots")

            ' Get the current date/time and use that as the SnagIt file name.
            snagItFileName = My.Computer.Clock.LocalTime.Year.ToString & _
                My.Computer.Clock.LocalTime.Month.ToString.PadLeft(2, "0"c) & _
                My.Computer.Clock.LocalTime.Day.ToString.PadLeft(2, "0"c) & _
                "_" & _
                My.Computer.Clock.LocalTime.Hour.ToString.PadLeft(2, "0"c) & _
                My.Computer.Clock.LocalTime.Minute.ToString.PadLeft(2, "0"c) & _
                My.Computer.Clock.LocalTime.Second.ToString.PadLeft(2, "0"c)

            ' Set SnagIt to take a desktop screenshot and store it as a file.
            snagIt.Input = SNAGITLib.snagImageInput.siiDesktop
            snagIt.Output = SNAGITLib.snagImageOutput.sioFile

            ' Set the screenshot properties and save location.
            snagIt.OutputImageFile.FileNamingMethod = SNAGITLib.snagOuputFileNamingMethod.sofnmFixed
            snagIt.OutputImageFile.Directory = snagItDirectory
            snagIt.OutputImageFile.Filename = snagItFileName
            snagIt.OutputImageFile.FileType = SNAGITLib.snagImageFileType.siftPNG
            Select Case snagIt.OutputImageFile.FileType
                Case snagImageFileType.siftPNG
                    snagItFileExtension = ".png"
                Case snagImageFileType.siftJPEG
                    snagItFileExtension = ".jpeg"
                Case snagImageFileType.siftGIF
                    snagItFileExtension = ".gif"
                Case snagImageFileType.siftBMP
                    snagItFileExtension = ".bmp"
                Case Else
                    snagItFileExtension = ""
            End Select

            ' Suppress snagit preview window and cursor.
            snagIt.EnablePreviewWindow = False
            snagIt.IncludeCursor = False

            ' Take a snapshot, check for SnagIt license.
            Try
                snagIt.Capture()
                mosaicDll.RSTAR_AddScreenshot(CLng(myExecutableHistoryRecordID), 5, CLng(actionHistoryRecordID), My.Computer.FileSystem.CombinePath(snagItDirectory, snagItFileName & snagItFileExtension), "") 'Use 5 to attach a screenshot to an Action in the history table.
                mosaicDll.Logger(senderMCPAction, "Screenshot|" & My.Computer.FileSystem.CombinePath(snagItDirectory, snagItFileName & snagItFileExtension), myLogPath, , actionHistoryRecordID)
                mosaicDll.Logger(senderMCPAction, "Actual Result|Screenshot captured.", myLogPath, , actionHistoryRecordID)
            Catch ex As Exception
                If snagIt.LastError = SNAGITLib.snagError.serrSnagItExpired Then
                    CaptureScreenshot = snapExpired
                Else
                    CaptureScreenshot = snapFail
                End If
                mosaicDll.Logger(senderMCPAction, "Screenshot|Failure.", myLogPath, , actionHistoryRecordID)
                mosaicDll.Logger(senderMCPAction, "Actual Result|Screenshot capture failed.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try
            CaptureScreenshot = snapSuccess
        Catch ex As Exception
            CaptureScreenshot = snapUnknownException
        End Try
    End Function

#End Region
Region "Selenium Function Templates"

    ' These are templates for your test action functions.

    'Public Function ta_SeleniumActionTemplate(ByVal mcpParameters() As Object) As Object()
    '    Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
    '    Dim excelPath As String = CType(mcpParameters(0), String)
    '    Dim iteration As Integer = CType(mcpParameters(1), Integer)
    '    Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
    '    Try

    '        ''''''''''''''''''''
    '        ' Do something here.
    '        ''''''''''''''''''''

    '        ' ( **** Remove the next 2 (or 3) lines once the test action function is ready for testing. ****)
    '        returnValues(1) = "(* Dummy action *)"
    '        mosaicDll.Logger(senderMCPAction, "Actual Result|Dummy action", myLogPath, , actionHistoryRecordID)
    '        Return returnValues
    '    Catch ex As Exception
    '        returnValues(0) = executionStatusFailed
    '        returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
    '        mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
    '        mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
    '        Return returnValues
    '    End Try
    'End Function

    'Public Function ta_SeleniumActionTemplate_with_DB_Access(ByVal mcpParameters() As Object) As Object()
    '    Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
    '    Dim excelPath As String = CType(mcpParameters(0), String)
    '    Dim iteration As Integer = CType(mcpParameters(1), Integer)
    '    Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
    '    Try
    '        ' ( **** Uncomment the section below when your ready to actually test this function. **** )
    '        '' Open the DB.
    '        'Dim dbServer As String =  (Name of database here.)                                    ' (FIX THIS LINE BY DEFINING THE DATABASE TO BE ACCESSED!)
    '        'Select Case OpenSqlDB(dbServer)
    '        '    Case dbError
    '        '        returnValues(0) = executionStatusFailed
    '        '        returnValues(1) = "Unable to open '" & dbServer & "' database."
    '        '        mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
    '        '    Case dbChanged
    '        '        returnValues(0) = executionStatusFailed
    '        '        returnValues(1) = "Data profile specifies a changed database URL."
    '        '        mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
    '        'End Select
    '        'If CInt(returnValues(0)) <> executionStatusPassed Then
    '        '    Exit Try
    '        'End If

    '        ''''''''''''''''''''
    '        ' Do something here.
    '        ''''''''''''''''''''

    '        ' ( **** Remove the next 2 lines once the test action function is ready for testing. **** )
    '        returnValues(1) = "(* Dummy action *)"
    '        mosaicDll.Logger(senderMCPAction, "Actual Result|Dummy action", myLogPath, , actionHistoryRecordID)
    '    Catch ex As Exception
    '        returnValues(0) = executionStatusFailed
    '        returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
    '        mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
    '        mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
    '    Finally
    '        ' Close the DB.
    '        If CloseSqlDB() <> dbClosed Then
    '            returnValues(0) = executionStatusFailed
    '            returnValues(1) = "Error closing the database."
    '            mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
    '        End If
    '        ta_SeleniumActionTemplate_with_DB_Access = returnValues
    '    End Try
    'End Function

#End Region
    Public Class DevTeamParams
        Private _CompanyName As String
        Private _TelephoneNbr As String
        Private _PersonName As String
        Private _ContractExec As String
        Private _DescrAHPExper As String

        Public Property CompanyName() As String
            Get
                Return _CompanyName
            End Get

            Set(ByVal value As String)
                _CompanyName = value
            End Set

        End Property
        Public Property TelephoneNbr() As String
            Get
                Return _TelephoneNbr
            End Get
            Set(ByVal value As String)
                _TelephoneNbr = value

            End Set
        End Property


        Public Property PersonName() As String
            Get
                Return _PersonName
            End Get
            Set(ByVal value As String)
                _PersonName = value

            End Set
        End Property
        Public Property ContractExec() As String
            Get
                Return _ContractExec
            End Get
            Set(ByVal value As String)
                _ContractExec = value

            End Set
        End Property
        Public Property DescrAHPExper() As String
            Get
                Return _DescrAHPExper
            End Get
            Set(ByVal value As String)
                _DescrAHPExper = value

            End Set
        End Property

    End Class
    Public Class PartnerDetailParams
        Private _PartnerName As String
        Private _NameXpath As String
        Private _PartnerOwnIntPercent As String
        Private _InterestXpath As String
        Private _ButtonXpath As String

        Public Property PartnerName() As String
            Get
                Return _PartnerName
            End Get

            Set(ByVal value As String)
                _PartnerName = value
            End Set

        End Property
        Public Property NameXpath() As String
            Get
                Return _NameXpath
            End Get
            Set(ByVal value As String)
                _NameXpath = value

            End Set
        End Property


        Public Property PartnerOwnIntPercent() As String
            Get
                Return _PartnerOwnIntPercent
            End Get
            Set(ByVal value As String)
                _PartnerOwnIntPercent = value

            End Set
        End Property
        Public Property InterestXpath() As String
            Get
                Return _InterestXpath
            End Get
            Set(ByVal value As String)
                _InterestXpath = value

            End Set
        End Property
        Public Property ButtonXpath() As String
            Get
                Return _ButtonXpath
            End Get
            Set(ByVal value As String)
                _ButtonXpath = value

            End Set
        End Property

    End Class
    Public Class CalendarParams

        Private _yeardec As String
        Private _monthdec As String
        Private _monthinc As String
        Private _yearinc As String
        Private _clean As String
        Private _today As String
        Private _CalButtonXPath As String
        Private _CalHeader As String
        Private _CurrentDay As Integer
        Private _CurrentMonth As Integer
        Private _CurrentYear As Integer
        Private _TargetDay As Integer
        Private _TargetMonth As Integer
        Private _TargetYear As Integer
        Private _jumpMonthsBy As Integer
        Private _increment As Boolean
        Private _dayXPathPart1 As String
        Private _dayXpathPart2 As String
        Private _dayZeroXPath As String
        Private _applyButtonXPath As String
        Private _TargetDate As DateTime
        Private _CurrentDate As DateTime
        Private _iMonthIncDecValue As Integer
        Private _iYearincDecValue As Integer
        Private _DayIndex As Integer


        Public Function IsPositive(number As Integer) As Boolean
            Return number > 0
        End Function
        Public Function IsNegative(number As Integer) As Boolean
            Return number < 0
        End Function
        Public Sub SetYearsAdndMonthsJump()

            _iMonthIncDecValue = DateDiff(DateInterval.Month, _CurrentDate, _TargetDate)
            _iYearincDecValue = DateDiff(DateInterval.Year, _CurrentDate, _TargetDate)

        End Sub
        Public Property DayIndex() As Integer
            Get
                Return _DayIndex
            End Get
            Set(ByVal value As Integer)
                _DayIndex = value
            End Set
        End Property
        Public Property MonthIncDecValue() As Integer
            Get
                Return _iMonthIncDecValue
            End Get
            Set(ByVal value As Integer)
                _iMonthIncDecValue = value
            End Set
        End Property
        Public Property iYearincDecValue() As Integer
            Get
                Return _iYearincDecValue
            End Get
            Set(ByVal value As Integer)
                _iYearincDecValue = value
            End Set
        End Property
        Public Property TargetDate() As DateTime
            Get
                Return _TargetDate
            End Get
            Set(ByVal value As DateTime)
                _TargetDate = value
            End Set
        End Property
        Public Property CurrentDate() As DateTime
            Get
                Return _CurrentDate
            End Get
            Set(ByVal value As DateTime)
                _CurrentDate = value
            End Set
        End Property
        Public Property applyButtonXPath() As String
            Get
                Return _applyButtonXPath
            End Get
            Set(ByVal value As String)
                _applyButtonXPath = value
            End Set
        End Property
        Public Property dayZeroXPath() As String
            Get
                Return _dayZeroXPath
            End Get
            Set(ByVal value As String)
                _dayZeroXPath = value
            End Set
        End Property
        Public Property dayXPathPart1() As String
            Get
                Return _dayXPathPart1
            End Get
            Set(ByVal value As String)
                _dayXPathPart1 = value
            End Set
        End Property
        Public Property dayXPathPart2() As String
            Get
                Return _dayXpathPart2
            End Get
            Set(ByVal value As String)
                _dayXpathPart2 = value
            End Set
        End Property
        Public Property TargetDay() As Integer
            Get
                Return _TargetDay
            End Get
            Set(ByVal value As Integer)
                _TargetDay = value
            End Set
        End Property
        Public Property TargetMonth() As Integer
            Get
                Return _TargetMonth
            End Get
            Set(ByVal value As Integer)
                _TargetMonth = value
            End Set
        End Property
        Public Property TargetYear() As Integer
            Get
                Return _TargetYear
            End Get
            Set(ByVal value As Integer)
                _TargetYear = value
            End Set
        End Property
        Public Property CurrentDay() As Integer
            Get
                Return _CurrentDay
            End Get
            Set(ByVal value As Integer)
                _CurrentDay = value
            End Set
        End Property
        Public Property CurrentMonth() As Integer
            Get
                Return _CurrentMonth
            End Get
            Set(ByVal value As Integer)
                _CurrentMonth = value
            End Set
        End Property
        Public Property CurrentYear() As Integer
            Get
                Return _CurrentYear
            End Get
            Set(ByVal value As Integer)
                _CurrentYear = value
            End Set
        End Property
        Public Property yeardec() As String
            Get
                Return _yeardec
            End Get
            Set(ByVal value As String)
                _yeardec = value
            End Set
        End Property
        Public Property monthdec() As String
            Get
                Return _monthdec
            End Get
            Set(ByVal value As String)
                _monthdec = value
            End Set
        End Property
        Public Property monthinc() As String
            Get
                Return _monthinc
            End Get
            Set(ByVal value As String)
                _monthinc = value
            End Set
        End Property
        Public Property yearinc() As String
            Get
                Return _yearinc
            End Get
            Set(ByVal value As String)
                _yearinc = value
            End Set
        End Property
        Public Property clean() As String
            Get
                Return _clean
            End Get
            Set(ByVal value As String)
                _clean = value
            End Set
        End Property
        Public Property ctoday() As String
            Get
                Return _today
            End Get
            Set(ByVal value As String)
                _today = value
            End Set
        End Property
        Public Property CalButtonXPath() As String
            Get
                Return _CalButtonXPath
            End Get
            Set(ByVal value As String)
                _CalButtonXPath = value
            End Set
        End Property

        Public Property CalHeader() As String
            Get
                Return _CalHeader
            End Get
            Set(ByVal value As String)
                _CalHeader = value
            End Set
        End Property

    End Class
    Public Class BrowseFileParms
        Private _RemovePath As String
        Private _AttachPath As String
        Private _FileToAttach As String
        Public Property RemovePath() As String
            Get
                Return _RemovePath
            End Get

            Set(ByVal value As String)
                _RemovePath = value
            End Set

        End Property
        Public Property AttachPath() As String
            Get
                Return _AttachPath
            End Get

            Set(ByVal value As String)
                _AttachPath = value
            End Set

        End Property
        Public Property FileToAttach() As String
            Get
                Return _FileToAttach
            End Get

            Set(ByVal value As String)
                _FileToAttach = value
            End Set

        End Property

    End Class
    Public Class SponsorRoles
        Private _srXPATH As String
        Private _SrRole As String

        Public Property srXPATH() As String
            Get
                Return _srXPATH
            End Get

            Set(ByVal value As String)
                _srXPATH = value
            End Set

        End Property

        Public Property SrRole() As String
            Get
                Return _SrRole
            End Get

            Set(ByVal value As String)
                _SrRole = value
            End Set

        End Property


    End Class
    Public Class EmpowermentParms
        Private _IfEmpowerment As String
        Private _SelXPath As String
        Private _FileAttachPath As String
        Private _FileRemPath As String
        Private _Mou As String
        Public Property IfEmpowerment() As String
            Get
                Return _IfEmpowerment
            End Get

            Set(ByVal value As String)
                _IfEmpowerment = value
            End Set

        End Property
        Public Property FileAttachPath() As String
            Get
                Return _FileAttachPath
            End Get

            Set(ByVal value As String)
                _FileAttachPath = value
            End Set

        End Property
        Public Property FileRemPath() As String
            Get
                Return _FileRemPath
            End Get

            Set(ByVal value As String)
                _FileRemPath = value
            End Set

        End Property
        Public Property SelXPath() As String
            Get
                Return _SelXPath
            End Get

            Set(ByVal value As String)
                _SelXPath = value
            End Set

        End Property
        Public Property MOU() As String
            Get
                Return _Mou
            End Get

            Set(ByVal value As String)
                _Mou = value
            End Set

        End Property
    End Class
    Public Class CommitLetterParms
        Private _AttachXPATH As String
        Private _LetterToAttach As String
        Public Property AttachXPATH() As String
            Get
                Return _AttachXPATH
            End Get

            Set(ByVal value As String)
                _AttachXPATH = value
            End Set

        End Property
        Public Property LetterToAttach() As String
            Get
                Return _LetterToAttach
            End Get

            Set(ByVal value As String)
                _LetterToAttach = value
            End Set

        End Property
    End Class



    Public Function ProcessEmpowerment(ByVal oEmpower As EmpowermentParms, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sEmpowerType As String = "") As Boolean
        Dim empauto As New AutomationObject
        Dim Did_it_work As Boolean = True
        empauto.aObject = WaitForElement(driver, WaitForTime, By.XPath(oEmpower.SelXPath))
        If Not empauto.aObject Is Nothing Then
            empauto.aElement = DirectCast(empauto.aObject, IWebElement)
            'check if there is an x in the check box already and the data wants the box checked
            'the and portion is really unecessary but ....

            If CleanString(oEmpower.IfEmpowerment) = "X" Then
                If empauto.aElement.Selected = True Then
                    'proper state
                Else
                    empauto.aElement.Click()
                End If
                mosaicDll.Logger(senderMCPAction, "Actual Result| Checked " & sEmpowerType & ".", myLogPath, , actionHistoryRecordID)
                If Not String.IsNullOrEmpty(oEmpower.MOU) Then
                    Dim FileToUpload As New BrowseFileParms
                    FileToUpload.RemovePath = oEmpower.FileRemPath
                    FileToUpload.AttachPath = oEmpower.FileAttachPath
                    FileToUpload.FileToAttach = oEmpower.MOU
                    Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, sEmpowerType & " MOU")
                End If
            ElseIf CleanString(oEmpower.IfEmpowerment) = "R" Then
                If empauto.aElement.Selected = False Then
                    'proper state
                Else
                    empauto.aElement.Click()
                End If
                mosaicDll.Logger(senderMCPAction, "Actual Result| Un-Checked " & sEmpowerType & ".", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Invalid Value for " & sEmpowerType & " specified."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid Value for " & sEmpowerType & " specified:" & oEmpower.IfEmpowerment.ToString & ". Expected X or R", myLogPath, , actionHistoryRecordID)
                Did_it_work = False
            End If
        Else
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & "Unable to Select " & sEmpowerType & "."
            mosaicDll.Logger(senderMCPAction, "Actual Result| Unable to Select " & sEmpowerType & ".", myLogPath, , actionHistoryRecordID)
            Did_it_work = False
        End If
        ProcessEmpowerment = Did_it_work
    End Function
    Public Function ClickSponsorRole(ByVal oRole As SponsorRoles, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sRole As String = "") As Boolean

        Dim Did_it_Work As Boolean = True
        Dim cdAutomate As New AutomationObject
        cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(oRole.srXPATH))
        If Not cdAutomate.aObject Is Nothing Then
            cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
            'check if there is an x in the check box already and the data wants the box checked
            'the and portion is really unecessary but ....

            If oRole.SrRole = "X" Then
                If cdAutomate.aElement.Selected = True Then
                    'proper state
                Else
                    cdAutomate.aElement.Click()
                End If
                mosaicDll.Logger(senderMCPAction, "Actual Result| Checked " & sRole & " Role.", myLogPath, , actionHistoryRecordID)
            ElseIf oRole.SrRole = "R" Then
                If cdAutomate.aElement.Selected = False Then
                    'proper state
                Else
                    cdAutomate.aElement.Click()
                End If
                mosaicDll.Logger(senderMCPAction, "Actual Result| Un-Checked " & sRole & " Role.", myLogPath, , actionHistoryRecordID)
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid Value for " & sRole & " set.  expected X or R", myLogPath, , actionHistoryRecordID)
                Did_it_Work = False
            End If
        Else
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & "Could not click or un-click " & sRole & "."
            mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click or un-click " & sRole & ".", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Did_it_Work = False
        End If
        ClickSponsorRole = Did_it_Work
    End Function
    Public Function AttachFile(ByVal oFile As BrowseFileParms, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sFileType As String = "") As Boolean

        Dim Did_it_work As Boolean = True

        Dim oRehDoc As Object = WaitForElement(driver, WaitForTime, By.XPath(oFile.RemovePath))

        If Not oRehDoc Is Nothing Then
            Dim oRehElement As IWebElement = DirectCast(oRehDoc, IWebElement)
            oRehElement.Click()
            mosaicDll.Logger(senderMCPAction, "Actual Result|Removed the previous " & sFileType & " document.", myLogPath, , actionHistoryRecordID)
        End If


        If Not System.IO.File.Exists(oFile.FileToAttach) Then
            'message
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & " " & "The file named: " & oFile.FileToAttach.ToString & " was not found."
            mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & oFile.FileToAttach.ToString & " was not found.", myLogPath, , actionHistoryRecordID)
            Did_it_work = False
        Else
            Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath(oFile.AttachPath))
            If Not oAttachFile Is Nothing Then
                Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                oAttachFileElement.Click()
                oAttachFileElement.SendKeys(oFile.FileToAttach)
                mosaicDll.Logger(senderMCPAction, "Actual Result | Attached " & sFileType & " File.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not attach file named: " & oFile.FileToAttach.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & oFile.FileToAttach.ToString, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False

            End If
        End If
        AttachFile = Did_it_work

    End Function
    Public Sub DoCalendar(ByVal sDateParm As String, ByVal CalendarRef As CalendarParams, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sCalendarName As String = "")
        'Dim calExpectedDrawDate As New CalendarParams
        'Dim properDate As DateTime = DateTime.Parse(sDateParm)
        Dim index As Integer = 0
        Const MAX_DAY_IN_A_MONTH As Integer = 31

        'open the calendar
        Dim Calendar_Found As Boolean = True
        Dim oCalender As Object = Nothing
        oCalender = WaitForElement(driver, WaitForTime, By.XPath(CalendarRef.CalButtonXPath))


        If Not oCalender Is Nothing Then
            Dim oCalendar_Element As IWebElement = DirectCast(oCalender, IWebElement)
            oCalendar_Element.Click()
            Dim oClean_Object As Object = Nothing
            Dim WaitForClean As Integer = 3
            oClean_Object = WaitForElement(driver, WaitForClean, By.XPath(CalendarRef.clean))
            If Not oClean_Object Is Nothing Then
                Dim oClean_Element As IWebElement = DirectCast(oClean_Object, IWebElement)
                oClean_Element.Click()
                oCalendar_Element.Click()
            End If
            mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the " & sCalendarName & " calendar button.", myLogPath, , actionHistoryRecordID)
        Else
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & " Could not click the " & sCalendarName & " calendar button."
            mosaicDll.Logger(senderMCPAction, "Actual Result|Could not click the " & sCalendarName & " calendar button.", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Calendar_Found = False
        End If

        If Calendar_Found = True Then
            'calculate the number of years and months to jump we only use months
            CalendarRef.SetYearsAdndMonthsJump()

            Dim yearObject As Object = Nothing
            Dim monthObject As Object = Nothing
            Dim yearElement As IWebElement = Nothing
            Dim monthElement As IWebElement = Nothing
            Dim nbryears As Integer = CalendarRef.MonthIncDecValue / 12
            Dim nbrmonths As Integer = 0
            If nbryears = 0 Then
                GoTo JumpMonths
            End If
            If CalendarRef.IsPositive(nbryears) Then
                For x As Integer = 1 To nbryears
                    yearObject = WaitForElement(driver, WaitForTime, By.XPath(CalendarRef.yearinc))
                    If Not yearObject Is Nothing Then
                        yearElement = DirectCast(yearObject, IWebElement)
                        yearElement.Click()
                        Threading.Thread.Sleep(50)
                    Else
                        Calendar_Found = False
                    End If
                Next
            Else
                For x As Integer = -1 To nbryears Step -1
                    yearObject = WaitForElement(driver, WaitForTime, By.XPath(CalendarRef.yeardec))
                    If Not yearObject Is Nothing Then
                        yearElement = DirectCast(yearObject, IWebElement)
                        yearElement.Click()
                        Threading.Thread.Sleep(50)
                    Else
                        Calendar_Found = False
                    End If
                Next
            End If
JumpMonths:
            nbrmonths = CalendarRef.MonthIncDecValue - (nbryears * 12)
            If nbrmonths > 0 Then
                For x As Integer = 1 To nbrmonths
                    'For x As Integer = 1 To CalendarRef.MonthIncDecValue
                    monthObject = WaitForElement(driver, WaitForTime, By.XPath(CalendarRef.monthinc))
                    If Not monthObject Is Nothing Then
                        monthElement = DirectCast(monthObject, IWebElement)
                        monthElement.Click()
                        Threading.Thread.Sleep(50)
                    Else
                        Calendar_Found = False
                    End If
                Next
            Else
                If nbrmonths < 0 Then
                    For x As Integer = -1 To nbrmonths Step -1
                        monthObject = WaitForElement(driver, WaitForTime, By.XPath(CalendarRef.monthdec))
                        If Not monthObject Is Nothing Then
                            monthElement = DirectCast(monthObject, IWebElement)
                            monthElement.Click()
                            Threading.Thread.Sleep(50)
                        Else
                            Calendar_Found = False
                        End If
                    Next
                End If
            End If

            'Check to see if the calendare is month and year have been set properly and report
            Dim checkDateCal As String = String.Empty
            Dim checkDatePassed As String = CalendarRef.TargetDate.ToString("MMMM") & ", " & CalendarRef.TargetYear
            Dim oCheckDate As New AutomationObject

            'oCheckDate.aObject = WaitForElement(driver, WaitForTime, By.XPath("//td[@id='pageTemplateForm:expectedDrawDateHeader']/table/tbody/tr/td[3]/div"))
            oCheckDate.aObject = WaitForElement(driver, WaitForTime, By.XPath(CalendarRef.CalHeader))
            If Not oCheckDate.aObject Is Nothing Then
                oCheckDate.aElement = DirectCast(oCheckDate.aObject, IWebElement)
                checkDateCal = oCheckDate.aElement.Text
            Else
                Calendar_Found = False
            End If



            If checkDatePassed = checkDateCal Then
                mosaicDll.Logger(senderMCPAction, "Actual Result| Month and Year Verified:" & checkDatePassed, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Date value was not set properly."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Failed month and year check.  Expected " & checkDatePassed & " Calendar value was " & checkDateCal, myLogPath, , actionHistoryRecordID)
            End If

            'calculate the correct day index
            Dim tempMonth As Integer = CalendarRef.TargetMonth - 1
            If tempMonth = 0 Then
                'if target month is January, control will come inside.
                tempMonth = 12 'december
            End If

            Dim oZeroXPath As Object = WaitForElement(driver, WaitForTime, By.XPath(CalendarRef.dayZeroXPath))
            Dim oZeroPath_element As IWebElement = Nothing
            If Not oZeroXPath Is Nothing Then
                oZeroPath_element = DirectCast(oZeroXPath, IWebElement)
            End If

            Dim str As String = oZeroPath_element.Text
            Dim dayValueAtZeroIndex As Integer = Convert.ToInt32(str)


            If dayValueAtZeroIndex = 1 Then
                index = CalendarRef.TargetDay - 1
            Else
                Select Case tempMonth
                    Case 1, 3, 5, 7, 8, 10, _
                     12
                        If True Then
                            index = ((MAX_DAY_IN_A_MONTH - dayValueAtZeroIndex) + CalendarRef.TargetDay)
                            Exit Select
                        End If
                    Case 2
                        If True Then
                            '
                            '	 * Separate case is needed for feb because Feb contains only 28(MAX_DAY_IN_A_MONTH - 3) days.
                            '	 
                            Dim bLeapYear As Boolean = Date.IsLeapYear(CalendarRef.TargetYear)

                            If bLeapYear Then
                                'index = (((MAX_DAY_IN_A_MONTH - 3) - dayValueAtZeroIndex) + CalendarRef.TargetDay)
                                index = (((MAX_DAY_IN_A_MONTH - 2) - dayValueAtZeroIndex) + CalendarRef.TargetDay)
                            Else
                                'index = (((MAX_DAY_IN_A_MONTH - 4) - dayValueAtZeroIndex) + CalendarRef.TargetDay)
                                index = (((MAX_DAY_IN_A_MONTH - 3) - dayValueAtZeroIndex) + CalendarRef.TargetDay)
                            End If

                            Exit Select
                        End If
                    Case Else
                        If True Then


                            index = (((MAX_DAY_IN_A_MONTH - 1) - dayValueAtZeroIndex) + CalendarRef.TargetDay)
                            Exit Select
                        End If
                End Select
            End If


            CalendarRef.DayIndex = index


            Dim DayObject As Object = Nothing
            Dim DayElement As IWebElement = Nothing
            Dim CompleteDayPath As String = CalendarRef.dayXPathPart1 & CalendarRef.DayIndex & CalendarRef.dayXPathPart2
            DayObject = WaitForElement(driver, WaitForTime, By.XPath(CompleteDayPath))
            If Not DayObject Is Nothing Then
                DayElement = DirectCast(DayObject, IWebElement)
                DayElement.Click()
            Else
                Calendar_Found = False
            End If

            If Calendar_Found Then
                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & sDateParm.ToString & " for " & sCalendarName & " calendar field.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not enter " & sDateParm.ToString & " for " & sCalendarName & " calendar field."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter " & sDateParm.ToString & " for " & sCalendarName & " calendar field.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

        End If



    End Sub

    Public Function EnterTextArea(ByVal oTextArea As TextAreaParms, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sField As String = "") As Boolean
        Dim Did_it_work As Boolean = True

        System.Windows.Forms.Clipboard.Clear()
        Dim sRetVal As String = GetWordText(oTextArea.TextToEnter)
        If sRetVal.ToUpper = "FILE NOT FOUND" Then
            Dim sXpath As String = oTextArea.TextAreaXpath
            Dim oText As New AutomationObject
            oText.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
            If Not oText.aObject Is Nothing Then
                oText.aElement = DirectCast(oText.aObject, IWebElement)
                oText.aElement.SendKeys(Keys.Control + "a")
                oText.aElement.SendKeys(Keys.Delete)
                oText.aElement.SendKeys(oTextArea.TextToEnter)
                mosaicDll.Logger(senderMCPAction, "Actual Result| " & sField & " was entered from RStar template.", myLogPath, , actionHistoryRecordID)
            End If
        ElseIf sRetVal.ToUpper = "FILE FOUND" Then
            Dim sXpath As String = oTextArea.TextAreaXpath
            Dim oText As New AutomationObject
            oText.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
            If Not oText.aObject Is Nothing Then
                oText.aElement = DirectCast(oText.aObject, IWebElement)
                oText.aElement.SendKeys(Keys.Control + "a")
                oText.aElement.SendKeys(Keys.Delete)

                Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                oText.aElement.SendKeys(Keys.Control + "v")

                mosaicDll.Logger(senderMCPAction, "Actual Result|" & sField & " was entered from Word document.", myLogPath, , actionHistoryRecordID)
            End If
        Else
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & " " & sRetVal
            mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
            Did_it_work = False
        End If
        EnterTextArea = Did_it_work
    End Function
#Region "Custom Selenium functions"
    Public Function Trace_to_AutomatedTest(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            ''''''''''''''''''''
            ' Do something here.
            ''''''''''''''''''''

            ' ( **** Remove the next 2 (or 3) lines once the test action function is ready for testing. ****)
            returnValues(1) = "(* Dummy action for Traceability *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|Dummy action  for Traceability", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function GetLargeText(ByVal mcpParameters() As Object) As Object
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)




        Try

            'debug 
            'Dim sFileName As String = "c:\temp\testfile.docx"
            Dim sFileName As String = mosaicDll.dt(excelPath, iteration, "appl_aplication_main_data", "Reference_File").Trim()

            Dim isValidFile As Boolean = IsValidFileNameOrPath(sFileName)
            If Not isValidFile Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Invalid file name."
                mosaicDll.Logger(senderMCPAction, "Actual Result|The file name and/or path supplied is invalid.", myLogPath, , actionHistoryRecordID)
            Else
                Dim strExt As String = Path.GetExtension(sFileName)
                If strExt <> "doc" And strExt <> "docx" Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Invalid Word document file extension. "
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not continue word file had an invalid extension", myLogPath, , actionHistoryRecordID)
                    Return returnValues
                End If
            End If

            Dim objWord As New Word.Application
            Dim WordDoc As New Word.Document
            WordDoc = objWord.Documents.Open(sFileName.ToString())
            Dim sParagraph As New StringBuilder

            '  If you want the user to see it ... 
            objWord.WindowState = Word.WdWindowState.wdWindowStateNormal
            objWord.Visible = False

            For i As Integer = 1 To objWord.ActiveDocument.Paragraphs.Count
                objWord.ActiveDocument.Paragraphs(i).Range.Select()
                sParagraph.Append(objWord.ActiveDocument.Paragraphs(i).Range.Text)
            Next

            Dim s As String = sParagraph.ToString



            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Function IsValidFileNameOrPath(ByVal name As String) As Boolean
        ' Determines if the name is Nothing. 
        If name Is Nothing Then
            Return False
        End If

        ' Determines if there are bad characters in the name. 
        For Each badChar As Char In System.IO.Path.GetInvalidPathChars
            If InStr(name, badChar) > 0 Then
                Return False
            End If
        Next

        ' The name passes basic validation. 
        Return True
    End Function
    Public Function Close_Browser(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            ' Close the browser.
            driver.Close()
            returnValues(1) = "Browser closed."
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Log1_Open_Browser_URL(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForLogInPage As Integer = 30

            ' Open a new browser.
            Dim browserStr As String = mosaicDll.dt(excelPath, iteration, "brw_browser", "Browser").Trim()
            Select Case browserStr.ToLower()
                Case "firefox"
                    returnValues(1) = "Using Firefox browser."
                    driver = New Firefox.FirefoxDriver
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Launched Firefox", myLogPath, , actionHistoryRecordID)
                Case "internet explorer"
                    returnValues(1) = "Using Internet Explorer browser."
                    driver = New IE.InternetExplorerDriver
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Launched Internet Explorer", myLogPath, , actionHistoryRecordID)
                    'Case "chrome"
                    '    returnValues(1) = "Using Chrome browser."
                    '    driver = New Chrome.ChromeDriver
                    '    mosaicDll.Logger(senderMCPAction, "Actual Result|Launched Chrome", myLogPath, , actionHistoryRecordID)
                Case Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result|No browser launched. Unrecognized browser ('" & browserStr & "') specified.", _
                                     myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = CStr(returnValues(1)) & "Unrecognized browser '" & browserStr & "' specified."
                    CaptureScreenshot(actionHistoryRecordID)
                    Return returnValues
            End Select

            ' Open URL.

            Dim url As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "Web_Address").Trim()
            driver.Navigate().GoToUrl(url)


            Dim sLocatorType As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "Automation__Locator_Type").Trim()
            Dim sLocatorText As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "Automation_Locator_Text").Trim()


            If sLocatorType = "ID" Then

                If WaitForElement(waitForLogInPage, By.Id(sLocatorText)) Is Nothing Then

                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = CStr(returnValues(1)) & "Actual Result|Home page did not appear within " & waitForLogInPage & " seconds."
                    mosaicDll.Logger(senderMCPAction, CStr(returnValues(1)) & "  " & "Error|Home page did not appear within " & waitForLogInPage & " seconds.", _
                                     myLogPath, , actionHistoryRecordID)

                    CaptureScreenshot(actionHistoryRecordID)
                    Return returnValues
                End If

            ElseIf sLocatorType = "XPATH" Then


                If WaitForElement(waitForLogInPage, By.XPath(sLocatorText)) Is Nothing Then

                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = CStr(returnValues(1)) & "Actual Result|Home page did not appear within " & waitForLogInPage & " seconds."
                    mosaicDll.Logger(senderMCPAction, CStr(returnValues(1)) & "  " & "Error|Home page did not appear within " & waitForLogInPage & " seconds.", _
                                     myLogPath, , actionHistoryRecordID)

                    CaptureScreenshot(actionHistoryRecordID)
                    Return returnValues

                End If
            Else

            End If

            mosaicDll.Logger(senderMCPAction, "Actual Result|Navigated to " & url, myLogPath, , actionHistoryRecordID)
            Return returnValues

        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Nav_Login_AHP_External(ByVal mcpParameters() As Object) As Object
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)



        Const waitForLogInPage As Integer = 5


        Dim sIsMockLogin As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "Mock_Login?")
        Dim loginBox As IWebElement

        Try
            'Get the location Method for the user element
            If sIsMockLogin = "Yes" Then

                'Mock login
                mosaicDll.Logger(senderMCPAction, "Executing a mock login. ", myLogPath, , actionHistoryRecordID)

                ' Get the user name.
                Dim uName As String = mosaicDll.dt(excelPath, iteration, "spon_sponsor_contacts", "Login_UserID")

                'Get the password
                'Dim sPassWord As String = mosaicDll.dt(excelPath, iteration, "spon_sponsor_contacts", "Password")

                mosaicDll.Logger(senderMCPAction, "Attempting login for user: " + uName, myLogPath, , actionHistoryRecordID)

                ' Find out how to locate the correct element
                Dim queryResults As IEnumerable(Of LocatorAdvance) = CType(From loc In allLocators
                                                       Where loc.sName = "pageTemplateForm:userName" And loc.s_LookupKey = "MockLogin", IEnumerable(Of LocatorAdvance))


                loginBox = myLocator.FindElementOnPage(driver, queryResults(0).sName, queryResults(0).sID, queryResults(0).AbsoluteXPATH, queryResults(0).RelativeXPATH, "input")

                If loginBox Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Could not locate the login user name element " & waitForLogInPage.ToString() & " seconds.", _
                                     myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Could not locate the login user name element in" & waitForLogInPage.ToString() & " seconds."
                    Return returnValues
                End If
                loginBox.SendKeys(uName)

                'Get the location Method for the submit button 
                queryResults = CType(From loc In allLocators
                                                       Where loc.sName = "loginButton" And loc.s_LookupKey = "MockLogin", IEnumerable(Of LocatorAdvance))

                Dim submitButton As IWebElement = myLocator.FindElementOnPage(driver, queryResults(0).sName, queryResults(0).sID, queryResults(0).AbsoluteXPATH, queryResults(0).RelativeXPATH, "input")

                ' Click on the "Submit" button.
                If submitButton Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Could not locate the submit element in " & waitForLogInPage.ToString() & " seconds.", _
                     myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Log in control not found on page in" & waitForLogInPage.ToString() & " seconds."
                    Return returnValues
                End If
                submitButton.Click()
                'add check
                If WaitForElement(waitForLogInPage, By.Id("menuForm:applicationMenu")) Is Nothing Then

                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = CStr(returnValues(1)) & "Actual Result|Expecting application page and it did not appear within " & waitForLogInPage & " seconds for user: " & uName

                    mosaicDll.Logger(senderMCPAction, CStr(returnValues(1)) & "  " & "Error|Expecting application page and it did not appear within " & waitForLogInPage & " seconds for user: " & uName, _
                         myLogPath, , actionHistoryRecordID)

                    CaptureScreenshot(actionHistoryRecordID)
                    Return returnValues
                End If

            Else
                'Not a mock login
                mosaicDll.Logger(senderMCPAction, "Executing a non mock login. ", myLogPath, , actionHistoryRecordID)

                ' Get the user name.
                Dim uName As String = mosaicDll.dt(excelPath, iteration, "spon_sponsor_contacts", "Login_UserID")

                'Get the password
                Dim sPassword As String = mosaicDll.dt(excelPath, iteration, "spon_sponsor_contacts", "Password")

                mosaicDll.Logger(senderMCPAction, "Attempting login for user: " + uName + "password: " + sPassword, myLogPath, , actionHistoryRecordID)

                Dim dr As DataRow

                'Get the locator info for the login box (user name)
                Dim queryResults As IEnumerable = From P In dt.AsEnumerable Where P.Field(Of String)("sName") = "user" And P.Field(Of String)("LookupKey") = "NonMockLogin" Select P
                dr = CType(queryResults(0), DataRow)


                'find the login box
                loginBox = myLocator.FindElementOnPage(driver, dr(0).ToString, dr(1).ToString(), dr(2).ToString(), dr(3).ToString(), "input")
                If loginBox Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Could not locate the login user element in " & waitForLogInPage.ToString() & " seconds.", _
                                     myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Could not locate the login user element in " & waitForLogInPage.ToString() & " seconds."
                    Return returnValues
                End If
                loginBox.SendKeys(uName)

                'Get the locator info for the password text box
                queryResults = From P In dt.AsEnumerable Where P.Field(Of String)("sName") = "password" And P.Field(Of String)("LookupKey") = "NonMockLogin" Select P
                dr = CType(queryResults(0), DataRow)

                'Get the location of the password box
                Dim passwordBox As IWebElement = myLocator.FindElementOnPage(driver, dr(0).ToString, dr(1).ToString(), dr(2).ToString(), dr(3).ToString(), "input")
                If passwordBox Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Could not locate the password element " & waitForLogInPage.ToString() & " seconds.", _
                                     myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Could not locate the password element " & waitForLogInPage.ToString() & " seconds."
                    Return returnValues
                End If

                'sPassword = "test"
                passwordBox.SendKeys(sPassword)


                'Get the location Method for the submit button 
                queryResults = From P In dt.AsEnumerable Where P.Field(Of String)("sName") = "submitButton" And P.Field(Of String)("LookupKey") = "NonMockLogin" Select P
                dr = CType(queryResults(0), DataRow)

                Dim submitButton As IWebElement = myLocator.FindElementOnPage(driver, dr(0).ToString, dr(1).ToString(), dr(2).ToString(), dr(3).ToString(), "input")

                ' Click on the "Submit" button.
                If submitButton Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Could not locate the submit control in:" & waitForLogInPage.ToString() & " seconds.", _
                     myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Log in control not found on page " & waitForLogInPage.ToString() & " seconds."
                    Return returnValues
                End If
                submitButton.Click()

                'add check
                If WaitForElement(waitForLogInPage, By.Id("menuForm:applicationMenu")) Is Nothing Then

                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = CStr(returnValues(1)) & "Actual Result|Expecting application page and it did not appear within " & waitForLogInPage & " seconds for user: " & uName & " Password: " & sPassword

                    mosaicDll.Logger(senderMCPAction, CStr(returnValues(1)) & "  " & "Error|Expecting application page and it did not appear within " & waitForLogInPage & " seconds for user: " & uName & " Password: " & sPassword & waitForLogInPage & " seconds.", _
                         myLogPath, , actionHistoryRecordID)

                    CaptureScreenshot(actionHistoryRecordID)
                    Return returnValues
                End If

            End If


            returnValues(1) = "Login successful My Applications displayed."
            mosaicDll.Logger(senderMCPAction, "Actual Result|Login successful My Applications displayed.", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, CStr(returnValues(1)) & " " & "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try



    End Function
    Public Function Log2_Mock_Login_Valid_Username(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForLogInPage As Integer = 1
            Const waitForHomePage As Integer = 60

            ' Get the user name.
            Dim uName As String = mosaicDll.dt(excelPath, iteration, "usr_username_login_credential", "Login_Username")

            ' Enter the user name.
            Dim loginBox As IWebElement
            loginBox = WaitForElement(waitForLogInPage, By.Name("username"))
            If loginBox Is Nothing Then
                mosaicDll.Logger(senderMCPAction, "Actual Result|Log in page not detected within " & waitForLogInPage.ToString() & " seconds.", _
                                 myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Log in page not detected within " & waitForLogInPage.ToString() & " seconds."
                Return returnValues
            End If
            loginBox.SendKeys(uName)

            ' Click on the "Submit" button.
            Dim submitButton As IWebElement
            Try
                submitButton = driver.FindElement(By.XPath("//input[@value='Submit']"))
            Catch ex As Exception
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Unable to locate the submit button."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Submit button not detected.", myLogPath, , actionHistoryRecordID)
                Return returnValues
            End Try
            submitButton.Click()

            ' Confirm that we're at the home page.
            If WaitForElement(waitForHomePage, By.XPath(".//*[@id='homepageForm']")) Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Home page not detected within " & waitForHomePage.ToString() & " seconds using user name, '" & uName & "'."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Home page not detected within " & waitForHomePage.ToString() & _
                                 " seconds using user name, '" & uName & "'.", myLogPath, , actionHistoryRecordID)
                Return returnValues
            End If
            returnValues(1) = "Home page displayed after logging in as '" & uName & "'."
            mosaicDll.Logger(senderMCPAction, "Actual Result|Navigated to home page with user name, '" & uName & "'.", _
                             myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, CStr(returnValues(1)) & " " & "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Nav_Logout(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            'Const waitForCommitButton As Integer = 1
            Const waitForLogInPage As Integer = 30

            ' Click on the "Logout" link.
            Dim logOutButton As IWebElement
            Try
                logOutButton = driver.FindElement(By.XPath("//a[contains(text(),'Logout')]"))
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Unable to locate the log out button."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Log out button not detected.", myLogPath, , actionHistoryRecordID)
                Return returnValues
            End Try
            Try
                logOutButton.Click()
            Catch ex As Exception   ' If this fails, just continue. The log in page test below will fail and report there's a problem.
            End Try

            ' driver.SwitchTo().Alert().Accept()

            'Check all input fields
            'If retval Is Nothing Then
            Dim AllInputFields As IList(Of IWebElement)



            Dim sname As String = "OK"
            AllInputFields = CType(driver.FindElements(By.XPath("//" & "input")), IList(Of IWebElement))
            For Each element As IWebElement In AllInputFields
                If element.GetAttribute("value").ToUpper.ToString() = "OK" Then
                    element.Click()
                    Exit For
                End If

            Next
            'End If

            ' Click on the pop up window's confirmation.
            'Dim commitButton As IWebElement
            'commitButton = WaitForElement(waitForCommitButton, By.CssSelector("#confirmationPopupCommitButton"))
            'If commitButton Is Nothing Then
            '    returnValues(0) = executionStatusFailed
            '    returnValues(1) = "Unable to locate the log out 'commit' button."
            '    mosaicDll.Logger(senderMCPAction, "Actual Result|Log out 'commit' button not detected.", myLogPath, , actionHistoryRecordID)
            '    Return returnValues
            'End If
            'Try
            '    commitButton.Click()
            'Catch ex As Exception   ' If this fails, just continue. The log in page test below will fail and report there's a problem.
            'End Try

            '  Confirm that the log-in page appears.

            Dim thisObject As Object = Nothing
            Dim thisElememt As IWebElement = Nothing

            'thisObject = WaitForElement(driver, WaitForTime, By.XPath(" //input[@id='loginButton']"))
            thisObject = WaitForElement(driver, WaitForTime, By.Id("loginButton"))


            If Not thisObject Is Nothing Then
                returnValues(1) = returnValues(1) & " Log out successful. Log-in page displayed."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Did not detect the log-in page within " & waitForLogInPage.ToString() & " seconds."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Log-in page not detected within " & waitForLogInPage.ToString() & " seconds.", myLogPath, , actionHistoryRecordID)

            End If


            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Click_on_NonReport_Link(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForLink As Integer = 1

            ' Click on the link that contains the specified text.
            Dim linkText As String = mosaicDll.dt(excelPath, iteration, "linknr_non_report_links", "Link").Trim()
            Dim link As IWebElement
            link = WaitForElement(waitForLink, By.LinkText(linkText))
            If link Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Unable to locate '" & linkText & "' link."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to locate '" & linkText & "' link on page.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If
            link.Click()
            returnValues(1) = "Clicked on '" & linkText & "' link."
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function eBkng_Home_Verify_Greeting_with_User_Name(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim greetingStr As String
            Dim portion As String
            Dim userName As String
            Dim logMsg As StringBuilder = New StringBuilder()
            Const waitForGreeting As Integer = 1

            ' Grab the greeting string from the screen.
            Dim greeting As IWebElement
            greeting = WaitForElement(waitForGreeting, By.XPath(".//*[@id='homepageForm']/table[1]/tbody/tr/td/table/tbody/tr/td[@class='titleCell']/h1"))
            If greeting Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to locate greeting on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Page greeting not found.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If
            greetingStr = greeting.Text.Trim()

            ' Test the salutation portion.
            portion = greetingStr.Substring(0, 5)
            If portion <> "Good " Then
                logMsg.Append("Expected ""Good "", got '" & portion & "'.|")
                returnValues(0) = executionStatusFailed
            End If
            portion = greetingStr.Substring(5, 11)
            If portion.Substring(0, 9) <> "Morning, " AndAlso portion <> "Afternoon, " Then
                logMsg.Append("Defective time of day reference. Text general location contains: '" & portion & "'.|")
                returnValues(0) = executionStatusFailed
            End If

            ' Obtain the user name from the data profile.
            userName = mosaicDll.dt(excelPath, iteration, "usr_username_login_credential", "User_Name").Trim()

            ' Test for the presence of the correct user name.
            If userName <> "" Then
                If Not greetingStr.Contains(userName) Then
                    logMsg.Append("Expected user name '" & userName & "' is not present in the greeting.|")
                    returnValues(0) = executionStatusFailed
                End If
            Else ' There is no name to check, so forget it.
                logMsg.Append("Data profile field ""User_Name"" is empty. Skipping validation of name.|")
            End If

            ' If all went well, say so in the log.
            If CInt(returnValues(0)) = executionStatusPassed Then
                logMsg.Append("Greeting passed all validations.|")
            Else
                CaptureScreenshot(actionHistoryRecordID)
            End If

            ' Remove the final pipe character from the log message.
            If logMsg.Length > 0 Then
                logMsg.Length = logMsg.Length - 1
            End If

            mosaicDll.Logger(senderMCPAction, "Actual Result|" & logMsg.ToString(), myLogPath, , actionHistoryRecordID)
            returnValues(1) = logMsg.ToString()
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = "Exception: '" & ex.Message & "'"
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function eBkng_Home_Verify_Cash_Management_Current_Balance(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForBalValue As Integer = 1

            ' Open the DB.
            Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            Select Case OpenConstantSqlDB(dbServer)
                Case dbError
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Unable to open '" & dbServer & "' database."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
                Case dbChanged
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Data profile specifies a changed database URL."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            End Select
            If CInt(returnValues(0)) <> executionStatusPassed Then
                Exit Try
            End If

            ' Fetch the value to check from the database.
            Dim sqlStmt As String = "SELECT [BALANCE_TOTAL] FROM [eBanking].[dbo].[cV_CUSTOMER_SUMMARY_CM] WHERE CUSTOMER_NUMBER = '" & _
                                    PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5) & "' AND AS_OF_DATE = '" & _
                                    mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "Current_as_of_date_yyyy_mm_dd").Trim() & _
                                    " 00:00:00.0'"
            Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
            Dim val As Object
            Try
                val = sqlCmd.ExecuteScalar()
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try
            Dim dbValue As String = CStr(IIf(IsDBNull(val), nulFlg, val))     ' Field defined as nullable in DB.
            Dim currentBalance As Decimal
            If IsNumeric(dbValue) Then
                currentBalance = Decimal.Round(CDec(sqlCmd.ExecuteScalar()), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert '" & dbValue & "' from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert '" & dbValue & "' from the database to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            ' Get the corresponding value from the Web page.
            Dim balanceValue As IWebElement
            balanceValue = WaitForElement(waitForBalValue, _
                    By.XPath("//th[contains(text(), 'Current Balance')]/parent::*/following-sibling::tr/td/span"))
            If balanceValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate balance value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain balance value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageValueStr As String = balanceValue.Text

            'Remove the dollar sign and commas from the page's value.
            Dim modifiedPageValueStr As String = CleanMonetaryString(pageValueStr)

            ' Convert the page's string value to a decimal value.
            Dim pageValue As Decimal
            If IsNumeric(modifiedPageValueStr) Then
                pageValue = Decimal.Round(CDec(modifiedPageValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert page balance '" & pageValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert page balance '" & pageValueStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Data validation.
            If pageValue = currentBalance Then
                returnValues(1) = "Balance value correct."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Balance value correct.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Balance Value - Expected:" & dbValue & " Page:" & modifiedPageValueStr
                mosaicDll.Logger(senderMCPAction, "Actual Result|Balance Value - Expected:" & dbValue & " Page:" & modifiedPageValueStr, _
                                 myLogPath, , actionHistoryRecordID)
            End If
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = "Exception: '" & ex.Message & "'"
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            eBkng_Home_Verify_Cash_Management_Current_Balance = returnValues
        End Try
    End Function
    Public Function eBkng_Home_Verify_Collateral_Totals(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForValue As Integer = 1

            ' Open the DB.
            Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            Select Case OpenConstantSqlDB(dbServer)
                Case dbError
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Unable to open '" & dbServer & "' database."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
                Case dbChanged
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Data profile specifies a changed database URL."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            End Select
            If CInt(returnValues(0)) <> executionStatusPassed Then
                Exit Try
            End If

            ' Fetch the values to use for validation from the database.
            Dim sqlStmt As String = "SELECT [TotalCollateral], [ExcessCollateral] FROM [eBanking].[dbo].[cV_COLLATERAL_HISTORY_SUMMARY] " & _
                                    "WHERE Customer_Number = '" & PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5) & _
                                    "' AND Load_Date = '" & _
                                    mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "Current_as_of_date_yyyy_mm_dd").Trim() & " 00:00:00.000'"
            Dim totalCollateralStr As String = Nothing
            Dim excessCollateralStr As String = Nothing
            Try
                Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
                Dim reader As SqlDataReader = sqlCmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim val As Object
                    For i As Integer = 0 To 1
                        val = reader.GetValue(i)
                        Select Case i
                            Case 0
                                totalCollateralStr = CStr(IIf(IsDBNull(val), nulFlg, val))      ' Field defined as nullable in DB.
                            Case 1
                                excessCollateralStr = CStr(IIf(IsDBNull(val), nulFlg, val))     ' Field defined as nullable in DB.
                        End Select
                    Next
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Validation values query returned no record."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                    Exit Function
                End If
                reader.Close()
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try
            Dim valdteTotalCollateral As Object = Nothing               ' "Object" so that it can signify a null value.
            Dim valdteExcessCollateral As Object = Nothing              ' "Object" so that it can signify a null value.
            If IsNumeric(totalCollateralStr) Then
                valdteTotalCollateral = Decimal.Round(CDec(totalCollateralStr), 2)
            ElseIf totalCollateralStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert total collateral ('" & totalCollateralStr & "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert total collateral ('" & totalCollateralStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If IsNumeric(excessCollateralStr) Then
                valdteExcessCollateral = Decimal.Round(CDec(excessCollateralStr), 2)
            ElseIf excessCollateralStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & "Unable to convert excess collateral ('" & excessCollateralStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert excess collateral ('" & excessCollateralStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If CInt(returnValues(0)) = executionStatusFailed Then
                Exit Function
            End If

            ' Get the corresponding values from the Web page.
            Const partialXpath As String = _
                "//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[3]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td["
            Dim totalCollateralValue As IWebElement
            Dim excessCollateralValue As IWebElement
            totalCollateralValue = WaitForElement(waitForValue, By.XPath(partialXpath & "1]/span"))
            If totalCollateralValue Is Nothing AndAlso totalCollateralStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate total collateral value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain total collateral value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageTotalCollateralStr As String
            If totalCollateralValue IsNot Nothing Then
                pageTotalCollateralStr = totalCollateralValue.Text
            Else
                pageTotalCollateralStr = nulFlg
            End If
            excessCollateralValue = WaitForElement(waitForValue, By.XPath(partialXpath & "2]/span"))
            If excessCollateralValue Is Nothing AndAlso excessCollateralStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate excess collateral value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain excess collateral value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageExcessCollateralStr As String = excessCollateralValue.Text
            If excessCollateralValue IsNot Nothing Then
                pageExcessCollateralStr = excessCollateralValue.Text
            Else
                pageExcessCollateralStr = nulFlg
            End If

            'Remove the dollar sign and commas from the page's numeric values (does nothing to the nulFlg values).
            Dim modifiedPageTotalCollateralStr As String = CleanMonetaryString(pageTotalCollateralStr)
            Dim modifiedPageExcessCollateralStr As String = CleanMonetaryString(pageExcessCollateralStr)

            ' Convert the page's string values to decimal values.
            Dim pageTotalCollateral As Object = Nothing             ' "Object" so that it can signify a null value.
            If IsNumeric(modifiedPageTotalCollateralStr) Then
                pageTotalCollateral = Decimal.Round(CDec(modifiedPageTotalCollateralStr), 2)
            ElseIf modifiedPageTotalCollateralStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert page balance '" & pageTotalCollateralStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert page balance '" & pageTotalCollateralStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageExcessCollateral As Object = Nothing             ' "Object" so that it can signify a null value.
            If IsNumeric(modifiedPageExcessCollateralStr) Then
                pageExcessCollateral = Decimal.Round(CDec(modifiedPageExcessCollateralStr), 2)
            ElseIf modifiedPageExcessCollateralStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert page balance '" & pageExcessCollateralStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert page balance '" & pageExcessCollateralStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Validate page values.
            Dim TotalsMatch As Boolean = (pageTotalCollateral Is Nothing AndAlso valdteTotalCollateral Is Nothing) _
                                            OrElse (CDec(pageTotalCollateral) = CDec(valdteTotalCollateral))
            Dim ExcessesMatch As Boolean = (pageExcessCollateral Is Nothing AndAlso valdteExcessCollateral Is Nothing) _
                                            OrElse (CDec(pageExcessCollateral) = CDec(valdteExcessCollateral))
            If TotalsMatch AndAlso ExcessesMatch Then
                returnValues(1) = "Both collateral values are correct."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Both collateral values are correct.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            returnValues(0) = executionStatusFailed
            If Not TotalsMatch Then
                returnValues(1) = "Total collateral value - Expected:" & totalCollateralStr & " Page:" & modifiedPageTotalCollateralStr & "|"
            End If
            If Not ExcessesMatch Then
                returnValues(1) = CStr(returnValues(1)) & "Excess collateral value - Expected:" & excessCollateralStr & _
                    " Page:" & modifiedPageExcessCollateralStr & "|"
            End If
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = "Exception: '" & ex.Message & "'"
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Dim str As String = CStr(returnValues(1))
            If str.EndsWith("|") Then
                returnValues(1) = str.Remove(str.Length - 1)    ' Remove the final pipe character from the message.
            End If
            eBkng_Home_Verify_Collateral_Totals = returnValues
        End Try
    End Function
    Public Function eBkng_Home_Verify_Liquidity_and_Funding_Totals(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim testValue As Object
            Dim errorFieldName As String
            Dim erroneousString As String
            Dim problemFields As New StringBuilder()
            Const waitForValue As Integer = 1
            Dim ConvertStringToNumeric As Func(Of String, Boolean, Object) = _
                Function(numStr As String, convertToDec As Boolean) As Object
                    If IsNumeric(numStr) Then
                        If convertToDec Then
                            Return Decimal.Round(CDec(numStr), 2)
                        Else
                            Return CInt(numStr)
                        End If
                    Else
                        Return Nothing
                    End If
                End Function

            ' Open the DB.
            Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            Select Case OpenConstantSqlDB(dbServer)
                Case dbError
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Unable to open '" & dbServer & "' database."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
                Case dbChanged
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Data profile specifies a changed database URL."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            End Select
            If CInt(returnValues(0)) <> executionStatusPassed Then
                Exit Try
            End If

            ' Fetch the values to use for validation from the database.
            Dim sqlStmt As String = "SELECT [ADVANCE_TOTAL],[LOC_TOTAL],[CE_TOTAL],[SWAP_TOTAL],[PREPAY_TOTAL],[CREDIT_TOTAL],[RISK_RATING]," & _
                "[CAPSTOCK_BALANCE],[EXCESS_STOCK_BALANCE] FROM [eBanking].[dbo].[cV_CUSTOMER_SUMMARY_LF] WHERE CUSTOMER_NUMBER = '" & _
                PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5) & "'"
            Dim advanceTotalStr As String = Nothing
            Dim LOCsStr As String = Nothing
            Dim currentCEStr As String = Nothing
            Dim swapTotalStr As String = Nothing
            Dim prepayTotalStr As String = Nothing
            Dim creditTotalStr As String = Nothing
            Dim riskRatingStr As String = Nothing
            Dim capitolStockStr As String = Nothing
            Dim excessCapitolStockStr As String = Nothing
            Try
                Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
                Dim reader As SqlDataReader = sqlCmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim val As Object
                    For i As Integer = 0 To 8
                        val = reader.GetValue(i)
                        Select Case i
                            Case 0
                                advanceTotalStr = CStr(val)
                            Case 1
                                LOCsStr = CStr(val)
                            Case 2
                                currentCEStr = CStr(val)
                            Case 3
                                swapTotalStr = CStr(val)
                            Case 4
                                prepayTotalStr = CStr(val)
                            Case 5
                                creditTotalStr = CStr(val)
                            Case 6
                                riskRatingStr = CStr(IIf(IsDBNull(val), nulFlg, val)).Trim()   ' Field defined as nullable in DB.
                            Case 7
                                capitolStockStr = CStr(val)
                            Case 8
                                excessCapitolStockStr = CStr(val)
                        End Select
                    Next
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Validation values query returned no record."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                    Exit Function
                End If
                reader.Close()
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try

            ' Convert the database values from strings into numeric variables.
            Dim valdteAdvanceTotal As Decimal
            Dim valdteLOCs As Decimal
            Dim valdteCurrentCE As Decimal
            Dim valdteSwapTotal As Decimal
            Dim valdtePrepayTotal As Decimal
            Dim valdteCreditTotal As Decimal
            Dim valdteRiskRating As Object = Nothing    ' "Object" so that it can signify a null value.
            Dim valdteCapitolStock As Decimal
            Dim valdteExcessCapitolStock As Decimal
            problemFields.Length = 0
            For i As Integer = 0 To 8
                testValue = Nothing
                errorFieldName = ""
                erroneousString = ""
                Select Case i
                    Case 0
                        testValue = ConvertStringToNumeric(advanceTotalStr, True)
                        If testValue IsNot Nothing Then
                            valdteAdvanceTotal = CDec(testValue)
                        Else
                            errorFieldName = "advance total"
                            erroneousString = advanceTotalStr
                        End If
                    Case 1
                        testValue = ConvertStringToNumeric(LOCsStr, True)
                        If testValue IsNot Nothing Then
                            valdteLOCs = CDec(testValue)
                        Else
                            errorFieldName = "LOCs"
                            erroneousString = LOCsStr
                        End If
                    Case 2
                        testValue = ConvertStringToNumeric(currentCEStr, True)
                        If testValue IsNot Nothing Then
                            valdteCurrentCE = CDec(testValue)
                        Else
                            errorFieldName = "current CE"
                            erroneousString = currentCEStr
                        End If
                    Case 3
                        testValue = ConvertStringToNumeric(swapTotalStr, True)
                        If testValue IsNot Nothing Then
                            valdteSwapTotal = CDec(testValue)
                        Else
                            errorFieldName = "swap total"
                            erroneousString = swapTotalStr
                        End If
                    Case 4
                        testValue = ConvertStringToNumeric(prepayTotalStr, True)
                        If testValue IsNot Nothing Then
                            valdtePrepayTotal = CDec(testValue)
                        Else
                            errorFieldName = "prepay total"
                            erroneousString = prepayTotalStr
                        End If
                    Case 5
                        testValue = ConvertStringToNumeric(creditTotalStr, True)
                        If testValue IsNot Nothing Then
                            valdteCreditTotal = CDec(testValue)
                        Else
                            errorFieldName = "credit total"
                            erroneousString = creditTotalStr
                        End If
                    Case 6
                        testValue = ConvertStringToNumeric(riskRatingStr, False)
                        If testValue IsNot Nothing Then
                            valdteRiskRating = CInt(testValue)
                        End If
                    Case 7
                        testValue = ConvertStringToNumeric(capitolStockStr, True)
                        If testValue IsNot Nothing Then
                            valdteCapitolStock = CDec(testValue)
                        Else
                            errorFieldName = "capitol stock"
                            erroneousString = capitolStockStr
                        End If
                    Case 8
                        testValue = ConvertStringToNumeric(excessCapitolStockStr, True)
                        If testValue IsNot Nothing Then
                            valdteExcessCapitolStock = CDec(testValue)
                        Else
                            errorFieldName = "excess capitol stock"
                            erroneousString = excessCapitolStockStr
                        End If
                End Select
                If i <> 6 AndAlso testValue Is Nothing Then
                    problemFields.Append("'" & errorFieldName & "', ")
                    mosaicDll.Logger(senderMCPAction, "Error|Unable to convert " & errorFieldName & " validation value (" & erroneousString & ") from database.", _
                                     myLogPath, , actionHistoryRecordID)
                End If
            Next
            If problemFields.Length > 2 Then                        ' There were errors in the conversions.
                problemFields.Length = problemFields.Length - 2     ' Remove the final ", " from the list of errors, report the issue and bail out.
                returnValues(0) = executionStatusFailed
                returnValues(1) = "The following validation values from the DB did not convert to numeric values: " & problemFields.ToString() & "."
                mosaicDll.Logger(senderMCPAction, "Actual Result" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            ' Get the corresponding values from the Web page.
            Dim advanceTotalValue As IWebElement
            Dim LOCsValue As IWebElement
            Dim currentCEValue As IWebElement
            Dim swapTotalValue As IWebElement
            Dim prepayTotalValue As IWebElement
            Dim creditTotalValue As IWebElement
            Dim riskRatingValue As IWebElement
            Dim capitolStockValue As IWebElement
            Dim excessCapitolStockValue As IWebElement
            Dim errorCnt As Integer = 0
            problemFields.Length = 0
            advanceTotalValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[1]/span"))
            If advanceTotalValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'advance total',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'advance total' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageAdvanceTotalStr As String = advanceTotalValue.Text
            LOCsValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/span"))
            If LOCsValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'LOCs',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'LOCs' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageLOCsStr As String = LOCsValue.Text
            currentCEValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[3]/span"))
            If currentCEValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'current CE',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'current CE' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageCurrentCEStr As String = currentCEValue.Text
            swapTotalValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[4]/span"))
            If swapTotalValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'swap total',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'swap total' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageSwapTotalStr As String = swapTotalValue.Text
            prepayTotalValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[5]/span"))
            If prepayTotalValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'prepay total',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'prepay total' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pagePrepayTotalStr As String = prepayTotalValue.Text
            creditTotalValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[6]/span"))
            If creditTotalValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'credit total',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'credit total' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageCreditTotalStr As String = creditTotalValue.Text
            riskRatingValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[5]/td[1]/label"))
            If riskRatingValue Is Nothing AndAlso riskRatingStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'risk rating',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'risk rating' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageRiskRatingStr As String
            If riskRatingValue IsNot Nothing Then
                pageRiskRatingStr = riskRatingValue.Text
            Else
                pageRiskRatingStr = nulFlg
            End If
            capitolStockValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[5]/td[2]/span"))
            If capitolStockValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'capitol stock',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'capitol stock' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageCapitolStockStr As String = capitolStockValue.Text
            excessCapitolStockValue = WaitForElement(waitForValue, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[5]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[5]/td[3]/span"))
            If excessCapitolStockValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                problemFields.Append("'excess capitol stock',")
                errorCnt += 1
                mosaicDll.Logger(senderMCPAction, "Error|Unable to obtain 'excess capitol stock' value from page.", myLogPath, , actionHistoryRecordID)
            End If
            Dim pageExcessCapitolStockStr As String = excessCapitolStockValue.Text

            ' If we didn't get all the values from the page, remove the final comma from the problem list, report the issue and bail out.
            If errorCnt > 0 Then
                If problemFields.Length > 0 Then
                    problemFields.Length = problemFields.Length - 1
                End If
                returnValues(1) = "Couldn't locate " & problemFields.ToString() & " value" & CStr(IIf(errorCnt > 1, "s", "")) & " on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Remove any dollar signs, commas and white space from the page's values.
            Dim cleanedPageAdvanceTotalStr As String = CleanMonetaryString(pageAdvanceTotalStr)
            Dim cleanedPageLOCsStr As String = CleanMonetaryString(pageLOCsStr)
            Dim cleanedPageCurrentCEStr As String = CleanMonetaryString(pageCurrentCEStr)
            Dim cleanedPageSwapTotalStr As String = CleanMonetaryString(pageSwapTotalStr)
            Dim cleanedPagePrepayTotalStr As String = CleanMonetaryString(pagePrepayTotalStr)
            Dim cleanedPageCreditTotalStr As String = CleanMonetaryString(pageCreditTotalStr)
            Dim cleanedPageRiskRatingStr As String = pageRiskRatingStr.Trim() ' An integer, so just trim white space (does nothing to a nulFlg value).
            Dim cleanedPageCapitolStockStr As String = CleanMonetaryString(pageCapitolStockStr)
            Dim cleanedPageExcessCapitolStockStr As String = CleanMonetaryString(pageExcessCapitolStockStr)

            ' Convert the page's string values to numeric values.
            Dim pageAdvanceTotal As Decimal
            Dim pageLOCs As Decimal
            Dim pageCurrentCE As Decimal
            Dim pageSwapTotal As Decimal
            Dim pagePrepayTotal As Decimal
            Dim pageCreditTotal As Decimal
            Dim pageRiskRating As Object = Nothing          ' "Object" so that it can signify a null value.
            Dim pageCapitolStock As Decimal
            Dim pageExcessCapitolStock As Decimal
            problemFields.Length = 0
            For i As Integer = 0 To 8
                testValue = Nothing
                errorFieldName = ""
                erroneousString = ""
                Select Case i
                    Case 0
                        testValue = ConvertStringToNumeric(cleanedPageAdvanceTotalStr, True)
                        If testValue IsNot Nothing Then
                            pageAdvanceTotal = CDec(testValue)
                        Else
                            errorFieldName = "advance total"
                            erroneousString = pageAdvanceTotalStr
                        End If
                    Case 1
                        testValue = ConvertStringToNumeric(cleanedPageLOCsStr, True)
                        If testValue IsNot Nothing Then
                            pageLOCs = CDec(testValue)
                        Else
                            errorFieldName = "LOCs"
                            erroneousString = pageLOCsStr
                        End If
                    Case 2
                        testValue = ConvertStringToNumeric(cleanedPageCurrentCEStr, True)
                        If testValue IsNot Nothing Then
                            pageCurrentCE = CDec(testValue)
                        Else
                            errorFieldName = "current CE"
                            erroneousString = pageCurrentCEStr
                        End If
                    Case 3
                        testValue = ConvertStringToNumeric(cleanedPageSwapTotalStr, True)
                        If testValue IsNot Nothing Then
                            pageSwapTotal = CDec(testValue)
                        Else
                            errorFieldName = "swap total"
                            erroneousString = pageSwapTotalStr
                        End If
                    Case 4
                        testValue = ConvertStringToNumeric(cleanedPagePrepayTotalStr, True)
                        If testValue IsNot Nothing Then
                            pagePrepayTotal = CDec(testValue)
                        Else
                            errorFieldName = "prepay total"
                            erroneousString = pagePrepayTotalStr
                        End If
                    Case 5
                        testValue = ConvertStringToNumeric(cleanedPageCreditTotalStr, True)
                        If testValue IsNot Nothing Then
                            pageCreditTotal = CDec(testValue)
                        Else
                            errorFieldName = "credit total"
                            erroneousString = pageCreditTotalStr
                        End If
                    Case 6
                        testValue = ConvertStringToNumeric(cleanedPageRiskRatingStr, False)
                        If testValue IsNot Nothing Then
                            pageRiskRating = CInt(testValue)
                        End If
                    Case 7
                        testValue = ConvertStringToNumeric(cleanedPageCapitolStockStr, True)
                        If testValue IsNot Nothing Then
                            pageCapitolStock = CDec(testValue)
                        Else
                            errorFieldName = "capitol stock"
                            erroneousString = pageCapitolStockStr
                        End If
                    Case 8
                        testValue = ConvertStringToNumeric(cleanedPageExcessCapitolStockStr, True)
                        If testValue IsNot Nothing Then
                            pageExcessCapitolStock = CDec(testValue)
                        Else
                            errorFieldName = "excess capitol stock"
                            erroneousString = pageExcessCapitolStockStr
                        End If
                End Select
                If i <> 6 AndAlso testValue Is Nothing Then
                    problemFields.Append("'" & errorFieldName & "', ")
                    mosaicDll.Logger(senderMCPAction, "Error|Unable to convert " & errorFieldName & " value (" & erroneousString & ") from page.", _
                                     myLogPath, , actionHistoryRecordID)
                End If
            Next
            If problemFields.Length > 2 Then                        ' There were errors in the conversions.
                problemFields.Length = problemFields.Length - 2     ' Remove the final ", " from the list of errors, report the issue and bail out.
                returnValues(0) = executionStatusFailed
                returnValues(1) = "These validation values from the DB did not convert to numeric values: " & problemFields.ToString() & "."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Validate page values.
            Dim expectedValue As String = Nothing
            Dim pageValue As String = Nothing
            problemFields.Length = 0
            For i As Integer = 0 To 8
                errorFieldName = ""
                Select Case i
                    Case 0
                        If pageAdvanceTotal <> valdteAdvanceTotal Then
                            errorFieldName = "advance total"
                            expectedValue = valdteAdvanceTotal.ToString()
                            pageValue = pageAdvanceTotal.ToString()
                        End If
                    Case 1
                        If pageLOCs <> valdteLOCs Then
                            errorFieldName = "LOCs"
                            expectedValue = valdteLOCs.ToString()
                            pageValue = pageLOCs.ToString()
                        End If
                    Case 2
                        If pageCurrentCE <> valdteCurrentCE Then
                            errorFieldName = "current CE"
                            expectedValue = valdteCurrentCE.ToString()
                            pageValue = pageCurrentCE.ToString()
                        End If
                    Case 3
                        If pageSwapTotal <> valdteSwapTotal Then
                            errorFieldName = "swap total"
                            expectedValue = valdteSwapTotal.ToString()
                            pageValue = pageSwapTotal.ToString()
                        End If
                    Case 4
                        If pagePrepayTotal <> valdtePrepayTotal Then
                            errorFieldName = "prepay total"
                            expectedValue = valdtePrepayTotal.ToString()
                            pageValue = pagePrepayTotal.ToString()
                        End If
                    Case 5
                        If pageCreditTotal <> valdteCreditTotal Then
                            errorFieldName = "credit total"
                            expectedValue = valdteCreditTotal.ToString()
                            pageValue = pageCreditTotal.ToString()
                        End If
                    Case 6
                        If Not ((pageRiskRating Is Nothing AndAlso valdteRiskRating Is Nothing) OrElse _
                                (CInt(pageRiskRating) = CInt(valdteRiskRating))) Then
                            errorFieldName = "risk rating"
                            expectedValue = riskRatingStr
                            pageValue = cleanedPageRiskRatingStr
                        End If
                    Case 7
                        If pageCapitolStock <> valdteCapitolStock Then
                            errorFieldName = "capitol stock"
                            expectedValue = valdteCapitolStock.ToString()
                            pageValue = pageCapitolStock.ToString()
                        End If
                    Case 8
                        If pageExcessCapitolStock <> valdteExcessCapitolStock Then
                            errorFieldName = "excess capitol stock"
                            expectedValue = valdteExcessCapitolStock.ToString()
                            pageValue = pageExcessCapitolStock.ToString()
                        End If
                End Select
                If errorFieldName.Length > 0 Then
                    problemFields.Append("'" & errorFieldName & "', ")
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Value '" & errorFieldName & "' (Expected: " & expectedValue & " Page: " & _
                                     pageValue & ") did not validate.", _
                                     myLogPath, , actionHistoryRecordID)
                End If
            Next
            If problemFields.Length > 2 Then                        ' There were validation errors.
                problemFields.Length = problemFields.Length - 2     ' Remove the final ", " from the list of errors & report the failure.
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Actual Result|These values did not pass validation: " & problemFields.ToString() & "."
                Exit Function
            Else
                returnValues(0) = executionStatusPassed
                returnValues(1) = "All liquidity & funding values are correct."
                mosaicDll.Logger(senderMCPAction, "Actual Result|All liquidity & funding values are correct.", myLogPath, , actionHistoryRecordID)
            End If
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = "Exception: '" & ex.Message & "'"
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            eBkng_Home_Verify_Liquidity_and_Funding_Totals = returnValues
        End Try
    End Function
    Public Function eBkng_Home_Verify_Safekeeping_Totals(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForValue As Integer = 1

            ' Open the DB.
            Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            Select Case OpenConstantSqlDB(dbServer)
                Case dbError
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Unable to open '" & dbServer & "' database."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
                Case dbChanged
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Data profile specifies a changed database URL."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            End Select
            If CInt(returnValues(0)) <> executionStatusPassed Then
                Exit Try
            End If

            ' Fetch the values to use for validation from the database.
            Dim sqlStmt As String = "SELECT [ORIGINAL_FACE_TOTAL], [CURRENT_FACE_TOTAL] FROM [eBanking].[dbo].[cV_SFK_SUMMARY] " & _
                "WHERE CUSTOMER_NUMBER = '" & PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5) & _
                "'	AND AS_OF_DATE = '" & mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "Current_as_of_date_yyyy_mm_dd").Trim() & _
                " 00:00:00.000'"
            Dim origFaceStr As String = Nothing
            Dim currFaceStr As String = Nothing
            Try
                Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
                Dim reader As SqlDataReader = sqlCmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim val As Object
                    For i As Integer = 0 To 1
                        val = reader.GetValue(i)
                        Select Case i
                            Case 0
                                origFaceStr = CStr(IIf(IsDBNull(val), nulFlg, val))     ' Field defined as nullable in DB.
                            Case 1
                                currFaceStr = CStr(IIf(IsDBNull(val), nulFlg, val))     ' Field defined as nullable in DB.     
                        End Select
                    Next
                Else                                                                    ' No record at all, so both values are null.
                    origFaceStr = nulFlg
                    currFaceStr = nulFlg
                End If
                reader.Close()
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try
            Dim valdteOrigFace As Object = Nothing
            Dim valdteCurrFace As Object = Nothing
            If IsNumeric(origFaceStr) Then
                valdteOrigFace = Decimal.Round(CDec(origFaceStr), 2)
            ElseIf origFaceStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert original face ('" & origFaceStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Error|Unable to convert original face ('" & origFaceStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If IsNumeric(currFaceStr) Then
                valdteCurrFace = Decimal.Round(CDec(currFaceStr), 2)
            ElseIf currFaceStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & "Unable to convert current face ('" & currFaceStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Error|Unable to convert current face ('" & currFaceStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If CInt(returnValues(0)) = executionStatusFailed Then
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            ' Get the corresponding values from the Web page.
            Const partialXpath As String = _
                "//div[2]/div/div[2]/div[1]/form/table[2]/tbody/tr[7]/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td["
            Dim origFaceValue As IWebElement
            Dim currFaceValue As IWebElement
            origFaceValue = WaitForElement(waitForValue, By.XPath(partialXpath & "1]/span"))
            If origFaceValue Is Nothing AndAlso origFaceStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate original face value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain original face value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageOrigFaceStr As String
            If origFaceValue IsNot Nothing Then
                pageOrigFaceStr = origFaceValue.Text
            Else
                pageOrigFaceStr = nulFlg
            End If
            currFaceValue = WaitForElement(waitForValue, By.XPath(partialXpath & "2]/span"))
            If currFaceValue Is Nothing AndAlso currFaceStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate current face value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain current face value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageCurrFaceStr As String
            If currFaceValue IsNot Nothing Then
                pageCurrFaceStr = currFaceValue.Text
            Else
                pageCurrFaceStr = nulFlg
            End If

            'Remove the dollar sign and commas from the page's numeric values (does nothing to the nulFlg values).
            Dim modifiedPageOrigFaceStr As String = CleanMonetaryString(pageOrigFaceStr)
            Dim modifiedPageCurrFaceStr As String = CleanMonetaryString(pageCurrFaceStr)

            ' Convert the page's string values to decimal values.
            Dim pageOrigFace As Object = Nothing
            If IsNumeric(modifiedPageOrigFaceStr) Then
                pageOrigFace = Decimal.Round(CDec(modifiedPageOrigFaceStr), 2)
            ElseIf modifiedPageOrigFaceStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert page original face '" & pageOrigFaceStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert page original face '" & pageOrigFaceStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageCurrFace As Object = Nothing
            If IsNumeric(modifiedPageCurrFaceStr) Then
                pageCurrFace = Decimal.Round(CDec(modifiedPageCurrFaceStr), 2)
            ElseIf modifiedPageCurrFaceStr <> nulFlg Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert page current face '" & pageCurrFaceStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert page current face '" & pageCurrFaceStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Validate the two safekeeping values.
            Dim originalsMatch As Boolean = (pageOrigFace Is Nothing AndAlso valdteOrigFace Is Nothing) _
                                            OrElse (CDec(pageOrigFace) = CDec(valdteOrigFace))
            Dim currentsMatch As Boolean = (pageCurrFace Is Nothing AndAlso valdteCurrFace Is Nothing) _
                                           OrElse (CDec(pageCurrFace) = CDec(valdteCurrFace))
            If originalsMatch AndAlso currentsMatch Then
                returnValues(1) = "Both safekeeping values are correct."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Both safekeeping values are correct.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            returnValues(0) = executionStatusFailed
            If Not originalsMatch Then
                returnValues(1) = "Original face value - Expected:" & origFaceStr & " Page:" & modifiedPageOrigFaceStr & "|"
                mosaicDll.Logger(senderMCPAction, "Error|Original face value - Expected:" & origFaceStr & " Page:" & modifiedPageOrigFaceStr & _
                                 "|", myLogPath, , actionHistoryRecordID)
            End If
            If Not currentsMatch Then
                returnValues(1) = CStr(returnValues(1)) & "Current face value - Expected:" & currFaceStr & " Page:" & modifiedPageCurrFaceStr & "|"
                mosaicDll.Logger(senderMCPAction, "Error|Current face value - Expected:" & currFaceStr & " Page:" & modifiedPageCurrFaceStr & _
                                 "|", myLogPath, , actionHistoryRecordID)
            End If
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = "Exception: '" & ex.Message & "'"
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Dim str As String = CStr(returnValues(1))
            If str.EndsWith("|") Then
                returnValues(1) = str.Remove(str.Length - 1)    ' Remove the final pipe character from the message.
            End If
            eBkng_Home_Verify_Safekeeping_Totals = returnValues
        End Try
    End Function
    Public Function Select_Institution_Search_Using_ID_or_Name(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForItem As Integer = 2
            Const waitForInstitution As Integer = 30

            ' Obtain the 2 data values we'll need for this test action.
            Dim memberId As String = PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5)
            Dim memberName As String = mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_Name").Trim()

            ' Click on the "Select an institution..." link.
            Dim selectLink As IWebElement
            selectLink = WaitForElement(waitForItem, By.XPath("//div[2]/div/table[2]/tbody/tr/td/table/tbody/tr/td[2]/a"))
            If selectLink Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Unable to locate the 'Select an institution...' link."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If
            selectLink.Click()

            ' Enter the institution ID in the input box.
            Dim institutionBox As IWebElement
            institutionBox = WaitForElement(waitForItem, By.XPath("//input[@id='picklistSearchField']"))
            If institutionBox Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Unable to locate the institution input box."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Institution input box not detected.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If
            institutionBox.SendKeys(memberId)

            ' Click the 1st institution in the list - which should be the only one left after entering the ID value above.
            Dim institutionListItem As IWebElement
            institutionListItem = WaitForElement(waitForItem, By.CssSelector("#picklistSelectList>option"))
            If institutionListItem Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Unable to locate the specified institution (#" & memberId & ") in the list."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Specified institution (#" & memberId & ") not detected in the list.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If
            institutionListItem.Click()

            ' Click the "OK" button under the list.
            Dim okButton As IWebElement
            okButton = WaitForElement(waitForItem, By.XPath("//input[@id='picklistOkButton']"))
            If okButton Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Unable to locate the 'institution selection OK' button."
                mosaicDll.Logger(senderMCPAction, "Actual Result|'Institution selection OK' button not detected.", _
                                 myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If
            okButton.Click()

            ' Confirm the institution is selected.
            Dim customerName As IWebElement
            customerName = WaitForElement(waitForInstitution, By.CssSelector(".customerName"))
            Dim nameStr As String = customerName.Text.Trim()
            If Not (nameStr.Contains(memberId) AndAlso nameStr.Contains(memberName)) Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Institution '" & memberName & "' (#" & memberId & ") not successfully selected."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If

            returnValues(1) = "Institution '" & memberName & "' (#" & memberId & ") selected."
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function eBnkg_Home_Verify_Affordable_Housing_Totals(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForValue As Integer = 1

            ' Open the DB.
            Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            Select Case OpenConstantSqlDB(dbServer)
                Case dbError
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Unable to open '" & dbServer & "' database."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
                Case dbChanged
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Data profile specifies a changed database URL."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            End Select
            If CInt(returnValues(0)) <> executionStatusPassed Then
                Exit Try
            End If

            ' Fetch the value to check from the database.
            Dim sqlStmt As String = "SELECT [TOTAL_GRANT_AMOUNT], [TOTAL_DOWN_PAYMENT_AMOUNT] FROM [eBanking].[dbo].[cV_AHP_SUMMARY] WHERE CUSTOMER_NUMBER = '" & _
                PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5) & "'"
            Dim totalGrantStr As String = Nothing
            Dim totalDownPaymentStr As String = Nothing
            Try
                Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
                Dim reader As SqlDataReader = sqlCmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim val As Object
                    For i As Integer = 0 To 1
                        val = reader.GetValue(i)
                        Select Case i
                            Case 0
                                totalGrantStr = CStr(IIf(IsDBNull(val), nulFlg, val))           ' Field defined as nullable in DB. 
                            Case 1
                                totalDownPaymentStr = CStr(IIf(IsDBNull(val), nulFlg, val))     ' Field defined as nullable in DB.  
                        End Select
                    Next
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Validation values query returned no record."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                    Exit Function
                End If
                reader.Close()
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try
            Dim valdteTotalGrant As Decimal
            Dim valdteTotalDownPayment As Decimal
            If IsNumeric(totalGrantStr) Then
                valdteTotalGrant = Decimal.Round(CDec(totalGrantStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert the total grant value ('" & totalGrantStr & "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert total grant value ('" & totalGrantStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If IsNumeric(totalDownPaymentStr) Then
                valdteTotalDownPayment = Decimal.Round(CDec(totalDownPaymentStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & "Unable to convert the total down payment value ('" & totalDownPaymentStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert total down payment value ('" & totalDownPaymentStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If CInt(returnValues(0)) = executionStatusFailed Then
                Exit Function
            End If

            ' Get the corresponding values from the Web page.
            ' Find a span that contains, "Affordable Housing," trace back up to the "tr" element it's in and proceed down to the 2 spans with the values. 
            Const partialXpath As String = "//span[text()='Affordable Housing']/ancestor::tr/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td["
            Dim totalGrantValue As IWebElement
            Dim totalDownPaymentValue As IWebElement
            totalGrantValue = WaitForElement(waitForValue, By.XPath(partialXpath & "1]/span"))
            If totalGrantValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate total grant value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain total grant value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageTotalGrantValueStr As String = totalGrantValue.Text
            totalDownPaymentValue = WaitForElement(waitForValue, By.XPath(partialXpath & "2]/span"))
            If totalDownPaymentValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate total down payment value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain total down payment value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageTotalDownPaymentValueStr As String = totalDownPaymentValue.Text

            'Remove the dollar sign and commas from the page's values.
            Dim modifiedPageTotalGrantValueStr As String = CleanMonetaryString(pageTotalGrantValueStr)
            Dim modifiedPageTotalDownPaymentValueStr As String = CleanMonetaryString(pageTotalDownPaymentValueStr)

            ' Convert the page's string values to decimal values.
            Dim pageTotalGrant As Decimal
            If IsNumeric(modifiedPageTotalGrantValueStr) Then
                pageTotalGrant = Decimal.Round(CDec(modifiedPageTotalGrantValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert total grant value '" & pageTotalGrantValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert total grant value '" & pageTotalGrantValueStr & _
                                 "' to a numeric value.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageTotalDownPayment As Decimal
            If IsNumeric(modifiedPageTotalDownPaymentValueStr) Then
                pageTotalDownPayment = Decimal.Round(CDec(modifiedPageTotalDownPaymentValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert total down payment '" & pageTotalDownPaymentValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert total down payment '" & pageTotalDownPaymentValueStr & _
                                 "' to a numeric value.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Validate page values.
            Dim GrantsMatch As Boolean = (pageTotalGrant = valdteTotalGrant)
            Dim DownPaymentsMatch As Boolean = (pageTotalDownPayment = valdteTotalDownPayment)
            If GrantsMatch AndAlso DownPaymentsMatch Then
                returnValues(1) = "Both affordable housing values are correct."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            returnValues(0) = executionStatusFailed
            If Not GrantsMatch Then
                returnValues(1) = "Total grant value - Expected:" & valdteTotalGrant.ToString() & " Page:" & modifiedPageTotalGrantValueStr & "|"
            End If
            If Not DownPaymentsMatch Then
                returnValues(1) = CStr(returnValues(1)) & "Down payment value - Expected:" & valdteTotalDownPayment.ToString() & _
                    " Page:" & modifiedPageTotalDownPaymentValueStr & "|"
            End If
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = "Exception: '" & ex.Message & "'"
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Dim str As String = CStr(returnValues(1))
            If str.EndsWith("|") Then
                returnValues(1) = str.Remove(str.Length - 1)    ' Remove the final pipe character from the message.
            End If
            eBnkg_Home_Verify_Affordable_Housing_Totals = returnValues
        End Try
    End Function
    Public Function eBnkng_Home_MPF_Program_Totals(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForValue As Integer = 1

            ' Open the DB.
            Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            Select Case OpenConstantSqlDB(dbServer)
                Case dbError
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Unable to open '" & dbServer & "' database."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
                Case dbChanged
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Data profile specifies a changed database URL."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            End Select
            If CInt(returnValues(0)) <> executionStatusPassed Then
                Exit Try
            End If

            ' Fetch the 3 values to check from the database.
            Dim sqlStmt As String = "SELECT [MCTotalAmount], [LoansFunded], [UPB] FROM [eBanking].[dbo].[cV_MPF_SUMMARY] WHERE CUSTOMER_NUMBER = '" & _
                PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5) & "'"
            Dim MCTotalAmountStr As String = Nothing
            Dim loansFundedStr As String = Nothing
            Dim UPBStr As String = Nothing
            Try
                Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
                Dim reader As SqlDataReader = sqlCmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim val As Object
                    For i As Integer = 0 To 2
                        val = reader.GetValue(i)
                        Select Case i
                            Case 0
                                MCTotalAmountStr = CStr(IIf(IsDBNull(val), nulFlg, val))        ' Field defined as nullable in DB.
                            Case 1
                                loansFundedStr = CStr(IIf(IsDBNull(val), nulFlg, val))          ' Field defined as nullable in DB.  
                            Case 2
                                UPBStr = CStr(IIf(IsDBNull(val), nulFlg, val))                  ' Field defined as nullable in DB.  
                        End Select
                    Next
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Validation values query returned no record."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                    Exit Function
                End If
                reader.Close()
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try

            ' Get the validation values in the strings converted into numeric values.
            Dim valdteMCTotalAmount As Decimal
            Dim valdteLoansFunded As Decimal
            Dim valdteUPB As Decimal
            If IsNumeric(MCTotalAmountStr) Then
                valdteMCTotalAmount = Decimal.Round(CDec(MCTotalAmountStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert the MC total amount value ('" & MCTotalAmountStr & "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert MC total amount value ('" & MCTotalAmountStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If IsNumeric(loansFundedStr) Then
                valdteLoansFunded = Decimal.Round(CDec(loansFundedStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & "Unable to convert the loans funded value ('" & loansFundedStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert loans funded value ('" & loansFundedStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If IsNumeric(UPBStr) Then
                valdteUPB = Decimal.Round(CDec(UPBStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & "Unable to convert the UPB value ('" & UPBStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert UPB value ('" & UPBStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If CInt(returnValues(0)) = executionStatusFailed Then
                Exit Function
            End If

            ' Get the corresponding values from the Web page.
            ' Find a span that contains, "MPF Program," trace back up to the "tr" element it's in and proceed down to the 3 spans with the values. 
            Const partialXpath As String = "//span[text()='MPF Program']/ancestor::tr/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td["
            Dim MCTotalAmountValue As IWebElement
            Dim loansFundedValue As IWebElement
            Dim totalUPBValue As IWebElement
            MCTotalAmountValue = WaitForElement(waitForValue, By.XPath(partialXpath & "1]/span"))
            If MCTotalAmountValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate MC total amount value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain MC total amount value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageMCTotalAmountValueStr As String = MCTotalAmountValue.Text
            loansFundedValue = WaitForElement(waitForValue, By.XPath(partialXpath & "2]/span"))
            If loansFundedValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate loans funded value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain loans funded value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageLoansFundedValueStr As String = loansFundedValue.Text
            totalUPBValue = WaitForElement(waitForValue, By.XPath(partialXpath & "3]/span"))
            If totalUPBValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate UPB value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to obtain UPB value from page.", myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageUPBValueStr As String = totalUPBValue.Text

            'Remove the dollar sign and commas from the page's values.
            Dim modifiedPageMCTotalAmountValueStr As String = CleanMonetaryString(pageMCTotalAmountValueStr)
            Dim modifiedPageLoansFundedValueStr As String = CleanMonetaryString(pageLoansFundedValueStr)
            Dim modifiedPageUPBValueStr As String = CleanMonetaryString(pageUPBValueStr)

            ' Convert the page's string values to decimal values.
            Dim pageMCTotalAmount As Decimal
            If IsNumeric(modifiedPageMCTotalAmountValueStr) Then
                pageMCTotalAmount = Decimal.Round(CDec(modifiedPageMCTotalAmountValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert MC total amount value '" & pageMCTotalAmountValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert MC total amount '" & pageMCTotalAmountValueStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageLoansFunded As Decimal
            If IsNumeric(modifiedPageLoansFundedValueStr) Then
                pageLoansFunded = Decimal.Round(CDec(modifiedPageLoansFundedValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert loans funded value '" & pageLoansFundedValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert loans funded '" & pageLoansFundedValueStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageUPB As Decimal
            If IsNumeric(modifiedPageUPBValueStr) Then
                pageUPB = Decimal.Round(CDec(modifiedPageUPBValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert current UPB value '" & pageUPBValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert current UPB '" & pageUPBValueStr & "' to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Validate page values.
            Dim MCTotalAmountsMatch As Boolean = (pageMCTotalAmount = valdteMCTotalAmount)
            Dim LoansFundedsMatch As Boolean = (pageLoansFunded = valdteLoansFunded)
            Dim UPBsMatch As Boolean = (pageUPB = valdteUPB)
            If MCTotalAmountsMatch AndAlso LoansFundedsMatch AndAlso UPBsMatch Then
                returnValues(1) = "All 3 MPF Program values are correct."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            returnValues(0) = executionStatusFailed ' Past here, we've got problems.
            Dim errorStr As String = ""
            If Not MCTotalAmountsMatch Then
                errorStr = "MC total amount value - Expected:" & valdteMCTotalAmount.ToString() & _
                    " Page:" & modifiedPageMCTotalAmountValueStr & "|"
            End If
            If Not LoansFundedsMatch Then
                errorStr = errorStr & "Loans funded value - Expected:" & valdteLoansFunded.ToString() & _
                    " Page:" & modifiedPageLoansFundedValueStr & "|"
            End If
            If Not UPBsMatch Then
                errorStr = errorStr & "Current UPB value - Expected:" & valdteUPB.ToString() & _
                    " Page:" & modifiedPageUPBValueStr & "|"
            End If
            returnValues(1) = errorStr.TrimEnd("|".ToCharArray())
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = "Exception: '" & ex.Message & "'"
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Dim str As String = CStr(returnValues(1))
            If str.EndsWith("|") Then
                returnValues(1) = str.Remove(str.Length - 1)    ' Remove the final pipe character from the message.
            End If
            eBnkng_Home_MPF_Program_Totals = returnValues
        End Try
    End Function
    Public Function Nav_CID_Acc_by_Side_Menu(ByVal mcpParameters() As Object) As Object
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)


        Try

            'Find out what menu option we need to click
            Dim sMain_Page_Link As String = mosaicDll.dt(excelPath, iteration, "cidmopt_cid_side_menu_options", "Main_Page_Link")
            Dim sLink_on_Resulting_Page As String = mosaicDll.dt(excelPath, iteration, "cidmopt_cid_side_menu_options", "Link_on_Resulting_Page")

            'Locate the menu item
            'Dim TopLevelMenu As IWebElement = driver.FindElement(By.XPath("//a[contains(.,'" & sMain_Page_Link & "')]"))
            Dim TopLevelMenu As IWebElement = driver.FindElement(By.XPath("//a[. = '" & sMain_Page_Link & "']"))
            If Not TopLevelMenu Is Nothing Then
                TopLevelMenu.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Navigated to: " & sMain_Page_Link, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & " Could not navigate to:" & sMain_Page_Link
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not navigate to :" & sMain_Page_Link, myLogPath, , actionHistoryRecordID)
            End If

            If sLink_on_Resulting_Page.ToLower <> "n/a" Then
                '  Dim MenuItem As IWebElement = driver.FindElement(By.XPath("//a[contains(.,'" & sLink_on_Resulting_Page & "')]"))
                Dim MenuItem As IWebElement = driver.FindElement(By.XPath("//a[. ='" & sLink_on_Resulting_Page & "']"))
                If Not MenuItem Is Nothing Then
                    MenuItem.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Navigated to: " & sLink_on_Resulting_Page, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & " Could not navigate to: " & sLink_on_Resulting_Page
                    mosaicDll.Logger(senderMCPAction, "Actual Result  |Could not navigate to: " & sLink_on_Resulting_Page, myLogPath, , actionHistoryRecordID)
                End If
            End If
            Return returnValues

        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try

    End Function
    Public Function CleanString(ByVal sCleanMe As String) As String


        sCleanMe = sCleanMe.Replace(" ", "")  'Remove Spaces
        sCleanMe = sCleanMe.ToUpper() 'Convert to upper case
        sCleanMe = sCleanMe.ToUpper() 'Remove leading and trailing spaces

        CleanString = sCleanMe

    End Function
    Public Function Nav_Access_Tab_By_Menu_Submenu(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim previousHref As String
            Dim dynamicHref As String
            Dim dynamicAnchorId As String = ""
            Dim menuPos As Integer = 0
            Dim menuItemStr As String
            Dim subMenuItemNumb As Integer
            Dim subMenuItemNumbStr As String
            Dim menuItem As IWebElement
            Dim targetPageName As String
            Const maxMenuItems As Integer = 7                   ' Set to slightly greater than the most drop down menu items expected.
            Const offset As Integer = 2                 ' How much to move the mouse cursor between attempts to find the "next" drop down item.
            Const maxStepCount As Integer = 25 * maxMenuItems   ' Value used to decide we've dropped through the drop down menu's bottom.
            Const waitForLink As Integer = 2
            Const waitForTargetPage As Integer = 30
            Const partialMenuXpath As String = "//a[text()='Cash Management']/ancestor::tr/*/a[text()='"

            menuItemStr = mosaicDll.dt(excelPath, iteration, "mopt_menu_submenu_option", "Menu").Trim()
            subMenuItemNumbStr = mosaicDll.dt(excelPath, iteration, "mopt_menu_submenu_option", "SubmenuPosition").Trim()
            targetPageName = mosaicDll.dt(excelPath, iteration, "mopt_menu_submenu_option", "Module").Trim()
            If IsNumeric(subMenuItemNumbStr) Then
                subMenuItemNumb = CInt(subMenuItemNumbStr)
            Else ' Not a numeric sub menu designator.
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Cannot find sub menu item. There is a problem with the data profile: 'SubmenuPosition' is not an integer value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If
            If subMenuItemNumb < 1 Then ' Not a valid sub menu designator.
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Cannot find sub menu item. There is a problem with the data profile: 'SubmenuPosition' must be 1 or greater."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If

            'Determine which of the "optional" menu items exist.
            Dim affordableHousingExists As Boolean = (WaitForElement(1, By.XPath(partialMenuXpath & "Affordable Housing']")) IsNot Nothing)
            Dim MPFProgramExists As Boolean = (WaitForElement(1, By.XPath(partialMenuXpath & "MPF Program']")) IsNot Nothing)
            Dim administrationExists As Boolean = (WaitForElement(1, By.XPath(partialMenuXpath & "Administration']")) IsNot Nothing)

            ' Set up the integer value for the correct "id" (mmlink_) of the anchor that gets modified by the javascript menu app.
            Select Case menuItemStr
                Case "Cash Management"
                    dynamicAnchorId = "0"
                Case "Collateral"
                    dynamicAnchorId = "1"
                Case "Liquidity and Funding"
                    dynamicAnchorId = "2"
                Case "Safekeeping"
                    dynamicAnchorId = "3"
                Case "Affordable Housing"
                    If affordableHousingExists Then
                        dynamicAnchorId = "4"
                    Else
                        dynamicAnchorId = ""
                    End If
                Case "MPF Program"
                    If MPFProgramExists Then
                        If affordableHousingExists Then
                            dynamicAnchorId = "5"
                        Else
                            dynamicAnchorId = "4"
                        End If
                    Else
                        dynamicAnchorId = ""
                    End If
                Case "Administration"
                    If administrationExists Then
                        If affordableHousingExists AndAlso MPFProgramExists Then
                            dynamicAnchorId = "6"
                            Exit Select
                        End If
                        If (affordableHousingExists AndAlso Not MPFProgramExists) OrElse (Not affordableHousingExists AndAlso MPFProgramExists) Then
                            dynamicAnchorId = "5"
                            Exit Select
                        End If
                        If (Not affordableHousingExists AndAlso Not MPFProgramExists) Then
                            dynamicAnchorId = "4"
                        End If
                    Else
                        dynamicAnchorId = ""
                    End If
                Case Else ' Not a valid header title.
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Action failed. The data profile's 'Menu' value '" & menuItemStr & "' is not a valid menu item."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    Return returnValues
            End Select

            ' Find the header item in the menu and put the mouse cursor on it.
            Dim action As Actions = New Actions(driver)
            menuItem = driver.FindElement(By.XPath(partialMenuXpath & menuItemStr & "']"))
            action.MoveToElement(menuItem, 5, 0).Build().Perform()

            ' Find the anchor that gets dynamically modified by the javescript menu app.
            Dim dynamicLink As IWebElement = WaitForElement(waitForLink, By.XPath("//a[@id='mmlink" & dynamicAnchorId & "']"))
            If dynamicLink Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not locate the menu's dynamically modified anchor 'mmlink" & dynamicAnchorId & "'."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If

            'Drag the mouse cursor down the menu, counting the changes in the dynamic anchor's href value.
            previousHref = dynamicLink.GetAttribute("href")
            Dim stepCount As Integer = 0
            While stepCount < maxStepCount AndAlso menuPos <> subMenuItemNumb
                stepCount += offset
                action.MoveByOffset(0, offset).Build().Perform()
                System.Threading.Thread.Sleep(10)
                dynamicHref = dynamicLink.GetAttribute("href")
                If dynamicHref <> previousHref Then
                    menuPos += 1
                    previousHref = dynamicHref
                End If
            End While
            If stepCount >= maxStepCount Then ' We're out of the bottom of the drop down menu and never going to find our menu item.
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not locate the specified " & targetPageName & _
                    "' menu item in drop down position " & subMenuItemNumb.ToString() & "."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If

            ' The cursor has reached the designated item, so click it.
            action.Click().Build().Perform()

            ' Confirm that we've navigated to the correct page.
            'Dim success As Boolean = (WaitForElement(waitForTargetPage, By.XPath("//*[contains(text(), '" & targetPageName & "')]")) IsNot Nothing)
            ' A more "stringent" check we could use would be (only accepts finding the page name in a span or h1).
            Dim success As Boolean = (WaitForElement(waitForTargetPage, By.XPath("//span[contains(text(), '" & targetPageName & "')] | //h1[contains(text(), '" & _
                                                                                 targetPageName & "')]")) IsNot Nothing)
            returnValues(1) = CStr(IIf(success, "Correctly navigated", "Did not successfully navigate")) & " to the '" & targetPageName & "' module."
            If Not success Then
                returnValues(0) = executionStatusFailedAbort
                CaptureScreenshot(actionHistoryRecordID)
            End If
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Nav_Menu_Generic(ByVal mcpParameters() As Object, ByVal sTopLevelMenuID As String, ByVal sSubMenuText As String) As Object

        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        returnValues(0) = executionStatusFailedAbort
        returnValues(1) = "Cannot find sub menu item. There is a problem with the data profile: 'SubmenuPosition' is not an integer value."



        'debug
        'sTopLevelMenuID = "menuForm:applicationMenu" menuForm:applicationMenu


        Dim hover As IWebElement
        hover = driver.FindElement(By.Id(sTopLevelMenuID))

        Dim x As Integer = hover.Location.X
        Dim y As Integer = hover.Location.Y



        Dim actions As New Actions(Me.driver)
        Dim hovering As IAction = actions.MoveToElement(hover).Build()


        hovering.Perform()


        Dim menuItems As IList(Of IWebElement) = driver.FindElements(By.ClassName("rich-menu-item-label"))

        Dim elementToClickID As String = String.Empty
        Dim elementToClick As IWebElement = Nothing


        Dim element1 As IWebElement
        element1 = menuItems(1)

        'debug
        'sSubMenuText = "Initiate Application"

        For Each element As IWebElement In menuItems

            If element.Text = sSubMenuText Then
                elementToClickID = element.GetAttribute("ID")
                elementToClick = driver.FindElement(By.Id(elementToClickID))
                elementToClick.Click()
                Exit For
            End If


        Next



        Return returnValues


    End Function
    Public Function Verify_As_Of_Date_on_Current_Page(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim validationAsOfDateStr As String
            Dim pageAsOfDateStr As String
            Dim currentAsOfElement As IWebElement
            Dim dateElement As IWebElement
            Dim currentAsOfElementStr As String

            ' Get the date for validation from the data profile.
            validationAsOfDateStr = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "Automation_current_as_of_date").Trim()

            ' Get the element on the page that contains, "Current as of".
            currentAsOfElement = WaitForElement(1, By.XPath("//*[contains(text(), 'Current as of')]"))

            ' Check to see if this element contains the entire string, including the date.
            currentAsOfElementStr = currentAsOfElement.Text.Trim()
            If currentAsOfElementStr.Length > 13 Then ' The date is included in the initially obtained element. So strip off the leading text and leave the date.
                pageAsOfDateStr = currentAsOfElementStr.Substring(13).Trim()
            Else ' The date is in the adjacent element on the chosen page. So get it and pick the date out of it.
                dateElement = WaitForElement(1, _
                    By.XPath("//*[contains(text(), 'Current as of')]/following-sibling::span | //*[contains(text(), 'Current as of')]/following-sibling::label"))
                pageAsOfDateStr = dateElement.Text.Trim()
            End If

            ' Compare the values.
            If pageAsOfDateStr = validationAsOfDateStr Then
                returnValues(1) = "The 'as of' date on the page (" & pageAsOfDateStr & ") is correct."
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR: The 'as of' date on the page (" & pageAsOfDateStr & ") does not match the value in the data profile (" & _
                    validationAsOfDateStr & ")."
                CaptureScreenshot(actionHistoryRecordID)
            End If
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function CMgt_Click_Account_to_Access_Acct_Detail(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim accountNumberStr As String
            Dim columnHeadingStr As String
            Const partialXPathForDetailPage As String = "//div[2]/div/div[2]/form/table/tbody/tr/td[1]/span[text()='"
            Const waitForAccntLink As Integer = 5
            Const waitForDetailPage As Integer = 15

            ' Get the header & account number to select.
            ' Get the account number to select.
            accountNumberStr = mosaicDll.dt(excelPath, iteration, "acc_account", "Account_Nbr").Trim()
            columnHeadingStr = mosaicDll.dt(excelPath, iteration, "acc_account", "CMgtH_Heading").Trim()

            ' If the specified column heading isn't "Available Balance," somebody picked the wrong data profile. So, just give up.
            If columnHeadingStr.ToLower() <> "available balance" Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "ERROR: Value specified for 'CMgtH_Heading' field in the data profile is not the supported value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If

            ' Check the account number for validity.
            If Not IsNumeric(accountNumberStr) OrElse accountNumberStr.Length > 5 OrElse accountNumberStr.Length < 1 Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "ERROR: There is a problem with the data profile: 'Account_Nbr' is not a reasonable value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If

            ' Fix the account number string to ensure there are leading zeros if needed.
            accountNumberStr = PadWithLeadingZeros(accountNumberStr, 5)

            ' Find the account number on the page.
            Dim linkToClick As IWebElement = WaitForElement(waitForAccntLink, _
                By.XPath("//div[2]/div/div[2]/div[1]/form/div[3]/div/table/tbody/tr/td[1]/a[text()='" & accountNumberStr & "']"))
            If linkToClick Is Nothing Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "ERROR: Unable to find account number '" & accountNumberStr & "' in the list of accounts."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Return returnValues
            End If

            'Click the account number.
            linkToClick.Click()

            ' Are we at the detail page?
            If WaitForElement(waitForDetailPage, By.XPath(partialXPathForDetailPage & "Account Detail']")) Is Nothing _
              OrElse WaitForElement(1, By.XPath(partialXPathForDetailPage & accountNumberStr & "']")) Is Nothing Then ' We didn't get to the correct detail page.
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "ERROR: Unable to obtain the detail page for account number '" & accountNumberStr & _
                    "' within " & waitForDetailPage.ToString() & " seconds."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            Else ' It worked.
                returnValues(1) = "Navigated to the detail page for account number '" & accountNumberStr & "'."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            End If
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function CMgt_Verify_Summary_Cash_Balances_on_Home_Page(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Const waitForValue As Integer = 1

            ' Open the DB.
            Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            Select Case OpenSqlDB(dbServer)
                Case dbError
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Unable to open '" & dbServer & "' database."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
                Case dbChanged
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Data profile specifies a changed database URL."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            End Select
            If CInt(returnValues(0)) <> executionStatusPassed Then
                Exit Try
            End If

            ' Fetch the validation values from the database.
            Dim sqlStmt As String = _
                "Select [BALANCE_TOTAL] ,[BALANCE_RESTRICTED] ,[BALANCE_UNRESTRICTED] FROM [eBanking].[dbo].[cV_CUSTOMER_SUMMARY_CM] WHERE CUSTOMER_NUMBER = '" & _
                PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5) & "' AND AS_OF_DATE = '" & _
                mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "Current_as_of_date_yyyy_mm_dd").Trim() & " 00:00:00.0'"
            Dim BalanceCurrentStr As String = Nothing
            Dim BalanceRestrictedStr As String = Nothing
            Dim BalanceAvailableStr As String = Nothing
            Try
                Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
                Dim reader As SqlDataReader = sqlCmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim val As Object
                    For i As Integer = 0 To 2
                        val = reader.GetValue(i)
                        Select Case i
                            Case 0
                                BalanceCurrentStr = CStr(IIf(IsDBNull(val), nulFlg, val))        ' Field defined as nullable in DB.
                            Case 1
                                BalanceRestrictedStr = CStr(IIf(IsDBNull(val), nulFlg, val))     ' Field defined as nullable in DB.
                            Case 2
                                BalanceAvailableStr = CStr(IIf(IsDBNull(val), nulFlg, val))      ' Field defined as nullable in DB.
                        End Select
                    Next
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Validation values query returned no record."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                    Exit Function
                End If
                reader.Close()
            Catch ex As Exception
                returnValues(0) = executionStatusFailed
                returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End Try

            ' Get the validation values from the strings into numeric variables.
            Dim valdteBalanceCurrent As Decimal
            Dim valdteBalanceRestricted As Decimal
            Dim valdteBalanceAvailable As Decimal
            If IsNumeric(BalanceCurrentStr) Then
                valdteBalanceCurrent = Decimal.Round(CDec(BalanceCurrentStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert the balance current value ('" & BalanceCurrentStr & "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert balance current value ('" & BalanceCurrentStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If IsNumeric(BalanceRestrictedStr) Then
                valdteBalanceRestricted = Decimal.Round(CDec(BalanceRestrictedStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & "Unable to convert the balance restricted value ('" & BalanceRestrictedStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert balance restricted value ('" & BalanceRestrictedStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If IsNumeric(BalanceAvailableStr) Then
                valdteBalanceAvailable = Decimal.Round(CDec(BalanceAvailableStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & "Unable to convert the balance available value ('" & BalanceAvailableStr & _
                    "') from the database to a numeric value for use in validation."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to convert balance available value ('" & BalanceAvailableStr & "') to a numeric value.", _
                                 myLogPath, , actionHistoryRecordID)
            End If
            If CInt(returnValues(0)) = executionStatusFailed Then
                Exit Function
            End If

            ' Get the corresponding values from the Web page.
            ' Find a span that contains, "Restricted Balance," trace back up to the form element it's in and proceed down to the 3 spans with the values. 
            Const partialXpath As String = "//span[text()='Restricted Balance']/ancestor::form/div[2]/table/tbody/tr[2]/td["
            Dim balanceCurrentValue As IWebElement
            Dim balanceRestrictedValue As IWebElement
            Dim balanceAvailableValue As IWebElement
            balanceCurrentValue = WaitForElement(waitForValue, By.XPath(partialXpath & "1]/label/span"))
            If balanceCurrentValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate balance current value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageBalanceCurrentValueStr As String = balanceCurrentValue.Text
            balanceRestrictedValue = WaitForElement(waitForValue, By.XPath(partialXpath & "2]/label/span"))
            If balanceRestrictedValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate balance restricted value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageBalanceRestrictedValueStr As String = balanceRestrictedValue.Text
            balanceAvailableValue = WaitForElement(waitForValue, By.XPath(partialXpath & "3]/label/span"))
            If balanceAvailableValue Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Couldn't locate balance available value on page."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageBalanceAvailableValueStr As String = balanceAvailableValue.Text

            'Remove the dollar sign and commas from the page's values.
            Dim modifiedPageBalanceCurrentValueStr As String = CleanMonetaryString(pageBalanceCurrentValueStr)
            Dim modifiedPageBalanceRestrictedValueStr As String = CleanMonetaryString(pageBalanceRestrictedValueStr)
            Dim modifiedPageBalanceAvailableValueStr As String = CleanMonetaryString(pageBalanceAvailableValueStr)

            ' Convert the page's string values to decimal values.
            Dim pageBalanceCurrent As Decimal
            If IsNumeric(modifiedPageBalanceCurrentValueStr) Then
                pageBalanceCurrent = Decimal.Round(CDec(modifiedPageBalanceCurrentValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert balance current value '" & pageBalanceCurrentValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageBalanceRestricted As Decimal
            If IsNumeric(modifiedPageBalanceRestrictedValueStr) Then
                pageBalanceRestricted = Decimal.Round(CDec(modifiedPageBalanceRestrictedValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert balance restricted value '" & pageBalanceRestrictedValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            Dim pageBalanceAvailable As Decimal
            If IsNumeric(modifiedPageBalanceAvailableValueStr) Then
                pageBalanceAvailable = Decimal.Round(CDec(modifiedPageBalanceAvailableValueStr), 2)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Unable to convert balance available value '" & pageBalanceAvailableValueStr & "' to a numeric value."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If

            'Validate page values.
            Dim balanceCurrentsMatch As Boolean = (pageBalanceCurrent = valdteBalanceCurrent)
            Dim balanceRestrictedsMatch As Boolean = (pageBalanceRestricted = valdteBalanceRestricted)
            Dim balanceAvailablesMatch As Boolean = (pageBalanceAvailable = valdteBalanceAvailable)
            If balanceCurrentsMatch AndAlso balanceRestrictedsMatch AndAlso balanceAvailablesMatch Then
                returnValues(1) = "All 3 cash management home page summary cash amounts are correct."
                mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
                Exit Function
            End If
            returnValues(0) = executionStatusFailed ' Past here, there's certainly a problem.
            Dim errorStr As String = ""
            If Not balanceCurrentsMatch Then
                errorStr = "Balance current value - Expected:" & valdteBalanceCurrent.ToString() & _
                    " Page:" & modifiedPageBalanceCurrentValueStr & "|"
            End If
            If Not balanceRestrictedsMatch Then
                errorStr = errorStr & "Balance restricted value - Expected:" & valdteBalanceRestricted.ToString() & _
                    " Page:" & modifiedPageBalanceRestrictedValueStr & "|"
            End If
            If Not balanceAvailablesMatch Then
                errorStr = errorStr & "Balance available value - Expected:" & valdteBalanceAvailable.ToString() & _
                    " Page:" & modifiedPageBalanceAvailableValueStr & "|"
            End If
            returnValues(1) = errorStr.TrimEnd("|".ToCharArray())
            mosaicDll.Logger(senderMCPAction, "Actual Result|" & returnValues(1).ToString(), myLogPath, , actionHistoryRecordID)
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            CMgt_Verify_Summary_Cash_Balances_on_Home_Page = returnValues
        End Try
    End Function
    ' Used by the Cmgt_Verify_Avail_Balance_For_Accounts_on_Home_Page() function directly below.
    Private Class AccountRecord
        Private myAccountNumberStr As Object
        Private myBeginningBalanceStr As Object
        Private myCreditsStr As Object
        Private myCreditsAmountStr As Object
        Private myDebitsStr As Object
        Private myDebitsAmountStr As Object
        Private myCurrentBalanceStr As Object

        Property AccountNumber As Object
            Get
                Return myAccountNumberStr
            End Get
            Set(value As Object)
                myAccountNumberStr = value
            End Set
        End Property
        Property BeginningBalance As Object
            Get
                Return myBeginningBalanceStr
            End Get
            Set(value As Object)
                myBeginningBalanceStr = value
            End Set
        End Property
        Property Credits As Object
            Get
                Return myCreditsStr
            End Get
            Set(value As Object)
                myCreditsStr = value
            End Set
        End Property
        Property CreditsAmount As Object
            Get
                Return myCreditsAmountStr
            End Get
            Set(value As Object)
                myCreditsAmountStr = value
            End Set
        End Property
        Property Debits As Object
            Get
                Return myDebitsStr
            End Get
            Set(value As Object)
                myDebitsStr = value
            End Set
        End Property
        Property DebitsAmount As Object
            Get
                Return myDebitsAmountStr
            End Get
            Set(value As Object)
                myDebitsAmountStr = value
            End Set
        End Property
        Property CurrentBalance As Object
            Get
                Return myCurrentBalanceStr
            End Get
            Set(value As Object)
                myCurrentBalanceStr = value
            End Set
        End Property
    End Class
    Public Function Cmgt_Verify_Avail_Balance_For_Accounts_on_Home_Page(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            'Dim i As Integer
            'Dim dbAccountRecords As New ArrayList       ' Holds the validation values from then DB as Objects.
            'Dim pageAccountRecords As New ArrayList     ' Holds the page values as Objects.
            'Dim tempStr As String = Nothing
            'Dim tempValue As Object = Nothing
            'Dim conversionError As Boolean
            'Dim errorField As String = ""
            'Dim errorList As New StringBuilder
            'Const waitForValue As Integer = 1

            '' Open the DB.
            'Dim dbServer As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "SQL_DB_Server").Trim()
            'Select Case OpenSqlDB(dbServer)
            '    Case dbError
            '        returnValues(0) = executionStatusFailed
            '        returnValues(1) = "Unable to open '" & dbServer & "' database."
            '        mosaicDll.Logger(senderMCPAction, "Actual Result|Unable to open '" & dbServer & "' database.", myLogPath, , actionHistoryRecordID)
            '    Case dbChanged
            '        returnValues(0) = executionStatusFailed
            '        returnValues(1) = "Data profile specifies a changed database URL."
            '        mosaicDll.Logger(senderMCPAction, "Actual Result|Data profile specifies a changed database URL.", myLogPath, , actionHistoryRecordID)
            'End Select
            'If CInt(returnValues(0)) <> executionStatusPassed Then
            '    Exit Try
            'End If

            ''Get the "as of" date and the customer number from DSTAR.
            'Dim dtAsOfDateStr As String = mosaicDll.dt(excelPath, iteration, "url_web_address_curr_as_of_date", "Current_as_of_date_yyyy_mm_dd").Trim()
            'Dim dtCustomerNumberStr As String = PadWithLeadingZeros(mosaicDll.dt(excelPath, iteration, "mbr_member_institution", "Member_ID"), 5)

            '' Fetch the validation values from the database.
            'Dim sqlStmt As String = _
            '    "SELECT [ACCOUNT_NUMBER], [BEGIN_BALANCE], [CREDIT_COUNT], [CREDIT_TOTAL], [DEBIT_COUNT], [DEBIT_TOTAL], [END_BALANCE] " & _
            '    "FROM [eBanking].[dbo].[cV_ACCOUNT_SUMMARY] " & _
            '    "WHERE AS_OF_DATE = '" & dtAsOfDateStr & " 00:00:00.0' " & _
            '    "AND CUSTOMER_NUMBER = '" & dtCustomerNumberStr & "'"
            'Try
            '    Dim sqlCmd As New SqlCommand(sqlStmt, sqlConn)
            '    Dim reader As SqlDataReader = sqlCmd.ExecuteReader()
            '    Dim val As Object
            '    If reader.HasRows Then
            '        While reader.Read()
            '            Dim record As New AccountRecord
            '            For i = 0 To 6
            '                val = reader.GetValue(i)
            '                Select Case i                                           ' All fields defined as nullable in DB.
            '                    Case 0
            '                        record.AccountNumber = CStr(IIf(IsDBNull(val), nulFlg, val))        ' String of 5 digits
            '                    Case 1
            '                        record.BeginningBalance = CStr(IIf(IsDBNull(val), nulFlg, val))     ' Monetary amount
            '                    Case 2
            '                        record.Credits = CStr(IIf(IsDBNull(val), nulFlg, val))              ' Integer
            '                    Case 3
            '                        record.CreditsAmount = CStr(IIf(IsDBNull(val), nulFlg, val))        ' Monetary amount
            '                    Case 4
            '                        record.Debits = CStr(IIf(IsDBNull(val), nulFlg, val))               ' Integer
            '                    Case 5
            '                        record.DebitsAmount = CStr(IIf(IsDBNull(val), nulFlg, val))         ' Monetary amount
            '                    Case 6
            '                        record.CurrentBalance = CStr(IIf(IsDBNull(val), nulFlg, val))       ' Monetary amount
            '                End Select
            '            Next
            '            dbAccountRecords.Add(record)
            '        End While
            '    Else
            '        returnValues(0) = executionStatusFailed
            '        returnValues(1) = "Validation values query returned no record."
            '        mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            '        Exit Function
            '    End If
            '    reader.Close()
            'Catch ex As Exception
            '    returnValues(0) = executionStatusFailed
            '    returnValues(1) = "ERROR|Exception while fetching values from the DB: " & ex.Message
            '    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            '    Exit Function
            'End Try

            '' Get the validation values from the strings into the correct data types.
            'errorList.Length = 0                                    ' Clear the StringBuilder.
            'For Each record As AccountRecord In dbAccountRecords
            '    conversionError = False
            '    For i = 1 To 6
            '        ' Get a record field from the record object...
            '        Select Case i
            '            Case 1
            '                tempStr = CStr(record.BeginningBalance)
            '                errorField = "Beginning Balance"
            '            Case 2
            '                tempStr = CStr(record.Credits)
            '                errorField = "Credits"
            '            Case 3
            '                tempStr = CStr(record.CreditsAmount)
            '                errorField = "Credits Amount"
            '            Case 4
            '                tempStr = CStr(record.Debits)
            '                errorField = "Debits"
            '            Case 5
            '                tempStr = CStr(record.DebitsAmount)
            '                errorField = "Debits Amount"
            '            Case 6
            '                tempStr = CStr(record.CurrentBalance)
            '                errorField = "Current Balance"
            '        End Select

            '        ' ...convert the record field to the apropos data type...
            '        If tempStr = nulFlg Then
            '            tempValue = Nothing
            '        ElseIf IsNumeric(tempStr) Then
            '            Select Case i
            '                Case 2, 4                       ' The value should be an integer.
            '                    tempValue = CUInt(tempStr)
            '                Case 1, 3, 5, 6                 ' The value should be a monetary amount.
            '                    tempValue = Decimal.Round(CDec(tempStr), 2)
            '            End Select
            '        Else
            '            conversionError = True
            '        End If
            '        If conversionError Then             ' Add the problem account number, field name & its contents to the error message.
            '            errorList.Append(CStr(record.AccountNumber) & "/" & errorField & ":'" & tempStr & "'|")
            '        End If

            '        ' ...& put the result back into the record object. Item 0 ("Account Number") was, and remains, a string.
            '        Select Case i
            '            Case 1
            '                record.BeginningBalance = tempValue
            '            Case 2
            '                record.Credits = tempValue
            '            Case 3
            '                record.CreditsAmount = tempValue
            '            Case 4
            '                record.Debits = tempValue
            '            Case 5
            '                record.DebitsAmount = tempValue
            '            Case 6
            '                record.CurrentBalance = tempValue
            '        End Select
            '    Next
            'Next
            'If errorList.Length > 0 Then                    ' There were errors during the type conversion process.
            '    errorList.Length = errorList.Length - 1     ' Get rid of the final "|" character.
            '    returnValues(0) = executionStatusFailed
            '    returnValues(1) = "The following validation values (Accnt#/field:value) from the DB cannot be used... " & errorList.ToString()
            '    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            '    Exit Function
            'End If

            '' At this point, we've got the values from the DB needed for validation in apropos data types stored in the
            '' records of the accountRecords list as Objects (to allow for "Nothing" to represent null values from the DB).
            '' So, it's time to get the corresponding values from the Web page.

            'Dim accountNumberStr As String
            'Const xPath1 As String = "//table[@id='cmSummary']/tbody/*/*/a[contains(text(), '"
            'Const xPath2 As String = "')]/ancestor::tr/td["
            'Const xPath3Int As String = "]"
            'Const xPath3Dec As String = "]/span"
            'Dim xPath As New StringBuilder
            'Dim element As IWebElement
            'errorList.Length = 0                                ' Clear the StringBuilder that stores the errors.
            'For Each record As AccountRecord In dbAccountRecords
            '    Dim pageRecord As New AccountRecord
            '    accountNumberStr = CStr(record.AccountNumber)
            '    pageRecord.AccountNumber = accountNumberStr
            '    For i = 2 To 7
            '        Select Case i
            '            Case 2
            '                errorField = "Beginning Balance"
            '            Case 3
            '                errorField = "Credits"
            '            Case 4
            '                errorField = "Credits Amount"
            '            Case 5
            '                errorField = "Debits"
            '            Case 6
            '                errorField = "Debits Amount"
            '            Case 7
            '                errorField = "Current Balance"
            '        End Select

            '        ' Construct an XPath to get the table row's cells.
            '        xPath.Length = 0                            ' Clear the StringBuilder
            '        xPath.Append(xPath1)
            '        xPath.Append(accountNumberStr)              ' The account number in the td[1] column.
            '        xPath.Append(xPath2)
            '        xPath.Append(i.ToString())                  ' The column index in the row.
            '        Select Case i
            '            Case 3, 5                               ' The value should be an integer in a td.
            '                xPath.Append(xPath3Int)
            '            Case 2, 4, 6, 7                         ' The value should be a monetary amount in a span inside a td.
            '                xPath.Append(xPath3Dec)
            '        End Select

            '        ' With the constructed XPath, get a value from the page's table row.
            '        ' (*** This section needs to be modified to handle null values based on what gets composed    ***)
            '        ' (*** into the HTML when the DB contains a null value. Empty element? Missing element? What? ***)
            '        element = WaitForElement(waitForValue, By.XPath(xPath.ToString()))
            '        If element IsNot Nothing Then   ' Got a value from the page.
            '            tempStr = CleanMonetaryString(element.Text)
            '        Else                            ' Didn't locate a value.

            '            ' (*** Is this an error, or expected if the DB value is null? ***)
            '            ' (*** If it's an error... ***)
            '            errorList.Append(accountNumberStr & ":'" & errorField & "'|")

            '            ' (*** If it's expected when there's no value in the DB... ***)
            '            tempStr = nulFlg
            '        End If

            '        ' Convert the page value into a numeric value in an Object.
            '        If tempStr = nulFlg Then
            '            tempValue = Nothing
            '        ElseIf IsNumeric(tempStr) Then
            '            Select Case i
            '                Case 3, 5
            '                    tempValue = CUInt(tempStr)
            '                Case 2, 4, 6, 7
            '                    tempValue = Decimal.Round(CDec(tempStr))
            '            End Select
            '        Else
            '        End If

            '        ' Put the newly acquired page value into a page value record.
            '        Select Case i
            '            Case 2
            '                pageRecord.BeginningBalance = tempValue
            '            Case 3
            '                pageRecord.Credits = tempValue
            '            Case 4
            '                pageRecord.CreditsAmount = tempValue
            '            Case 5
            '                pageRecord.Debits = tempValue
            '            Case 6
            '                pageRecord.DebitsAmount = tempValue
            '            Case 7
            '                pageRecord.CurrentBalance = tempValue
            '        End Select
            '    Next

            '    ' Add the record containing the account info from one line on the Web page into the "page account records" list.
            '    pageAccountRecords.Add(pageRecord)
            'Next
            'If errorList.Length > 0 Then                    ' There were errors during the process of obtaining page values.
            '    errorList.Length = errorList.Length - 1     ' Get rid of the final "|" character.
            '    returnValues(0) = executionStatusFailed
            '    returnValues(1) = "Errors occurred while obtaining the following fields (Accnt#:field) from the page... " & _
            '        errorList.ToString()
            '    mosaicDll.Logger(senderMCPAction, "Actual Result|" & CStr(returnValues(1)), myLogPath, , actionHistoryRecordID)
            '    Exit Function
            'End If


            ' (*** Needs work here ***)
            ' - Need to check to confirm that there aren't any extra "account" lines on the page that don't correspond to a fetched DB record.
            ' - Need to obtain the "Totals" values from the bottom row of the table on the page.
            ' - Need to create a set of corrresponding total values from the values obtained from the DB.
            ' - Compare the values from the dbAccountRecords records with their corresponding values in the pageAccountRecords records.
            ' - Compare the "totals" values from the page with the totals calculated from the DB values.
            ' - Crete the code that reports any errors during the validations steps.

            ' ( **** Remove the next 2 lines once the test action function is ready for testing. ****)
            returnValues(1) = "(* Dummy action *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|Dummy action", myLogPath, , actionHistoryRecordID)
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Cmgt_Verify_Avail_Balance_For_Accounts_on_Home_Page = returnValues
        End Try
    End Function
    Public Function InitApp_1_Initiate_New_App_Enter_Application_Information_Lookup_Zip_Click_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)

        'Const waitForLogInPage As Integer = 1
        'Const waitForHomePage As Integer = 60
        Const waitForAnyPage As Integer = 20

        Try

            ''''''''''''''''''''
            ' Do something here.
            ''''''''''''''''''''
            '[driver.Manage().Window().Maximize()

            'If iteration = 3 Then
            '    Stop
            'End If
            'Step 1 Select Menu Item
            Dim objMenuResults As New Object()

            objMenuResults = Nav_Menu_Generic(mcpParameters, "menuForm:applicationMenu", "Initiate Application")

            'Dim var As Object = driver.FindElement(By.XPath("//title"))

            'Step 2 
            'get record for testing
            Dim sProjectType As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Type")


            Dim bIsProjectType As Boolean = False


            Dim sProjectName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Name")

            Dim sActivityType As New List(Of String)
            Dim sCheckStringValue As String = String.Empty



            'Step 3
            'text box Population

            Dim sLocatorTypeID As IEnumerable = From P In dt.AsEnumerable Where P.Field(Of String)("sName") = "ProjectName" Select P.Field(Of String)("sID")
            Dim sLocatorTypeXPath As IEnumerable = From P In dt.AsEnumerable Where P.Field(Of String)("sName") = "ProjectName" Select P.Field(Of String)("sXPath")
            Dim currentElement As IWebElement = Nothing

            'Get the project name element by id or xpath
            If WaitForElement(waitForAnyPage, By.Id(sLocatorTypeID(0).ToString())) Is Nothing Then
                If WaitForElement(waitForAnyPage, By.XPath(sLocatorTypeXPath(0).ToString())) Is Nothing Then
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = CStr(returnValues(1)) & "Could not locate the html element " & sLocatorTypeID(0).ToString() & "by xpath or id in" & waitForAnyPage & " seconds."
                    mosaicDll.Logger(senderMCPAction, CStr(returnValues(1)) & "  " & "Could not locate the html element " & sLocatorTypeID(0).ToString() & "by xpath or id in" & waitForAnyPage & " seconds.", _
                                     myLogPath, , actionHistoryRecordID)

                    CaptureScreenshot(actionHistoryRecordID)
                Else
                    currentElement = driver.FindElement(By.XPath(sLocatorTypeXPath(0).ToString()))
                End If
            Else

                currentElement = driver.FindElement(By.Id(sLocatorTypeID(0).ToString()))
            End If
            currentElement.SendKeys(Keys.Control + "a")
            currentElement.SendKeys(sProjectName)

            'Get the project type and populate
            Dim sLocatorTypeID1 As IEnumerable = From P In dt.AsEnumerable Where P.Field(Of String)("sName") = "ProjectType" Select P.Field(Of String)("sID")
            Dim sLocatorTypeXPath1 As IEnumerable = From P In dt.AsEnumerable Where P.Field(Of String)("sName") = "ProjectType" Select P.Field(Of String)("sXPath")
            Dim currentElement1 As IWebElement = Nothing

            'Drop Down Population


            Dim element As IWebElement = driver.FindElement(By.XPath("//Select"))
            Dim AllDropDownList As IList(Of IWebElement) = element.FindElements(By.XPath("//option"))
            Dim DpListCount As Integer = AllDropDownList.Count

            '
            'debug
            'sProjectType = "Home Ownership"
            If sProjectType = "Rental" Or sProjectType = "Lease-Purchase" Then

                For i As Integer = 0 To DpListCount - 1
                    If AllDropDownList(i).Text = sProjectType Then
                        AllDropDownList(i).Click()
                    End If
                Next

                sCheckStringValue = String.Empty
                sCheckStringValue = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type1")
                If Not sCheckStringValue = String.Empty Then
                    sActivityType.Add(sCheckStringValue)
                End If
                sCheckStringValue = String.Empty
                sCheckStringValue = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type2")
                If Not sCheckStringValue = String.Empty Then
                    sActivityType.Add(sCheckStringValue)
                End If
                sCheckStringValue = String.Empty
                sCheckStringValue = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type3")
                If Not sCheckStringValue = String.Empty Then
                    sActivityType.Add(sCheckStringValue)
                End If




                For Each item As String In sActivityType

                    Select Case Trim(item)
                        Case "Acquisition"
                            driver.FindElement(By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[1]/td/label")).Click()

                        Case "New Construction"
                            driver.FindElement(By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[2]/td/label")).Click()

                        Case "Rehabilitation"

                            driver.FindElement(By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[3]/td/label")).Click()

                    End Select


                Next




            ElseIf sProjectType = "Home Ownership" Then
                'Project Type must be Home Ownership
                Dim AllDropDownList1 As IList(Of IWebElement)
                Dim DpListCount1 As Integer

                'Set the project type to Home Ownership
                Dim pTypeElement As IWebElement = driver.FindElement(By.XPath("//select"))
                AllDropDownList1 = pTypeElement.FindElements(By.XPath("//option"))
                DpListCount1 = AllDropDownList1.Count


                For i As Integer = 0 To DpListCount - 1
                    If AllDropDownList1(i).Text = "Home Ownership" Then
                        AllDropDownList1(i).Click()
                    End If
                Next








                Dim dTypeElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//Select")) 'find all select elements
                Dim dTypeElement As IWebElement = Nothing

                'look thru elements until we find the on whose text is 
                For x As Integer = 0 To dTypeElements.Count - 1
                    If dTypeElements(x).Text.ToString() = "Rental Home Ownership Lease-Purchase" Then
                        dTypeElement = dTypeElements(x)
                    End If

                Next

                If Not dTypeElement Is Nothing Then
                    'element found click it this is a drop down
                    dTypeElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the drop down to select Project Type ", myLogPath, , actionHistoryRecordID)
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not click the drop down to select Project Type", myLogPath, , actionHistoryRecordID)
                End If


                'get all the options and search the drop down for the value
                AllDropDownList1 = dTypeElement.FindElements(By.XPath("//option"))
                DpListCount1 = AllDropDownList1.Count

                'found value now click it
                '---------- Debug Only ---------------------------
                ' Dim sDriverType As String = "Consumer Driven"
                Dim sDriverType As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "driver_type")
                '-------------------------------------------------

                'debug
                'Dim sDriverType As String = String.Empty
                'debug

                Dim bIsFound As Boolean = False

                For i As Integer = 0 To DpListCount1 - 1
                    ' Debug.Print(AllDropDownList1(i).Text.ToString())
                    If AllDropDownList1(i).Text.ToUpper.ToString() = sDriverType.ToUpper.ToString() Then
                        AllDropDownList1(i).Click()
                        bIsFound = True
                        Exit For
                    End If
                Next

                If Not bIsFound Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Driver type was not set for driver: " & sDriverType, myLogPath, , actionHistoryRecordID)
                    'CaptureScreenshot(actionHistoryRecordID)
                End If

                sCheckStringValue = String.Empty
                sCheckStringValue = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type1")
                If Not sCheckStringValue = String.Empty Then
                    sActivityType.Add(sCheckStringValue)
                End If
                sCheckStringValue = String.Empty
                sCheckStringValue = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type2")
                If Not sCheckStringValue = String.Empty Then
                    sActivityType.Add(sCheckStringValue)
                End If
                sCheckStringValue = String.Empty
                sCheckStringValue = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type3")
                If Not sCheckStringValue = String.Empty Then
                    sActivityType.Add(sCheckStringValue)
                End If


                Dim bIsDriverSet As Boolean = False

                If sDriverType.ToUpper.ToString() = "SPONSOR DRIVEN" Then
                    For Each item As String In sActivityType

                        Select Case Trim(item)
                            Case "Acquisition"
                                driver.FindElement(By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[1]/td/label")).Click()
                                bIsDriverSet = True
                            Case "New Construction"
                                driver.FindElement(By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[2]/td/label")).Click()
                                bIsDriverSet = True
                            Case "Rehabilitation"
                                driver.FindElement(By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[3]/td/label")).Click()
                                bIsDriverSet = True

                        End Select


                    Next
                    If Not bIsDriverSet Then
                        Dim strWhatHappened As String = "These activities were not found:"
                        For Each sValue As String In sActivityType
                            strWhatHappened = strWhatHappened & " " & sValue & " "
                        Next

                        mosaicDll.Logger(senderMCPAction, "Actual Result|Activity type(s) were not found. " & strWhatHappened, myLogPath, , actionHistoryRecordID)
                    Else
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Activities set for: " & sDriverType, myLogPath, , actionHistoryRecordID)
                    End If

                ElseIf sDriverType.ToUpper.ToString = "CONSUMER DRIVEN" Then
                    Dim driverTypeElement As IWebElement = Nothing
                    Dim oResult As Object = Nothing

                    For Each item As String In sActivityType

                        Select Case Trim(item)
                            Case "Acquisition (Down Payment Assistance)"
                                oResult = WaitForElement(driver, waitForAnyPage, (By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[1]/td/label")))
                                If Not oResult Is Nothing Then
                                    driverTypeElement = DirectCast(oResult, IWebElement)
                                    driverTypeElement.Click()
                                Else
                                    'get msg boss lady
                                End If
                            Case "Rehabilitation"
                                oResult = WaitForElement(driver, waitForAnyPage, (By.XPath("//table[@id='activityTypeForSelectedAppType']/tbody/tr[2]/td/label")))
                                If Not oResult Is Nothing Then
                                    driverTypeElement = DirectCast(oResult, IWebElement)
                                    driverTypeElement.Click()
                                Else
                                    'get msg boss lady
                                End If
                        End Select


                    Next
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Driver activities set for: " & sDriverType, myLogPath, , actionHistoryRecordID)
                End If


            End If

            'Type in the zip click lookup

            Dim strZip As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "zip")
            If Not strZip = String.Empty Then
                Dim zipElement As IWebElement = driver.FindElement(By.XPath("//input[@id='lookupZip']"))
                zipElement.SendKeys(Keys.Control + "a")
                zipElement.SendKeys(strZip)
            End If

            'find the lookup button
            Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//input"))


            For y As Integer = 1 To inputElements.Count - 1
                If inputElements(y).GetAttribute("value").ToUpper.ToString() = "LOOKUP" Then
                    Dim inputElement As IWebElement = inputElements(y)
                    inputElement.Click()
                    Exit For
                End If
            Next


            'Test the values returned from the zip code lookup
            Dim sCity As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "city")
            Dim sCounty As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "county")
            Dim sState As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "state")


            'find and compare the feilds
            Dim cityElement As IWebElement = driver.FindElement(By.XPath("//span[@id='city']"))
            Dim countyElement As IWebElement = driver.FindElement(By.XPath("//span[@id='county']"))
            Dim StateElement As IWebElement = driver.FindElement(By.XPath("//span[@id='state']"))

            Dim bZipLookupPass As Boolean = True
            Dim sZipErrors As String = String.Empty

            If sCity.ToUpper.ToString <> cityElement.Text.ToUpper.ToString Or sCounty.ToUpper.ToString <> countyElement.Text.ToUpper.ToString() Or sState.ToUpper.ToString() <> StateElement.Text.ToUpper.ToString() Then

                If sCity.ToUpper.ToString <> cityElement.Text.ToUpper.ToString Then
                    sZipErrors = sZipErrors & " Cities did not match: Template has: " & sCity.ToUpper.ToString & " App has: " & cityElement.Text.ToUpper.ToString & " "
                End If

                If sCounty.ToUpper.ToString <> countyElement.Text.ToUpper.ToString Then
                    sZipErrors = sZipErrors & " Counties did not match: Template has: " & sCounty.ToUpper.ToString & " App has: " & countyElement.Text.ToUpper.ToString & " "
                End If

                If sState.ToUpper.ToString <> StateElement.Text.ToUpper.ToString Then
                    sZipErrors = sZipErrors & " States did not match:  Template has: " & sState.ToUpper.ToString & " App has: " & StateElement.Text.ToUpper.ToString & " "
                End If
                bZipLookupPass = False
            End If



            If Not bZipLookupPass Then

                returnValues(0) = executionStatusFailed
                returnValues(1) = "Zip code validation failed. " & sZipErrors
                mosaicDll.Logger(senderMCPAction, "Actual Result|Zip code validation failed. " & sZipErrors, myLogPath, , actionHistoryRecordID)
                'mosaicDll.Logger(senderMCPAction, "Actual Result|sZipErrors: " & strZip, myLogPath, , actionHistoryRecordID)
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|Zip code validation passed: " & strZip, myLogPath, , actionHistoryRecordID)
            End If





            'find the next button
            Dim nextElement As IWebElement = WaitForElement(driver, waitForAnyPage, By.XPath("//input[@id='pageTemplateForm:nextButton']"))
            nextElement.Click()


            Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Error_Message")

            If sErrorMessage = String.Empty Then
                'if this empty then i expect next screen

                Dim elementOrgName As IWebElement = WaitForElement(driver, waitForAnyPage, By.XPath("//input[@id='pageTemplateForm:leadOrgsearchText']"))
                If elementOrgName Is Nothing Then
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Click next failed - Select lead contacts window did not display."
                    mosaicDll.Logger(senderMCPAction, "Click next failed - Select lead contacts window did not display.", myLogPath, , actionHistoryRecordID)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Click next failed - Select lead contacts window did not display.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If


            Else
                'I expect an error message
                Try
                    Dim iErrorElement As IWebElement
                    iErrorElement = WaitForElement(driver, waitForAnyPage, By.XPath("/html/body/div[3]/form/div[2]/span/table/tbody/tr/td/table/tbody/tr/td/ul/li"))
                    returnValues(0) = executionStatusPassed
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error message displayed.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                Catch ex As Exception
                    returnValues(0) = executionStatusFailed
                    'returnValues(1) = ""
                    'mosaicDll.Logger(senderMCPAction, "No error messages displayed", myLogPath, , actionHistoryRecordID)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|No error messages displayed.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End Try
            End If




        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            InitApp_1_Initiate_New_App_Enter_Application_Information_Lookup_Zip_Click_Next = returnValues
        End Try
    End Function
    Public Function GenApp_Search_for_Lead_Contact_Org(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        'Dim waitForTime As Integer = 10

        Try

            'driver.Manage().Window().Maximize()

            'get the organization search string
            Dim strOrg As String = mosaicDll.dt(excelPath, iteration, "srch_org_search_criteria", "search_string")

            'Locate the element name field
            Dim elementOrgName As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:leadOrgsearchText']"))

            'debug
            'strOrg = "test not found"

            'Type in the org name
            elementOrgName.SendKeys(Keys.Control + "a")
            elementOrgName.SendKeys(strOrg)

            'Find and click the search button
            Dim elementSearchButton As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/div/div/table/tbody/tr/td[3]/input"))
            elementSearchButton.Click()



            Dim sResultsExpected As String = mosaicDll.dt(excelPath, iteration, "srch_org_search_criteria", "results_expected?")


            If sResultsExpected.ToUpper.ToString = "YES" Then
                'search results are expected
                Dim oResultTable As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:leadOrgorgSerachDT']"))

                If Not oResultTable Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Search string returned results for: " & strOrg, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Actual Result|Search returned no results for : " & strOrg
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for: " & strOrg, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else
                'no search results are expected
                Dim oResultTable As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:leadOrgorgSerachDT']"))

                If Not oResultTable Is Nothing Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Actual Result|Results were returned but not expected for: " & strOrg
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Results were returned but not expected: " & strOrg, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                Else
                    returnValues(0) = executionStatusPassed
                    returnValues(1) = "Actual Result|Search returned no results for : " & strOrg
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for: " & strOrg, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If



        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            GenApp_Search_for_Lead_Contact_Org = returnValues
        End Try
    End Function
    Public Function InitApp_2_Aft_Srch_Sel_Org_and_Lead_Contact_Click_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        'Dim waitfortime As Integer = 5
        Try


            ' driver.Manage().Window().Maximize()

            Dim strleadContact As List(Of String) = New List(Of String)
            Dim strLeadOrgName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Lead_Orgn_Name")

            strleadContact.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Lead_Contact_1"))
            strleadContact.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Lead_Contact_2"))


            Dim counter As Integer = 0
            Dim prefixOptionXPath As String = "/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr["
            Dim suffixOptionPath As String = "]/td[1]/table/tbody/tr/td/label/input"


            'get the results table from the screen in the previous executable step
            Dim tableElement As IWebElement = driver.FindElement(By.XPath("//table[@id='pageTemplateForm:leadOrgorgSerachDT']"))
            Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr/td[2]"))


            Dim iLeadOrgFound As Integer = 0


            For Each row As IWebElement In rowCollection
                counter = counter + 1
                If row.Text.ToUpper.ToString() = strLeadOrgName.ToUpper.ToString() Then
                    'get the option element

                    Dim sOptionXPath As String = prefixOptionXPath & counter.ToString() & suffixOptionPath
                    Dim iOptionElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath(sOptionXPath))
                    iOptionElement.Click()
                    iLeadOrgFound = iLeadOrgFound + 1
                    Exit For

                End If
            Next
            If iLeadOrgFound = 0 Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not find the lead organization."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the lead organization." & strLeadOrgName.Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|Lead Organization has been set to " & strLeadOrgName.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
            End If


            'reseet variables
            tableElement = Nothing
            rowCollection = Nothing
            counter = 0

            ' inside of another table
            

            tableElement = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='center']/table/tbody/tr/td/table"))
            rowCollection = tableElement.FindElements(By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/table/tbody/tr[4]/td/span/span/table/tbody/tr"))



            'full path
            '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
            'changes to this wil result in not finding the proper element
            'this is how I find the option element to select once the text is located
            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/table/tbody/tr[4]/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]/div/table/tbody/tr/td/input"

            Dim iNumberFound As Integer = 0
            Dim iTotalContacts As Integer = strleadContact.Count
            Dim iTotalSearched As Integer = 0


            'Select the chosen lead contacts if they exist
            If Not strleadContact(0).Trim.ToUpper.ToString() = String.Empty Then
                Dim bContactFound1 As Boolean = False
                iTotalSearched = iTotalSearched + 1
                For Each row As IWebElement In rowCollection
                    counter = counter + 1
                    If row.Text.ToUpper.ToString() = strleadContact(0).Trim.ToUpper.ToString() Then
                        'get the option element
                        Dim sOptionXPath As String = prefixOptionXPath & counter.ToString() & suffixOptionPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        iOptionElement.Click()
                        iNumberFound = iNumberFound + 1 'add one because we located a lead contact
                        bContactFound1 = True
                        Exit For
                    End If
                Next
                If bContactFound1 Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Selected lead contact " & strleadContact(0).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                    bContactFound1 = True
                Else
                    If Not strleadContact(1).Trim.ToUpper.ToString() = String.Empty Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not find one or more lead contacts."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the lead contact " & strleadContact(0).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        ' ElseIf iTotalSearched = iTotalContacts Then
                    Else
                        returnValues(0) = executionStatusFailedAbort
                        returnValues(1) = returnValues(1) & " No lead contacts where found."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|No lead contacts where found." & strleadContact(0).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                End If
            End If


            'reseet variables
            tableElement = Nothing
            rowCollection = Nothing
            counter = 0


            'tricky table because it is inside of another table
            tableElement = driver.FindElement(By.XPath("//div[@id='center']/table/tbody/tr/td/table"))
            rowCollection = tableElement.FindElements(By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/table/tbody/tr[4]/td/span/span/table/tbody/tr"))


            'changes to this wil result in not finding the proper element
            'this is how I find the option element to select once the text is located
            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/table/tbody/tr[4]/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]/div/table/tbody/tr/td/input"



            'Select the chosen lead contacts if they exist
            If Not strleadContact(1).Trim.ToUpper.ToString() = String.Empty Then
                Dim bContactFound2 As Boolean = False
                iTotalSearched = iTotalSearched + 1
                For Each row As IWebElement In rowCollection
                    counter = counter + 1
                    If row.Text.ToUpper.ToString() = strleadContact(1).Trim.ToUpper.ToString() Then
                        'get the option element
                        Dim sOptionXPath As String = prefixOptionXPath & counter.ToString() & suffixOptionPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        iOptionElement.Click()
                        iNumberFound = iNumberFound + 1
                        bContactFound2 = True
                        Exit For
                    End If
                Next
                If bContactFound2 Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Selected lead contact " & strleadContact(1).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    If iNumberFound > 0 Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not find one or more lead contacts."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the lead contact " & strleadContact(1).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailedAbort
                        returnValues(1) = returnValues(1) & " No lead contacts where found."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|No lead contacts where found." & strleadContact(1).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
            End If



NextFunction:
            Dim nextElement As IWebElement = WaitForElement(driver, WaitForTime, (By.XPath("//input[@id='pageTemplateForm:nextButton']")))
            nextElement.Click()


            Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Error_Message")

            If Not sErrorMessage = String.Empty Then
                Dim oError As Object
                Dim iErrorElement As IWebElement = Nothing

                oError = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/span/table/tbody/tr/td/table/tbody/tr/td/ul/li"))
                If Not oError Is Nothing Then
                    'there is  error message
                    iErrorElement = DirectCast(oError, IWebElement)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Check the error message in the screen shot", myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    CaptureScreenshot(actionHistoryRecordID)
                Else

                    mosaicDll.Logger(senderMCPAction, "Actual Result|Click next successful.", myLogPath, , actionHistoryRecordID)
                End If
            End If



        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            InitApp_2_Aft_Srch_Sel_Org_and_Lead_Contact_Click_Next = returnValues
        End Try
    End Function
    Public Function Initapp_3_Srch_Sel_Org_and_Input_Contact_0_to_3_Click_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)

        Dim iFirstOrgFound As Integer = 0
        Dim iFirstContactFound As Integer = 0
        Dim TotalInputContacts As Integer = 0
        Dim iErrorCount As Integer = 0

        Try
            'Add check for correct page here
            'driver.Manage().Window().Maximize()

            'Specify the orgname and search
            Dim sOrgName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Input_1_Orgn_Name")

            If sOrgName = String.Empty Then
                ' returnValues(0) = executionStatusPassed
                returnValues(1) = "No organization one specified.  Skipped"
                mosaicDll.Logger(senderMCPAction, "Actual Result|No organization one specified.  Skipped", myLogPath, , actionHistoryRecordID)
                'CaptureScreenshot(actionHistoryRecordID)
                GoTo SecondSet
            End If


            'Get the first word in the string
            'Dim sFirstWordOrgName As String = FirstWord(sOrgName)
            Dim sFirstWordOrgName As String = sOrgName

            'Set the element to the the organization name field
            Dim sEObject As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:inputOrgsearchText']"))
            Dim sObject As Object = Nothing

            'if you find the organization name field then tpe in the the organization
            If Not sEObject Is Nothing Then
                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
                sElementOrgName.SendKeys(Keys.Control + "a")
                sElementOrgName.SendKeys(sFirstWordOrgName)
                mosaicDll.Logger(senderMCPAction, "Cleared the organization text box and entered the organization name.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not enter the organization name."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the organization name.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo SecondSet
            End If


            'Find and click the search button                      
            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/table/tbody/tr/td[3]/input"))
            If Not sObject Is Nothing Then
                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
                sElementSearchButton.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked Search", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find and click search button"
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and click search button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo SecondSet
            End If

            'Select the Organization from the list of results which were returned
            '--------------------------------------------------------
            Dim counter As Integer = 0

            'Full path to option button
            '/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/div/div/table/tbody/tr[1]/td[1]/table/tbody/tr/td/label/input

            'use the prefix and the suffix to locate and select the option button next to the organization
            Dim prefixOptionXPath As String = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/div/div/table/tbody/tr["
            Dim suffixOptionPath As String = "]/td[1]/table/tbody/tr/td/label/input"
            Dim table_element As IWebElement = Nothing

            'this table is a list of organizatios to select from found after search is clicked
            Dim oTable As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:inputOrgorgSerachDT"))
            If Not oTable Is Nothing Then
                table_element = DirectCast(oTable, IWebElement)
                returnValues(1) = "Found organization table for:" & sOrgName
                mosaicDll.Logger(senderMCPAction, "Found organization table for:" & sOrgName, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Did not find the organization table for:" & sOrgName
                mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for " & sOrgName, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo SecondSet
            End If



            'Find the organization
            Dim tr_collection As IList(Of IWebElement) = table_element.FindElements(By.XPath("id('pageTemplateForm:inputOrgorgSerachDT')/tbody/tr"))
            Dim done As Boolean = False

            Dim row_num As Integer = 0
            Dim col_num As Integer = 0

            row_num = 1

            'Set the organization
            For Each trElement As IWebElement In tr_collection

                Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement As IWebElement In td_collection
                    col_num = col_num + 1
                    If tdElement.Text.ToUpper.ToString() = sOrgName.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the organization to:" & sOrgName, myLogPath, , actionHistoryRecordID)
                            iFirstOrgFound = iFirstOrgFound + 1
                            done = True
                            Exit For
                        End If
                    End If
                Next

                If done = True Then
                    Exit For
                End If
                row_num = row_num + 1
            Next

            If iFirstOrgFound = 0 Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the first organization:" & sOrgName, myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the first organization: " & sOrgName & " in results."
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Secondset
            End If

            'Start processing the orgs and the contact specified

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))


            'prefix and suffix to click the select button
            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[3]/td/table/tbody/tr[2]/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]/input"


            Dim iFirstInputConctactsFound As Integer = 0 'keep track of te number of input contacts
            Dim sInputContact As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Input_Contact_1")

            'find the contact
            table_element = driver.FindElement(By.Id("pageTemplateForm:organizationContactList"))
            tr_collection = table_element.FindElements(By.XPath("id('pageTemplateForm:organizationContactList')/tbody/tr"))
            done = False

            row_num = 0
            col_num = 0

            row_num = 1

            'Pick the contact
            For Each trElement As IWebElement In tr_collection

                Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement As IWebElement In td_collection
                    'Console.WriteLine(tdElement.Text)
                    col_num = col_num + 1
                    If tdElement.Text.ToUpper.ToString() = sInputContact.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            iFirstInputConctactsFound = iFirstInputConctactsFound + 1
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the first input contact to: " & sInputContact, myLogPath, , actionHistoryRecordID)
                            done = True
                            Exit For
                        End If

                    End If
                Next

                row_num = row_num + 1
                If done = True Then
                    Exit For
                End If


            Next

            If iFirstInputConctactsFound = 0 Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the first input contact: " & sInputContact
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the first input contact: " & sInputContact, myLogPath, , actionHistoryRecordID)
                GoTo SecondSet
            Else
                GoTo SecondSet
            End If
SecondSet:

            '---------------------------------------------SECOND SET
            'Get the second word in the string
            Dim iSecondInputConctactsFound As Integer = 0
            Dim iSecodOrgFound As Integer = 0
            iErrorCount = 0
            sOrgName = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Input_2_Orgn_Name")
            done = False

            'sFirstWordOrgName = GetSecWord(sOrgName)
            sFirstWordOrgName = sOrgName

            If sOrgName = String.Empty Then
                'returnValues(0) = executionStatusPassed
                returnValues(1) = "No additonal inputs; Continuing"
                mosaicDll.Logger(senderMCPAction, "Actual Result|No additonal inputs specified; Continuing.", myLogPath, , actionHistoryRecordID)
                'CaptureScreenshot(actionHistoryRecordID)
                GoTo Thirdset
            End If


            'Set the value in the organization name field
            sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:inputOrgsearchText']"))
            sObject = Nothing

            If Not sEObject Is Nothing Then
                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
                sElementOrgName.SendKeys(Keys.Control + "a") 'send contr0l a
                sElementOrgName.SendKeys(sFirstWordOrgName)
                mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the organization text box and entered the organization name.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not enter the second organization name: "
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the second organization name: ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Thirdset
            End If

            'Find and click the search button
            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/table/tbody/tr/td[3]/input"))
            If Not sObject Is Nothing Then
                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
                sElementSearchButton.Click()
            Else
                GoTo Thirdset
            End If

            'Select the second organization from the list of results which were returned
            '--------------------------------------------------------
            counter = 0

            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/div/div/table/tbody/tr["
            suffixOptionPath = "]/td[1]/table/tbody/tr/td/label/input"


            'table_element = driver.FindElement(By.Id("pageTemplateForm:inputOrgorgSerachDT"))
            Dim oTable2 As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:inputOrgorgSerachDT"))
            If Not oTable2 Is Nothing Then
                table_element = DirectCast(oTable2, IWebElement)
                returnValues(1) = "Found the second organization table for:" & sOrgName
                mosaicDll.Logger(senderMCPAction, "Actual Result|Found the second organization for:" & sOrgName, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Did not find the second organization for:" & sOrgName
                mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for the second organization: " & sOrgName, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Thirdset
            End If

            tr_collection = table_element.FindElements(By.XPath("id('pageTemplateForm:inputOrgorgSerachDT')/tbody/tr"))

            Dim bDone As Boolean = False

            row_num = 0
            col_num = 0

            row_num = 1

            For Each trElement As IWebElement In tr_collection

                Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement As IWebElement In td_collection
                    col_num = col_num + 1
                    If tdElement.Text.ToUpper.ToString() = sOrgName.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the second organization to:" & sOrgName, myLogPath, , actionHistoryRecordID)
                            iSecodOrgFound = iSecodOrgFound + 1
                            done = True
                            Exit For
                        End If
                    End If
                Next

                If done = True Then
                    Exit For
                End If
                row_num = row_num + 1
            Next

            If iSecodOrgFound = 0 Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the second organization:" & sOrgName, myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the second organization: " & sOrgName & " in results."
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Thirdset
            End If


            'Start processing the orgs and the contact specified


            'xpath
            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[3]/td/table/tbody/tr[2]/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]/input"

            'select contact from table for contact 2
            'iInputConctactsFound = 0 'keep track of te number of input contacts
            sInputContact = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Input_Contact_2")

            'find the contact
            table_element = driver.FindElement(By.Id("pageTemplateForm:organizationContactList"))
            tr_collection = table_element.FindElements(By.XPath("id('pageTemplateForm:organizationContactList')/tbody/tr"))
            done = False

            row_num = 0
            col_num = 0

            row_num = 1

            For Each trElement As IWebElement In tr_collection

                Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement As IWebElement In td_collection
                    'Console.WriteLine(tdElement.Text)
                    col_num = col_num + 1
                    If tdElement.Text.ToUpper.ToString() = sInputContact.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            iSecondInputConctactsFound = iSecondInputConctactsFound + 1
                            mosaicDll.Logger(senderMCPAction, "Set the second input contact to: " & sInputContact, myLogPath, , actionHistoryRecordID)
                            done = True
                            Exit For
                        End If

                    End If
                Next

                row_num = row_num + 1
                If done = True Then
                    Exit For
                End If


            Next

            If iSecondInputConctactsFound = 0 Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the second input contact: " & sInputContact
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the second input contact: " & sInputContact, myLogPath, , actionHistoryRecordID)
                GoTo Thirdset
            Else
                GoTo Thirdset
            End If

Thirdset:

            '---------------------------------------------THIRD SET
            Dim ithirdTnputConctactsFound As Integer = 0
            Dim ithirdOrgFound As Integer = 0
            iErrorCount = 0
            done = False

            sOrgName = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Input_3_Orgn_Name")
            sFirstWordOrgName = sOrgName



            If sOrgName = String.Empty Then
                'returnValues(0) = executionStatusPassed
                returnValues(1) = "No additonal inputs; Continuing"
                mosaicDll.Logger(senderMCPAction, "Actual Result|No additonal inputs specified; Continuing.", myLogPath, , actionHistoryRecordID)
                'CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If


            'Set the value in the organization name field
            sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:inputOrgsearchText']"))
            sObject = Nothing

            If Not sEObject Is Nothing Then
                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
                sElementOrgName.SendKeys(Keys.Control + "a") 'send contr0l a
                sElementOrgName.SendKeys(sFirstWordOrgName)
                mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the organization text box and entered the organization name.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not enter the third organization name."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the third organization name.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Thirdset
            End If

            'Find and click the search button
            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/table/tbody/tr/td[3]/input"))
            If Not sObject Is Nothing Then
                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
                sElementSearchButton.Click()
            Else
                GoTo NextButton
            End If

            'Select the third organization from the list of results which were returned
            '--------------------------------------------------------
            counter = 0

            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/div/div/table/tbody/tr["
            suffixOptionPath = "]/td[1]/table/tbody/tr/td/label/input"


            'table_element = driver.FindElement(By.Id("pageTemplateForm:inputOrgorgSerachDT"))
            Dim oTable3 As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:inputOrgorgSerachDT"))
            If Not oTable3 Is Nothing Then
                table_element = DirectCast(oTable3, IWebElement)
                returnValues(1) = "Found the second organization table for:" & sOrgName
                mosaicDll.Logger(senderMCPAction, "Actual Result|Found the third organization for:" & sOrgName, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Did not find the second organization for:" & sOrgName
                mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for the third organization: " & sOrgName, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If
            tr_collection = table_element.FindElements(By.XPath("id('pageTemplateForm:inputOrgorgSerachDT')/tbody/tr"))

            bDone = False

            row_num = 0
            col_num = 0

            row_num = 1

            For Each trElement As IWebElement In tr_collection

                Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement As IWebElement In td_collection
                    col_num = col_num + 1
                    If tdElement.Text.ToUpper.ToString() = sOrgName.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the third organization to: " & sOrgName, myLogPath, , actionHistoryRecordID)
                            ithirdOrgFound = ithirdOrgFound + 1
                            bDone = True
                            Exit For
                        End If
                    End If
                Next

                If bDone = True Then
                    Exit For
                End If
                row_num = row_num + 1
            Next

            If ithirdOrgFound = 0 Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the third organization:" & sOrgName, myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the third organization: " & sOrgName & " in results."
                CaptureScreenshot(actionHistoryRecordID)
                GoTo nextButton
            End If


            'Start processing the orgs and the contact specified


            'xpath
            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[3]/td/table/tbody/tr[2]/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]/input"

            'select contact from table for contact 2
            'iInputConctactsFound = 0 'keep track of te number of input contacts
            sInputContact = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Input_Contact_3")

            'find the contact
            table_element = driver.FindElement(By.Id("pageTemplateForm:organizationContactList"))
            tr_collection = table_element.FindElements(By.XPath("id('pageTemplateForm:organizationContactList')/tbody/tr"))
            bDone = False

            row_num = 0
            col_num = 0

            row_num = 1

            For Each trElement As IWebElement In tr_collection

                Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement As IWebElement In td_collection
                    'Console.WriteLine(tdElement.Text)
                    col_num = col_num + 1
                    If tdElement.Text.ToUpper.ToString() = sInputContact.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            ithirdTnputConctactsFound = ithirdTnputConctactsFound + 1
                            mosaicDll.Logger(senderMCPAction, "Set the contact to: " & sInputContact, myLogPath, , actionHistoryRecordID)
                            done = True
                            Exit For
                        End If

                    End If
                Next

                row_num = row_num + 1
                If done = True Then
                    Exit For
                End If


            Next

            If ithirdTnputConctactsFound = 0 Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the third contact: " & sInputContact
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the third contact: " & sInputContact, myLogPath, , actionHistoryRecordID)
                GoTo NextButton
            Else
                GoTo NextButton
            End If

NextButton:


            'next button
            sObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:nextButton']"))
            If Not sObject Is Nothing Then
                Dim nextElement As IWebElement = DirectCast(sObject, IWebElement)
                nextElement.Click()
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not locate the next button."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not locate the next button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If





        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            If ex.Message = "Element is no longer valid" Then
                iErrorCount = iErrorCount + 1
                GoTo NextButton
            End If
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Initapp_3_Srch_Sel_Org_and_Input_Contact_0_to_3_Click_Next = returnValues
        End Try
    End Function
    Public Function GetSecWord(ByVal sWords As String) As String

        Dim counter As Integer = 1
        Dim words As String() = sWords.Split(New Char() {" "c})
        Dim itotalWords As Integer = words.Count
        Dim retval As String = String.Empty

        Try
            For Each s As String In words
                If counter = 2 Then
                    retval = s
                    Exit For
                End If
                counter = counter + 1
            Next

        Catch ex As Exception
            Return String.Empty

        End Try
        GetSecWord = retval

    End Function
    Public Function GetTheLastWord(ByVal sWords As String) As String

        Dim counter As Integer = 1
        Dim words As String() = sWords.Split(New Char() {" "c})
        Dim itotalWords As Integer = words.Count
        Dim retval As String = String.Empty

        Try

            For Each s As String In words
                If counter = itotalWords Then
                    retval = s
                    Exit For
                End If
                counter = counter + 1
            Next

        Catch ex As Exception
            Return String.Empty

        End Try

        GetTheLastWord = retval

    End Function
    Public Function FirstWord(ByVal aString As String) As String

        Dim returnString As String = ""
        Dim letters() As Char = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".ToCharArray
        If String.IsNullOrEmpty(aString) = False Then
            For index As Integer = 0 To aString.Length - 1
                If letters.Contains(Convert.ToChar(aString.Substring(index, 1))) = True Then
                    returnString &= aString.Substring(index, 1)
                Else
                    Exit For
                End If
            Next
        End If
        Return returnString
    End Function
    Public Function GenApp_Search_for_Member_Org(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        'Dim WaitForTime As Integer = 5
        Try

            'get the organization search string
            Dim strMember As String = mosaicDll.dt(excelPath, iteration, "srchmbr_mbr_search_criteria", "search_string")
            Dim elementMemberName As IWebElement = Nothing

            'Locate the element name field
            Dim oTemp As Object = Nothing

            oTemp = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:inputOrgsearchText']"))

            If Not oTemp Is Nothing Then
                elementMemberName = DirectCast(oTemp, IWebElement)
            Else
                oTemp = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:leadSearchTextprsr']"))
                If Not oTemp Is Nothing Then
                    elementMemberName = DirectCast(oTemp, IWebElement)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Could not locate the organiztion search field."
                    mosaicDll.Logger(senderMCPAction, "Could not locate the organiztion search field." & strMember, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If

            End If


            'Type in the org name
            elementMemberName.SendKeys(Keys.Control + "a")
            elementMemberName.SendKeys(strMember)

            'Find and click the search button
            Dim elementSearchButton As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/div/div/table/tbody/tr/td[3]/input"))
            elementSearchButton.Click()



            Dim sResultsExpected As String = mosaicDll.dt(excelPath, iteration, "srchmbr_mbr_search_criteria", "results_expected?")

            If sResultsExpected.ToUpper.ToString = "YES" Then

                Dim oResultsTable As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:leadSearchTextorgSerachDT']/thead/tr[1]/th"))

                If Not oResultsTable Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned results for: " & strMember, myLogPath, , actionHistoryRecordID)
                Else
                    'results expected but not found
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Actual Result|Search returned no results for: " & strMember
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for: " & strMember, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else
                Dim oResultsTable As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:leadSearchTextorgSerachDT']/thead/tr[1]/th"))

                If Not oResultsTable Is Nothing Then

                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Actual Result|Search returned results but none were expected for: " & strMember
                    mosaicDll.Logger(senderMCPAction, "Search returned results but none were expected for: " & strMember, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                Else

                    returnValues(0) = executionStatusPassed
                    returnValues(1) = "Actual Result|Search returned no results for: " & strMember
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for: " & strMember, myLogPath, , actionHistoryRecordID)
                    'CaptureScreenshot(actionHistoryRecordID)
                End If

            End If







        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            GenApp_Search_for_Member_Org = returnValues
        End Try
    End Function
    Public Function InitApp_4_Aft_srch_Sel_Mbr_Org_and_Lead_Mbr_Contact_Click_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        'Dim WaitForTime As Integer = 5
        Try

            Dim strLeadMemberName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "lead_mbr_orgn_name")

            Dim strMemberContact As List(Of String) = New List(Of String)
            strMemberContact.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "mbr_Contact_1"))
            strMemberContact.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "mbr_Contact_2"))
            strMemberContact.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "mbr_Contact_3"))



            Dim counter As Integer = 0


            Dim prefixOptionXPath As String = "/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr["
            Dim suffixOptionPath As String = "]/td[1]/table/tbody/tr/td/label/input"


            'get the results table from the screen in the previous executable step
            Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[3]/form/div[2]/div/div/div/div/div/table"))
            Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr/td[2]"))


            'search the table for the lead member name
            For Each row As IWebElement In rowCollection
                counter = counter + 1
                If row.Text.ToUpper.ToString() = strLeadMemberName.ToUpper.ToString() Then
                    'get the option element
                    Dim checkObject As Object = Nothing
                    Dim sOptionXPath As String = prefixOptionXPath & counter.ToString() & suffixOptionPath

                    checkObject = WaitForElement(driver, WaitForTime, By.XPath(sOptionXPath))
                    If Not checkObject Is Nothing Then
                        Dim iOptionElement As IWebElement = DirectCast(checkObject, IWebElement)
                        iOptionElement.Click()
                    Else
                        returnValues(0) = executionStatusFailedAbort
                        returnValues(1) = "Could not select lead contact."
                        mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select lead contact.", myLogPath, , actionHistoryRecordID)
                    End If

                    Exit For

                End If
            Next
            mosaicDll.Logger(senderMCPAction, "Actual Result|Lead member name has been successfully selected.", myLogPath, , actionHistoryRecordID)

            'process the first lead member contact
            'reseet variables
            tableElement = Nothing
            rowCollection = Nothing
            counter = 0


            'tricky table because it is inside of another table
            tableElement = driver.FindElement(By.XPath("//table[@id='pageTemplateForm:memberContactList']"))
            rowCollection = tableElement.FindElements(By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/span/span/table/tbody/tr"))


            'changes to this wil result in not finding the proper element
            'this is how I find the option element to select once the text is located
            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]/div/table/tbody/tr/td/input"


            'Select the chosen lead contacts if they exist
            If Not strMemberContact(0).Trim.ToUpper.ToString() = String.Empty Then
                Dim bContactFound1 As Boolean = False

                For Each row As IWebElement In rowCollection
                    tableElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:memberContactList']"))
                    rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/span/span/table/tbody/tr"))
                    counter = counter + 1
                    If row.Text.ToUpper.ToString() = strMemberContact(0).Trim.ToUpper.ToString() Then
                        'get the option element
                        Try
                            Dim sOptionXPath As String = prefixOptionXPath & counter.ToString() & suffixOptionPath
                            Dim iOptionElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath(sOptionXPath))
                            iOptionElement.Click()
                            bContactFound1 = True
                            Exit For
                        Catch ex As Exception
                            returnValues(0) = executionStatusFailed
                            ' returnValues(1) = "Could not select lead contact."
                            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select lead contact.", myLogPath, , actionHistoryRecordID)
                        End Try
                    End If
                Next

                If bContactFound1 Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Selected lead contact " & strMemberContact(0).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                Else

                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Could not find one or more lead contacts."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the lead contact " & strMemberContact(0).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If


            If Not strMemberContact(1).Trim.ToUpper.ToString() = String.Empty Then
                counter = 0
                Dim bContactFound2 As Boolean = False


                'Select the chosen lead contacts if they exist
                tableElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:memberContactList']"))
                rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/span/span/table/tbody/tr"))
                For Each row As IWebElement In rowCollection
                    counter = counter + 1

                    If row.Text.ToUpper.ToString() = strMemberContact(1).Trim.ToUpper.ToString() Then
                        'get the option element
                        Try
                            Dim sOptionXPath As String = prefixOptionXPath & counter.ToString() & suffixOptionPath
                            Dim iOptionElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath(sOptionXPath))
                            iOptionElement.Click()
                            bContactFound2 = True
                            Exit For
                        Catch ex As Exception
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = "Actual Result|Could not find the lead contact " & strMemberContact(1).Trim.ToUpper.ToString()
                            ' mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select lead contact.", myLogPath, , actionHistoryRecordID)
                        End Try
                    End If
                Next
                If bContactFound2 Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Selected lead contact " & strMemberContact(1).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Could not find one or more lead contacts."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the lead contact " & strMemberContact(1).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If Not strMemberContact(2).Trim.ToUpper.ToString() = String.Empty Then
                counter = 0
                Dim bContactFound3 As Boolean = False

                tableElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:memberContactList']"))
                rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("/html/body/div[3]/form/div[2]/div/table/tbody/tr/td/span/span/table/tbody/tr"))
                'Select the chosen lead contacts if they exist
                For Each row As IWebElement In rowCollection
                    counter = counter + 1
                    If row.Text.ToUpper.ToString() = strMemberContact(2).Trim.ToUpper.ToString() Then
                        Try
                            Dim sOptionXPath As String = prefixOptionXPath & counter.ToString() & suffixOptionPath
                            Dim iOptionElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath(sOptionXPath))
                            iOptionElement.Click()
                            bContactFound3 = True
                            Exit For
                        Catch ex As Exception
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = "Could not select lead contact."
                            ' mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select lead contact.", myLogPath, , actionHistoryRecordID)
                        End Try
                    End If
                Next
                If bContactFound3 Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Selected lead contact " & strMemberContact(2).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Could not find one or more lead contacts."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the lead contact " & strMemberContact(2).Trim.ToUpper.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If

            End If

            Dim nextElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/table[2]/tbody/tr/td[4]/input"))
            nextElement.Click()



            Dim iNumberRetry As Integer = 3
            Dim oElement As Object = Nothing
            Dim oLabel As Object = Nothing
            oLabel = WaitForElement(driver, WaitForTime, By.XPath("//input[@name='consortiumRadio']"))

            'Next Check TODO
            'if we did not find the label then retry
            'If oLabel Is Nothing Then
            '    'could not find the  label for the next page
            '    For x As Integer = 0 To iNumberRetry - 1

            '        nextElement.Click()
            '        oLabel = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='center']/table/tbody/tr[1]/td/table[3]/tbody/tr/td[1]/label"))
            '        If Not oLabel Is Nothing Then
            '            mosaicDll.Logger(senderMCPAction, "Actual Result|Click next was successful on retry.", myLogPath, , actionHistoryRecordID)
            '            Exit For
            '        End If
            '    Next
            'Else
            '    mosaicDll.Logger(senderMCPAction, "Actual Result|Click next was successful.", myLogPath, , actionHistoryRecordID)
            'End If

            If oLabel Is Nothing Then
                'retry attempts failed
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Click next failed could not continue to the next step."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Click next failed could not continue to the next step.", myLogPath, , actionHistoryRecordID)

                'look for the error message after click
                Dim oError As Object
                Dim iErrorElement As IWebElement = Nothing

                oError = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/span/table/tbody/tr/td/table/tbody/tr/td/ul/li"))
                If Not oError Is Nothing Then
                    'there is  error message
                    iErrorElement = DirectCast(oError, IWebElement)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Check the error message in the screen shot", myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailed
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If




        Catch ex As Exception
            returnValues(0) = executionStatusFailedAbort
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            InitApp_4_Aft_srch_Sel_Mbr_Org_and_Lead_Mbr_Contact_Click_Next = returnValues
        End Try
    End Function
    Public Function InitApp_5_Clk_N_Multi_or_Y_and_Srch_Sel_Mbr_Org_and_Co_Mbr_Contact(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)

        Dim sObject As Object = Nothing
        Dim TotalContacts As Integer = 0



        Try

            Dim sIsConsortium As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Multi_Mbr_Consortium")

            If sIsConsortium = String.Empty Then
                GoTo NextButton
            ElseIf sIsConsortium.ToUpper = "NO" Then
                Dim oConsortium As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/table[1]/tbody/tr/td[2]/table/tbody/tr/td[2]/label"))

                'if this is not a consort.. then click no
                If Not oConsortium Is Nothing Then
                    Dim sElementNOption As IWebElement = DirectCast(oConsortium, IWebElement)
                    sElementNOption.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the no option for consortium.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Could not find and/or click the no option for consortium."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and/or click the no option for consortium.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextButton
                End If
            ElseIf sIsConsortium.ToUpper = "YES" Then

                Dim oConsortium As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/table[1]/tbody/tr/td[2]/table/tbody/tr/td[1]/label"))

                'if this is not a consort.. then click no
                If Not oConsortium Is Nothing Then
                    Dim sElementNOption As IWebElement = DirectCast(oConsortium, IWebElement)
                    sElementNOption.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the yes option for consortium.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Could not find and/or click the yes option for consortium."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and/or click the no option for consortium.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextButton
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "The value: " & sIsConsortium & "is not one of the allowable options."
                mosaicDll.Logger(senderMCPAction, "Actual Result|The value: " & sIsConsortium & " is not one of the allowable options.", myLogPath, , actionHistoryRecordID)
                'CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If



            '--------------------------------------------------------------------------One----------------------------------------------------------------------------------------------


            Dim sCoMbrOrgName1 As Object = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Mbr_1_Orgn_Name")


            Dim iOrgFoundCount As Integer = 0
            Dim iContactFoundCount As Integer = 0

            Dim done1 As Boolean = False 'used to exit 

            'check the org name
            If sCoMbrOrgName1 = String.Empty Then
                returnValues(1) = " No co-member organization number one was specified. Skipped"
                mosaicDll.Logger(senderMCPAction, "Actual Result|No co-member organization number one was specified. Skipped", myLogPath, , actionHistoryRecordID)
                GoTo Second
            End If


            'Set the element to the the organization name field
            Dim sEObject As Object = Nothing
            sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:searchTextprsr']"))


            'if you find the organization name field then type in the the organization
            If Not sEObject Is Nothing Then
                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
                sElementOrgName.SendKeys(Keys.Control + "a")
                sElementOrgName.SendKeys(sCoMbrOrgName1)
                mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the co-member organization text box and entered the co-member number one with organization name: " & sCoMbrOrgName1.ToString(), myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not enter the co-member one organization name."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the co-member number one organization name: " & sCoMbrOrgName1, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Second
            End If


            'Find and click the search button        
            sObject = Nothing
            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/div/div/table/tbody/tr/td[3]/input"))
            If Not sObject Is Nothing Then
                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
                sElementSearchButton.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Search", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Actual Result|Could not find and click search button while processing comeber organization number one."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and click search button while processing comeber organization number one.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Second
            End If

            'Select the Organization from the list of results which were returned
            '--------------------------------------------------------
            Dim counter As Integer = 0


            'use the prefix and the suffix to locate and select the option button next to the organization
            Dim prefixOptionXPath As String = "/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr["
            Dim suffixOptionPath As String = "]/td[1]/table/tbody/tr/td/label/input"
            Dim table_element1 As IWebElement = Nothing

            'this table is a list of organizatios to select from found after search is clicked
            Dim oTable As Object = Nothing
            oTable = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:searchTextorgSerachDT"))
            If Not oTable Is Nothing Then
                table_element1 = DirectCast(oTable, IWebElement)
                returnValues(1) = "Found organization table for:" & sCoMbrOrgName1
                mosaicDll.Logger(senderMCPAction, "Actual Result|Found organization table for:" & sCoMbrOrgName1, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Did not find the organization table for organization number one. "
                mosaicDll.Logger(senderMCPAction, "Actual Result|Did not find the organization table for organization number one: ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Second
            End If

            'Find the organization
            Dim tr_collection1 As IList(Of IWebElement) = Nothing
            tr_collection1 = WaitForElements(driver, WaitForTime, table_element1, By.XPath("id('pageTemplateForm:searchTextorgSerachDT')/tbody/tr"))

            'Dim done As Boolean = False

            Dim row_num As Integer = 0
            Dim col_num As Integer = 0

            row_num = 1

            'Set the organization
            For Each trElement1 As IWebElement In tr_collection1

                Dim td_collection1 As IList(Of IWebElement) = trElement1.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement1 As IWebElement In td_collection1
                    col_num = col_num + 1
                    If tdElement1.Text.ToUpper.ToString() = sCoMbrOrgName1.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the co-member organization to:" & sCoMbrOrgName1, myLogPath, , actionHistoryRecordID)
                            iOrgFoundCount = iOrgFoundCount + 1
                            done1 = True
                            Exit For
                        End If
                    End If
                Next

                If done1 = True Then
                    Exit For
                End If
                row_num = row_num + 1
            Next

            If iOrgFoundCount = 0 Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the organization number one for co-member organization: " & sCoMbrOrgName1, myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Count not find the organization number one for co-member organization: "
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Second
            End If



            'Start processing the orgs and the contact specified

            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table[2]/tbody/tr[1]/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]"


            Dim iCoMbrConctactsFound1 As Integer = 0 'keep track of te number of input contacts
            Dim sInputCoMbrContact1 As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Member_Contact_1")

            'find the contact
            'Dim tempObject As Object = driver.FindElement(By.Id("pageTemplateForm:memberContactList"))
            Dim tempObject As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:memberContactList"))
            Dim table_element2 As IWebElement 'contact list for this organization
            If Not tempObject Is Nothing Then
                table_element2 = DirectCast(tempObject, IWebElement)
            Else
                'passed
                returnValues(1) = "Could not find the co-member organization contact list. Skipped"
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the co-member organization contact list. Skipped", myLogPath, , actionHistoryRecordID)
                GoTo Second
            End If

            'contact list rows
            Dim tr_collection2 As IList(Of IWebElement) = table_element2.FindElements(By.XPath("id('pageTemplateForm:memberContactList')/tbody/tr"))

            done1 = False

            row_num = 0
            col_num = 0

            row_num = 1

            Dim runcounter As Integer = 0

            'Pick the contact
            'loop through the rows
            For Each trElement2 As Object In tr_collection2


                Dim td_collection3 As IList(Of IWebElement) = WaitForElements(driver, WaitForTime, table_element2, By.XPath("/html/body/div[3]/form/div[2]/div/table[2]/tbody/tr[1]/td/span/span/table/tbody/tr"))
                col_num = 1

                ' For y As Integer = 0 To td_collection.Count - 1
                For Each tdElement3 As IWebElement In td_collection3
                    col_num = col_num + 1
                    If tdElement3.Text.ToUpper.ToString() = sInputCoMbrContact1.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            iCoMbrConctactsFound1 = iCoMbrConctactsFound1 + 1
                            mosaicDll.Logger(senderMCPAction, "Set the contact number one input contact to: " & sInputCoMbrContact1, myLogPath, , actionHistoryRecordID)
                            done1 = True
                            Exit For
                        End If

                    End If
                Next


                If done1 = True Then
                    Exit For
                End If

                row_num = row_num + 1

            Next


            If iCoMbrConctactsFound1 = 0 Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the contact number one for input contact: " & sInputCoMbrContact1
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the contact number one" & sInputCoMbrContact1, myLogPath, , actionHistoryRecordID)
                GoTo Second
            End If

Second:
            '--------------------------------------------------------------------------Two----------------------------------------------------------------------------------------------
            Dim sCoMbrOrgName2 As Object = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Mbr_2_Orgn_Name")


            iOrgFoundCount = 0
            iContactFoundCount = 0

            done1 = False 'used to exit 

            'check the org name
            If sCoMbrOrgName2 = String.Empty Then
                returnValues(1) = " No co-member organization number two was specified. Skipped"
                mosaicDll.Logger(senderMCPAction, "Actual Result|No co-member organization number two was specified. Skipped", myLogPath, , actionHistoryRecordID)
                GoTo NextButton
            End If


            'Set the element to the the organization name field
            sEObject = Nothing
            sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:searchTextprsr']"))


            'if you find the organization name field then type in the the organization
            If Not sEObject Is Nothing Then
                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
                sElementOrgName.SendKeys(Keys.Control + "a")
                sElementOrgName.SendKeys(sCoMbrOrgName2)
                mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the co-member organization text box and entered the co-member number two with organization name: " & sCoMbrOrgName2.ToString(), myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not enter the co-member two organization name."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the co-member number two organization name: " & sCoMbrOrgName2, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If


            'Find and click the search button        
            sObject = Nothing
            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/div/div/table/tbody/tr/td[3]/input"))
            If Not sObject Is Nothing Then
                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
                sElementSearchButton.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Search", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Actual Result|Could not find and click search button while processing comeber organization number two."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and click search button while processing comeber organization number two.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If

            'Select the Organization from the list of results which were returned
            '--------------------------------------------------------
            counter = 0


            'use the prefix and the suffix to locate and select the option button next to the organization
            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr["
            suffixOptionPath = "]/td[1]/table/tbody/tr/td/label/input"


            'this table is a list of organizatios to select from found after search is clicked
            oTable = Nothing
            oTable = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:searchTextorgSerachDT"))
            If Not oTable Is Nothing Then
                table_element1 = DirectCast(oTable, IWebElement)
                returnValues(1) = "Found organization table for:" & sCoMbrOrgName2
                mosaicDll.Logger(senderMCPAction, "Actual Result|Found organization table for:" & sCoMbrOrgName2, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Did not find the organization table for organization number two. "
                mosaicDll.Logger(senderMCPAction, "Actual Result|Did not find the organization table for organization number two: ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If

            'Find the organization
            tr_collection1 = Nothing
            tr_collection1 = WaitForElements(driver, WaitForTime, table_element1, By.XPath("id('pageTemplateForm:searchTextorgSerachDT')/tbody/tr"))


            row_num = 0
            col_num = 0

            row_num = 1

            'Set the organization
            For Each trElement1 As IWebElement In tr_collection1

                Dim td_collection1 As IList(Of IWebElement) = trElement1.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement1 As IWebElement In td_collection1
                    col_num = col_num + 1
                    If tdElement1.Text.ToUpper.ToString() = sCoMbrOrgName2.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the co-member organization to:" & sCoMbrOrgName2, myLogPath, , actionHistoryRecordID)
                            iOrgFoundCount = iOrgFoundCount + 1
                            done1 = True
                            Exit For
                        End If
                    End If
                Next

                row_num = row_num + 1
                If done1 = True Then
                    Exit For
                End If

            Next

            If iOrgFoundCount = 0 Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the organization number two for co-member organization: " & sCoMbrOrgName2, myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Count not find the organization number two for co-member organization: "
                CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If


            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table[2]/tbody/tr[1]/td/span/span/table/tbody/tr["
            suffixOptionPath = "]/td[2]"


            iCoMbrConctactsFound1 = 0 'keep track of te number of input contacts
            Dim sInputCoMbrContact2 As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Member_Contact_2")

            'find the contact
            'Dim tempObject As Object = driver.FindElement(By.Id("pageTemplateForm:memberContactList"))
            tempObject = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:memberContactList"))

            If Not tempObject Is Nothing Then
                table_element2 = DirectCast(tempObject, IWebElement)
            Else
                'passed
                returnValues(1) = "Could not find the co-member organization contact list. Skipped"
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the co-member organization contact list. Skipped", myLogPath, , actionHistoryRecordID)
                GoTo NextButton
            End If

            'contact list rows
            tr_collection2 = table_element2.FindElements(By.XPath("id('pageTemplateForm:memberContactList')/tbody/tr"))

            done1 = False

            row_num = 0
            col_num = 0
            row_num = 1
            runcounter = 0
            col_num = 1
            For Each tdElement3 As IWebElement In tr_collection2


                col_num = col_num + 1
                If tdElement3.Text.ToUpper.ToString() = sInputCoMbrContact2.ToUpper.ToString() Then
                    Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                    Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                    If Not oOption Is Nothing Then
                        Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                        oElement.Click()
                        iCoMbrConctactsFound1 = iCoMbrConctactsFound1 + 1
                        mosaicDll.Logger(senderMCPAction, "Set the contact number two input contact to: " & sInputCoMbrContact2, myLogPath, , actionHistoryRecordID)
                        done1 = True
                        Exit For
                    End If

                End If

                row_num = row_num + 1
                If done1 = True Then
                    Exit For
                End If
            Next


            If iCoMbrConctactsFound1 = 0 Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not find the contact number two for input contact: " & sInputCoMbrContact2
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the contact number two." & sInputCoMbrContact2, myLogPath, , actionHistoryRecordID)
                GoTo NextButton
            End If


Third:
            '------------------------------------------------------------Three
            '            Dim sCoMbrOrgName3 As Object = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Mbr_3_Orgn_Name")


            '            iOrgFoundCount = 0
            '            iContactFoundCount = 0

            '            done1 = False 'used to exit 

            '            'check the org name
            '            If sCoMbrOrgName3 = String.Empty Then
            '                ' returnValues(0) = executionSatusPassed
            '                'TODO fix message
            '                returnValues(1) = " No co-member organization number one was specified. Skipped"
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|No co-member organization number one was specified. Skipped", myLogPath, , actionHistoryRecordID)
            '                GoTo Fourth
            '            End If


            '            'Set the element to the the organization name field
            '            sEObject = Nothing
            '            sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:searchTextprsr']"))


            '            'if you find the organization name field then type in the the organization
            '            If Not sEObject Is Nothing Then
            '                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
            '                sElementOrgName.SendKeys(Keys.Control + "a")
            '                sElementOrgName.SendKeys(sCoMbrOrgName3)
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the co-member organization text box and entered the co-member number one with organization name: " & sCoMbrOrgName3.ToString(), myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Could not enter the co-member one organization name."
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the co-member number one organization name: " & sCoMbrOrgName3, myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fourth
            '            End If


            '            'Find and click the search button        
            '            sObject = Nothing
            '            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/div/div/table/tbody/tr/td[3]/input"))
            '            If Not sObject Is Nothing Then
            '                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
            '                sElementSearchButton.Click()
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Search", myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Actual Result|Could not find and click search button while processing comeber organization number two."
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and click search button while processing comeber organization number two.", myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fourth
            '            End If

            '            'Select the Organization from the list of results which were returned
            '            '--------------------------------------------------------
            '            counter = 0


            '            'use the prefix and the suffix to locate and select the option button next to the organization
            '            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr["
            '            suffixOptionPath = "]/td[1]/table/tbody/tr/td/label/input"


            '            'this table is a list of organizatios to select from found after search is clicked
            '            oTable = Nothing
            '            oTable = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:searchTextorgSerachDT"))
            '            If Not oTable Is Nothing Then
            '                table_element1 = DirectCast(oTable, IWebElement)
            '                returnValues(1) = "Found organization table for:" & sCoMbrOrgName3
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Found organization table for:" & sCoMbrOrgName3, myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Did not find the organization table for organization number one. "
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Did not find the organization table for organization number one: ", myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fourth
            '            End If

            '            'Find the organization
            '            tr_collection1 = Nothing
            '            tr_collection1 = WaitForElements(driver, WaitForTime, table_element1, By.XPath("id('pageTemplateForm:searchTextorgSerachDT')/tbody/tr"))


            '            row_num = 0
            '            col_num = 0

            '            row_num = 1

            '            'Set the organization
            '            For Each trElement1 As IWebElement In tr_collection1

            '                Dim td_collection1 As IList(Of IWebElement) = trElement1.FindElements(By.XPath("td"))
            '                col_num = 1

            '                For Each tdElement1 As IWebElement In td_collection1
            '                    col_num = col_num + 1
            '                    If tdElement1.Text.ToUpper.ToString() = sCoMbrOrgName3.ToUpper.ToString() Then
            '                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '                        If Not oOption Is Nothing Then
            '                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                            oElement.Click()
            '                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the co-member organization to:" & sCoMbrOrgName3, myLogPath, , actionHistoryRecordID)
            '                            iOrgFoundCount = iOrgFoundCount + 1
            '                            done1 = True
            '                            Exit For
            '                        End If
            '                    End If
            '                Next

            '                row_num = row_num + 1
            '                If done1 = True Then
            '                    Exit For
            '                End If

            '            Next

            '            If iOrgFoundCount = 0 Then
            '                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the organization number one for co-member organization: " & sCoMbrOrgName1, myLogPath, , actionHistoryRecordID)
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Count not find the organization number one for co-member organization: "
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fourth
            '            End If



            '            'Start processing the orgs and the contact specified

            '            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table[2]/tbody/tr[1]/td/span/span/table/tbody/tr["
            '            suffixOptionPath = "]/td[2]"


            '            iCoMbrConctactsFound1 = 0 'keep track of te number of input contacts
            '            Dim sInputCoMbrContact3 As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Member_Contact_3")

            '            'find the contact
            '            'Dim tempObject As Object = driver.FindElement(By.Id("pageTemplateForm:memberContactList"))
            '            tempObject = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:memberContactList"))

            '            If Not tempObject Is Nothing Then
            '                table_element2 = DirectCast(tempObject, IWebElement)
            '            Else
            '                'passed
            '                returnValues(1) = "Could not find the co-member organization contact list. Skipped"
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the co-member organization contact list. Skipped", myLogPath, , actionHistoryRecordID)
            '                GoTo Fourth
            '            End If

            '            'contact list rows
            '            tr_collection2 = table_element2.FindElements(By.XPath("id('pageTemplateForm:memberContactList')/tbody/tr"))

            '            done1 = False

            '            row_num = 0
            '            col_num = 0
            '            row_num = 1
            '            runcounter = 0
            '            col_num = 1
            '            For Each tdElement3 As IWebElement In tr_collection2


            '                col_num = col_num + 1
            '                If tdElement3.Text.ToUpper.ToString() = sInputCoMbrContact3.ToUpper.ToString() Then
            '                    Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '                    Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '                    If Not oOption Is Nothing Then
            '                        Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                        oElement.Click()
            '                        iCoMbrConctactsFound1 = iCoMbrConctactsFound1 + 1
            '                        mosaicDll.Logger(senderMCPAction, "Set the contact number two input contact to: " & sInputCoMbrContact3, myLogPath, , actionHistoryRecordID)
            '                        done1 = True
            '                        Exit For
            '                    End If

            '                End If

            '                row_num = row_num + 1
            '                If done1 = True Then
            '                    Exit For
            '                End If
            '            Next

            '            If iCoMbrConctactsFound1 = 0 Then
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Could not find the contact number one for input contact: " & sInputCoMbrContact3
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the contact number one" & sInputCoMbrContact3, myLogPath, , actionHistoryRecordID)
            '                GoTo Fourth
            '            End If
            'Fourth:

            '            '------------------------------------------------------------Four
            '            Dim sCoMbrOrgName4 As Object = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Mbr_4_Orgn_Name")


            '            iOrgFoundCount = 0
            '            iContactFoundCount = 0

            '            done1 = False 'used to exit 

            '            'check the org name
            '            If sCoMbrOrgName4 = String.Empty Then
            '                ' returnValues(0) = executionSatusPassed
            '                'TODO fix message
            '                returnValues(1) = " No co-member organization number one was specified. Skipped"
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|No co-member organization number one was specified. Skipped", myLogPath, , actionHistoryRecordID)
            '                GoTo Fifth
            '            End If


            '            'Set the element to the the organization name field
            '            sEObject = Nothing
            '            sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:searchTextprsr']"))


            '            'if you find the organization name field then type in the the organization
            '            If Not sEObject Is Nothing Then
            '                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
            '                sElementOrgName.SendKeys(Keys.Control + "a")
            '                sElementOrgName.SendKeys(sCoMbrOrgName4)
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the co-member organization text box and entered the co-member number one with organization name: " & sCoMbrOrgName4.ToString(), myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Could not enter the co-member one organization name."
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the co-member number one organization name: " & sCoMbrOrgName4, myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fifth
            '            End If


            '            'Find and click the search button        
            '            sObject = Nothing
            '            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/div/div/table/tbody/tr/td[3]/input"))
            '            If Not sObject Is Nothing Then
            '                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
            '                sElementSearchButton.Click()
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Search", myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Actual Result|Could not find and click search button while processing comeber organization number two."
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and click search button while processing comeber organization number two.", myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fifth
            '            End If

            '            'Select the Organization from the list of results which were returned
            '            '--------------------------------------------------------
            '            counter = 0


            '            'use the prefix and the suffix to locate and select the option button next to the organization
            '            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr["
            '            suffixOptionPath = "]/td[1]/table/tbody/tr/td/label/input"


            '            'this table is a list of organizatios to select from found after search is clicked
            '            oTable = Nothing
            '            oTable = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:searchTextorgSerachDT"))
            '            If Not oTable Is Nothing Then
            '                table_element1 = DirectCast(oTable, IWebElement)
            '                returnValues(1) = "Found organization table for:" & sCoMbrOrgName4
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Found organization table for:" & sCoMbrOrgName4, myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Did not find the organization table for organization number one. "
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Did not find the organization table for organization number one: ", myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fifth
            '            End If

            '            'Find the organization
            '            tr_collection1 = Nothing
            '            tr_collection1 = WaitForElements(driver, WaitForTime, table_element1, By.XPath("id('pageTemplateForm:searchTextorgSerachDT')/tbody/tr"))


            '            row_num = 0
            '            col_num = 0

            '            row_num = 1

            '            'Set the organization
            '            For Each trElement1 As IWebElement In tr_collection1

            '                Dim td_collection1 As IList(Of IWebElement) = trElement1.FindElements(By.XPath("td"))
            '                col_num = 1

            '                For Each tdElement1 As IWebElement In td_collection1
            '                    col_num = col_num + 1
            '                    If tdElement1.Text.ToUpper.ToString() = sCoMbrOrgName3.ToUpper.ToString() Then
            '                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '                        If Not oOption Is Nothing Then
            '                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                            oElement.Click()
            '                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the co-member organization to:" & sCoMbrOrgName4, myLogPath, , actionHistoryRecordID)
            '                            iOrgFoundCount = iOrgFoundCount + 1
            '                            done1 = True
            '                            Exit For
            '                        End If
            '                    End If
            '                Next

            '                row_num = row_num + 1
            '                If done1 = True Then
            '                    Exit For
            '                End If

            '            Next

            '            If iOrgFoundCount = 0 Then
            '                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the organization number one for co-member organization: " & sCoMbrOrgName4, myLogPath, , actionHistoryRecordID)
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Count not find the organization number one for co-member organization: "
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fifth
            '            End If



            '            'Start processing the orgs and the contact specified

            '            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table[2]/tbody/tr[1]/td/span/span/table/tbody/tr["
            '            suffixOptionPath = "]/td[2]"


            '            iCoMbrConctactsFound1 = 0 'keep track of te number of input contacts
            '            Dim sInputCoMbrContact4 As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Member_Contact_4")

            '            'find the contact
            '            'Dim tempObject As Object = driver.FindElement(By.Id("pageTemplateForm:memberContactList"))
            '            tempObject = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:memberContactList"))

            '            If Not tempObject Is Nothing Then
            '                table_element2 = DirectCast(tempObject, IWebElement)
            '            Else
            '                'passed
            '                returnValues(1) = "Could not find the co-member organization contact list. Skipped"
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the co-member organization contact list. Skipped", myLogPath, , actionHistoryRecordID)
            '                GoTo Fifth
            '            End If

            '            'contact list rows
            '            tr_collection2 = table_element2.FindElements(By.XPath("id('pageTemplateForm:memberContactList')/tbody/tr"))

            '            done1 = False

            '            row_num = 0
            '            col_num = 0
            '            row_num = 1
            '            runcounter = 0
            '            col_num = 1
            '            For Each tdElement3 As IWebElement In tr_collection2


            '                col_num = col_num + 1
            '                If tdElement3.Text.ToUpper.ToString() = sInputCoMbrContact4.ToUpper.ToString() Then
            '                    Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '                    Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '                    If Not oOption Is Nothing Then
            '                        Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                        oElement.Click()
            '                        iCoMbrConctactsFound1 = iCoMbrConctactsFound1 + 1
            '                        mosaicDll.Logger(senderMCPAction, "Set the contact number two input contact to: " & sInputCoMbrContact4, myLogPath, , actionHistoryRecordID)
            '                        done1 = True
            '                        Exit For
            '                    End If

            '                End If

            '                row_num = row_num + 1
            '                If done1 = True Then
            '                    Exit For
            '                End If
            '            Next

            '            If iCoMbrConctactsFound1 = 0 Then
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Could not find the contact number one for input contact: " & sInputCoMbrContact4
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the contact number one" & sInputCoMbrContact4, myLogPath, , actionHistoryRecordID)
            '                GoTo Fifth
            '            End If

            '            '-------------------------------------------------------------------------------------Fifth
            'Fifth:
            '            Dim sCoMbrOrgName5 As Object = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Mbr_4_Orgn_Name")


            '            iOrgFoundCount = 0
            '            iContactFoundCount = 0

            '            done1 = False 'used to exit 

            '            'check the org name
            '            If sCoMbrOrgName4 = String.Empty Then
            '                ' returnValues(0) = executionSatusPassed
            '                'TODO fix message
            '                returnValues(1) = " No co-member organization number five was specified. Skipped"
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|No co-member organization number one was specified. Skipped", myLogPath, , actionHistoryRecordID)
            '                GoTo NextButton
            '            End If


            '            'Set the element to the the organization name field
            '            sEObject = Nothing
            '            sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:searchTextprsr']"))


            '            'if you find the organization name field then type in the the organization
            '            If Not sEObject Is Nothing Then
            '                Dim sElementOrgName As IWebElement = DirectCast(sEObject, IWebElement)
            '                sElementOrgName.SendKeys(Keys.Control + "a")
            '                sElementOrgName.SendKeys(sCoMbrOrgName4)
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the co-member organization text box and entered the co-member number five with organization name: " & sCoMbrOrgName5.ToString(), myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Could not enter the co-member one organization name."
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the co-member number five organization name: " & sCoMbrOrgName5, myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo NextButton
            '            End If


            '            'Find and click the search button        
            '            sObject = Nothing
            '            sObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[3]/form/div[2]/div/div/div/table/tbody/tr/td[3]/input"))
            '            If Not sObject Is Nothing Then
            '                Dim sElementSearchButton As IWebElement = DirectCast(sObject, IWebElement)
            '                sElementSearchButton.Click()
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Search", myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Actual Result|Could not find and click search button while processing comeber organization number five."
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find and click search button while processing comeber organization number five.", myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo Fifth
            '            End If

            '            'Select the Organization from the list of results which were returned
            '            '--------------------------------------------------------
            '            counter = 0


            '            'use the prefix and the suffix to locate and select the option button next to the organization
            '            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/div/div/div/div/table/tbody/tr["
            '            suffixOptionPath = "]/td[1]/table/tbody/tr/td/label/input"


            '            'this table is a list of organizatios to select from found after search is clicked
            '            oTable = Nothing
            '            oTable = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:searchTextorgSerachDT"))
            '            If Not oTable Is Nothing Then
            '                table_element1 = DirectCast(oTable, IWebElement)
            '                returnValues(1) = "Found organization table for:" & sCoMbrOrgName4
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Found organization table for:" & sCoMbrOrgName4, myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Did not find the organization table for organization number five. "
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Did not find the organization table for organization number five: ", myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo NextButton
            '            End If

            '            'Find the organization
            '            tr_collection1 = Nothing
            '            tr_collection1 = WaitForElements(driver, WaitForTime, table_element1, By.XPath("id('pageTemplateForm:searchTextorgSerachDT')/tbody/tr"))


            '            row_num = 0
            '            col_num = 0

            '            row_num = 1

            '            'Set the organization
            '            For Each trElement1 As IWebElement In tr_collection1

            '                Dim td_collection1 As IList(Of IWebElement) = trElement1.FindElements(By.XPath("td"))
            '                col_num = 1

            '                For Each tdElement1 As IWebElement In td_collection1
            '                    col_num = col_num + 1
            '                    If tdElement1.Text.ToUpper.ToString() = sCoMbrOrgName3.ToUpper.ToString() Then
            '                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '                        If Not oOption Is Nothing Then
            '                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                            oElement.Click()
            '                            mosaicDll.Logger(senderMCPAction, "Actual Result | Set the co-member organization to:" & sCoMbrOrgName5, myLogPath, , actionHistoryRecordID)
            '                            iOrgFoundCount = iOrgFoundCount + 1
            '                            done1 = True
            '                            Exit For
            '                        End If
            '                    End If
            '                Next

            '                row_num = row_num + 1
            '                If done1 = True Then
            '                    Exit For
            '                End If

            '            Next

            '            If iOrgFoundCount = 0 Then
            '                mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the organization number one for co-member organization: " & sCoMbrOrgName5, myLogPath, , actionHistoryRecordID)
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Count not find the organization number one for co-member organization: "
            '                CaptureScreenshot(actionHistoryRecordID)
            '                GoTo NextButton
            '            End If



            '            'Start processing the orgs and the contact specified

            '            prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table[2]/tbody/tr[1]/td/span/span/table/tbody/tr["
            '            suffixOptionPath = "]/td[2]"


            '            iCoMbrConctactsFound1 = 0 'keep track of te number of input contacts
            '            Dim sInputCoMbrContact5 As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Co_Member_Contact_5")

            '            'find the contact
            '            'Dim tempObject As Object = driver.FindElement(By.Id("pageTemplateForm:memberContactList"))
            '            tempObject = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:memberContactList"))

            '            If Not tempObject Is Nothing Then
            '                table_element2 = DirectCast(tempObject, IWebElement)
            '            Else
            '                'passed
            '                returnValues(1) = "Could not find the co-member organization contact list. Skipped"
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the co-member organization contact list. Skipped", myLogPath, , actionHistoryRecordID)
            '                GoTo NextButton
            '            End If

            '            'contact list rows
            '            tr_collection2 = table_element2.FindElements(By.XPath("id('pageTemplateForm:memberContactList')/tbody/tr"))

            '            done1 = False

            '            row_num = 0
            '            col_num = 0
            '            row_num = 1
            '            runcounter = 0
            '            col_num = 1
            '            For Each tdElement3 As IWebElement In tr_collection2


            '                col_num = col_num + 1
            '                If tdElement3.Text.ToUpper.ToString() = sInputCoMbrContact5.ToUpper.ToString() Then
            '                    Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '                    Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '                    If Not oOption Is Nothing Then
            '                        Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                        oElement.Click()
            '                        iCoMbrConctactsFound1 = iCoMbrConctactsFound1 + 1
            '                        mosaicDll.Logger(senderMCPAction, "Set the contact number two input contact to: " & sInputCoMbrContact5, myLogPath, , actionHistoryRecordID)
            '                        done1 = True
            '                        Exit For
            '                    End If

            '                End If

            '                row_num = row_num + 1
            '                If done1 = True Then
            '                    Exit For
            '                End If
            '            Next

            '            If iCoMbrConctactsFound1 = 0 Then
            '                returnValues(0) = executionStatusFailed
            '                returnValues(1) = "Could not find the contact number one for input contact: " & sInputCoMbrContact5
            '                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the contact number one" & sInputCoMbrContact5, myLogPath, , actionHistoryRecordID)
            '                GoTo NextButton
            '            End If


NextButton:
            sObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:nextButton']"))
            If Not sObject Is Nothing Then
                Dim nextElement As IWebElement = DirectCast(sObject, IWebElement)
                nextElement.Click()
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not locate the next button wizard step 3"
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not locate the next button wizard step 3. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            'check for next screen maybe

            Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Error_Message")
            ' Dim sDataProfileID As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "DataProfileID")
            ' Dim sProjectName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Name")

            If Not String.IsNullOrEmpty(sErrorMessage) Then
                'check the value error message has value
                sObject = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:messages']/table/tbody/tr/td/table/tbody/tr/td"))
                If sObject Is Nothing Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "No error message is displayed - See screen shot."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|The next button was clcked and no error message is displayed", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                Else
                    returnValues(1) = "Error message is displayed - See screen shot."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|The next button was clicked and an error message is displayed", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else
                Dim oResult As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:submitButton']"))
                If Not oResult Is Nothing Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Click next was successful.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = "Click next was not successful. See screen shot"
                    CaptureScreenshot(actionHistoryRecordID)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Click next was not successful. See screen shot.", myLogPath, , actionHistoryRecordID)
                End If
            End If
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            InitApp_5_Clk_N_Multi_or_Y_and_Srch_Sel_Mbr_Org_and_Co_Mbr_Contact = returnValues
        End Try
    End Function
    Public Function Initapp_6_Review_and_Submit_Finish(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Dim sApplicationID As String = String.Empty

        Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Error_Message")
        Dim sProfileID As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "DataProfileID")
        Dim sProjectName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Name")

        Dim sProtocol As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_protocol")
        Dim sHost As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_host")
        Dim sServiceName As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_service_name")
        Dim sPort As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_port")
        Dim sUser As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_User")
        Dim sPass As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_Password")


        Try

            Dim oResult As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:submitButton']"))
            Dim submitElement As IWebElement = Nothing
            Dim finishElement As IWebElement = Nothing

            If Not oResult Is Nothing Then
                submitElement = DirectCast(oResult, IWebElement)
                submitElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|The application has been submitted. ", myLogPath, , actionHistoryRecordID)
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|The application has not been submitted. ", myLogPath, , actionHistoryRecordID)
            End If


            oResult = Nothing
            oResult = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:finishButton']"))
            If Not oResult Is Nothing Then
                finishElement = DirectCast(oResult, IWebElement)
                finishElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked finish. ", myLogPath, , actionHistoryRecordID)

                'Run parameters
                Dim sSQL As String = "SELECT APPLICATION_ID,  APPLICATION_NAME FROM CID.APPLICATION WHERE application_name='" & sProjectName.Trim & "'"
                Dim oradb As String = "Data Source=(DESCRIPTION=" & "(ADDRESS_LIST=(ADDRESS=(PROTOCOL=" & sProtocol & ")(HOST=" & sHost & " )(PORT=" & sPort & ")))" & "(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=" & sServiceName & ")));" & "User Id=" & sUser & "; Password=" & sPass & ";"
                Using conn As New OracleConnection(oradb)
                    Try
                        conn.Open()

                        Using cmd As New OracleCommand()
                            cmd.Connection = conn
                            cmd.CommandText = sSQL
                            cmd.CommandType = CommandType.Text
                            Using dr As OracleDataReader = cmd.ExecuteReader()

                                Do While (dr.Read())
                                    sApplicationID = dr.Item("APPLICATION_ID").ToString
                                    returnValues(1) = "The newly created application has an ApplicationID of : " & sApplicationID & " Please save this id to the data template in DataProfileID: " & sProfileID
                                    mosaicDll.Logger(senderMCPAction, "The newly created application has an ApplicationID of : " & sApplicationID & " Please save this id to the data template in DataProfileID: " & sProfileID, myLogPath, , actionHistoryRecordID)
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| The newly created application has an ApplicationID of : " & sApplicationID & " Please save this id to the data template in DataProfileID: " & sProfileID, myLogPath, , actionHistoryRecordID)
                                Loop

                            End Using
                        End Using
                    Catch ex As OracleException
                        ' catches only Oracle errors
                        Select Case ex.Number
                            Case 1
                                ' MessageBox.Show("Error attempting to insert duplicate data.")
                                Exit Select
                            Case 12545
                                MessageBox.Show("The Oracle database is unavailable.")
                                Exit Select
                            Case 904
                                returnValues(0) = executionStatusFailed
                                returnValues(1) = "Error Message: " & ex.Message
                                mosaicDll.Logger(senderMCPAction, "Actual Result|Error Message: " & ex.Message, myLogPath, , actionHistoryRecordID)
                                Exit Select

                            Case Else
                                returnValues(0) = executionStatusFailed
                                returnValues(1) = "The  Write the Application ID to Log caused and Oracle Error"
                                '  mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1", myLogPath, , actionHistoryRecordID)
                        End Select
                    Catch ex As Exception
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = "The  Write the Application ID to Log caused and Oracle Error"
                    Finally
                    End Try

                End Using

            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not click finish.", myLogPath, , actionHistoryRecordID)
            End If




        Catch ex As Exception


            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Initapp_6_Review_and_Submit_Finish = returnValues
        End Try
    End Function
    Public Function Com_Val_RecID_in_DBTbl_For_App_old(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            'Oraccle Parameters
            Dim sProtocol As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_protocol")
            Dim sHost As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_host")
            Dim sServiceName As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_service_name")
            Dim sPort As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_port")
            Dim sUser As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_User")
            Dim sPass As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_Password")
            Dim counter As Integer = 0
            Dim iAppId As String = String.Empty

            'Run parameters
            Dim sSQL As String = String.Empty
            Dim sTableName As String = mosaicDll.dt(excelPath, iteration, "dbtabl_database_tables", "table_name")

            'If sTableName.ToUpper.ToString = ("CID.Attachment").ToUpper Then
            '    Stop
            'End If
            sSQL = "SELECT CID.Application.Application_id,CID.APPLICATION.APPLICATION_NAME, CID.APPLICATION_STATUS.APPLICATION_STATUS_NAME," + sTableName + ".RECORD_TYPE_ID, CID.APPLICATION_STATUS.APPLICATION_STATUS_ID "
            sSQL = sSQL + "FROM(CID.APPLICATION) INNER JOIN CID.APPLICATION_STATUS ON CID.APPLICATION_STATUS.APPLICATION_STATUS_ID = CID.APPLICATION.APPLICATION_STATUS_ID "
            sSQL = sSQL + "RIGHT JOIN " + sTableName + " ON CID.APPLICATION.APPLICATION_ID = " + sTableName + ".APPLICATION_ID"

            Dim oradb As String = "Data Source=(DESCRIPTION=" & "(ADDRESS_LIST=(ADDRESS=(PROTOCOL=" & sProtocol & ")(HOST=" & sHost & " )(PORT=" & sPort & ")))" & "(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=" & sServiceName & ")));" & "User Id=" & sUser & "; Password=" & sPass & ";"

            Using conn As New OracleConnection(oradb)
                Try
                    conn.Open()

                    Using cmd As New OracleCommand()
                        cmd.Connection = conn

                        cmd.CommandText = sSQL

                        cmd.CommandType = CommandType.Text

                        Using dr As OracleDataReader = cmd.ExecuteReader()
                            ' Labs 1 and 2 data retrieval

                            dr.Read()


                            Do While (dr.Read())



                                iAppId = dr.Item("application_id").ToString
                                If dr.Item("record_type_id").ToString = String.Empty Then

                                    returnValues(0) = executionStatusFailed
                                    returnValues(1) = "Error | One or more records for: " & sTableName & "has invalid record ids"
                                    mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "is displaying a null value TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                    mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & " is displaying a null value TableName: " & sTableName, myLogPath, , actionHistoryRecordID)


                                Else

                                    If dr.Item("record_type_id").ToString = "1" Then

                                        'Dim myObject As String = String.Empty
                                        'myObject = irectCast(dr.Item("record_type_id").ToString()


                                        'If myObject = String.Empty Then
                                        '    returnValues(0) = executionStatusFailed
                                        '    returnValues(1) = "ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "is displaying a null value"
                                        '    mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "is displaying a null value", myLogPath, , actionHistoryRecordID)
                                        '    mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "is displaying a null value", myLogPath, , actionHistoryRecordID)
                                        'End If

                                        If CDbl(dr.Item("application_status_id").ToString) >= 130 And CDbl(dr.Item("application_status_id").ToString) <> 140 Then
                                            Dim cmd2 As New OracleCommand
                                            cmd2.Connection = conn
                                            cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=2"
                                            cmd2.CommandType = CommandType.Text
                                            Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                If dr2.HasRows Then
                                                    'returnValues(0) = executionStatusPassed
                                                    '' returnValues(1) = "ApplicationID: " & iAppId & " in status " & dr.Item("")
                                                    'mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "found record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                    'mosaicDll.Logger(senderMCPAction, "Actual Result| ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "found record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                Else
                                                    returnValues(0) = executionStatusFailed
                                                    returnValues(1) = "Error | One or more records for: " & sTableName & "has invalid record ids"

                                                    mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & " could not find record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                    mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & " could not find record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                End If
                                            End Using
                                        Else
                                            'I have a status that belongs in record_type_id = 1
                                            Dim cmd2 As New OracleCommand
                                            cmd2.Connection = conn
                                            cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=2"
                                            cmd2.CommandType = CommandType.Text
                                            Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                If dr2.HasRows Then


                                                    returnValues(0) = executionStatusFailed
                                                    returnValues(1) = "Error | One or more records for: " & sTableName & "has invalid record ids"
                                                    mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "has a record of record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error - ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "has a record of record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)

                                                Else
                                                    'returnValues(0) = executionStatusPassed
                                                    ''returnValues(1) = "ApplicationID: " & iAppId & " in status"
                                                    'mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "correct has only a record_type_id=1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                    'mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "correct has only a record_type_id=1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                End If
                                            End Using
                                        End If


                                    End If

                                    If dr.Item("record_type_id").ToString = "2" Then

                                        Dim cmd2 As New OracleCommand
                                        cmd2.Connection = conn
                                        cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=1"
                                        cmd2.CommandType = CommandType.Text
                                        Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                            If dr2.HasRows Then
                                                ' returnValues(0) = executionStatusPassed
                                                'returnValues(1) = "ApplicationID: " & iAppId & " is correctly assigned and the record_type_id=1 record was found."
                                                'mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " is correctly assigned and the record_type_id=1 record was found.", myLogPath, , actionHistoryRecordID)
                                                'mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is correctly assigned and the record_type_id=1 record was found.", myLogPath, , actionHistoryRecordID)
                                            Else
                                                returnValues(0) = executionStatusFailed
                                                returnValues(1) = "Error | One or more records for: " & sTableName & "has invalid record ids"
                                                mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "has a record_type_id = 2 but no record with record_type_id =1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                mosaicDll.Logger(senderMCPAction, "Actual Result|Error - ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "has a record_type_id = 2 but no record with record_type_id =1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                            End If
                                        End Using

                                    Else
                                        'returnValues(0) = executionStatusFailed
                                        'returnValues(1) = "ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1"
                                        'mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1", myLogPath, , actionHistoryRecordID)

                                    End If

                                    If dr.Item("record_type_id").ToString = "3" Then

                                        'Dim cmd2 As New OracleCommand
                                        'cmd2.Connection = conn
                                        'cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=1"
                                        'cmd2.CommandType = CommandType.Text
                                        'Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                        '    If dr2.HasRows Then
                                        '        ' returnValues(0) = executionStatusPassed
                                        '        'returnValues(1) = "ApplicationID: " & iAppId & " is correctly assigned and the record_type_id=1 record was found."
                                        '        'mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " is correctly assigned and the record_type_id=1 record was found.", myLogPath, , actionHistoryRecordID)
                                        '        'mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is correctly assigned and the record_type_id=1 record was found.", myLogPath, , actionHistoryRecordID)
                                        '    Else
                                        '        returnValues(0) = executionStatusFailed
                                        '        returnValues(1) = "Error | One or more records for: " & sTableName & "has invalid record ids"
                                        '        mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "has a record_type_id = 2 but no record with record_type_id =1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                        '        mosaicDll.Logger(senderMCPAction, "Actual Result|Error - ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & "has a record_type_id = 2 but no record with record_type_id =1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                        '    End If
                                        'End Using

                                    Else
                                        'returnValues(0) = executionStatusFailed
                                        'returnValues(1) = "ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1"
                                        'mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1", myLogPath, , actionHistoryRecordID)

                                    End If
                                End If

                            Loop

                        End Using
                    End Using
                Catch ex As OracleException
                    ' catches only Oracle errors
                    Select Case ex.Number
                        Case 1
                            ' MessageBox.Show("Error attempting to insert duplicate data.")
                            Exit Select

                        Case 12545
                            'MessageBox.Show("The database is unavailable.")
                            Exit Select
                        Case 904
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = "Error Message: " & ex.Message
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Error Message: " & ex.Message, myLogPath, , actionHistoryRecordID)
                            Exit Select
                        Case Else
                            'MsgBox(iAppId.ToString)
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = "Error" & ex.Message
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Error" & ex.Message, myLogPath, , actionHistoryRecordID)
                    End Select
                Catch ex As Exception
                    returnValues(0) = executionStatusFailed
                    ' returnValues(1) = "ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1"
                    ' mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1", myLogPath, , actionHistoryRecordID)
                Finally
                End Try
            End Using



        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Com_Val_RecID_in_DBTbl_For_App_old = returnValues
        End Try
    End Function
    Public Function Com_Val_RecID_in_DBTbl_For_App(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Dim isPassed As Boolean = True
        Try
            'Oraccle Parameters
            Dim sProtocol As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_protocol")
            Dim sHost As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_host")
            Dim sServiceName As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_service_name")
            Dim sPort As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_port")
            Dim sUser As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_User")
            Dim sPass As String = mosaicDll.dt(excelPath, iteration, "url_web_address_environ", "ora_Password")
            Dim counter As Integer = 0
            Dim bCanHave3RecID As Boolean = False
            Dim msgFlag As Boolean = False

            'Run parameters
            Dim sSQL As String = String.Empty
            Dim sTableName As String = mosaicDll.dt(excelPath, iteration, "dbtabl_database_tables", "table_name")
            Dim sCanHaveRecThreeRecID As String = mosaicDll.dt(excelPath, iteration, "dbtabl_database_tables", "can_have_three_rec_id")
            If sCanHaveRecThreeRecID.ToString.ToLower.Trim() = "x" Then
                bCanHave3RecID = True
            End If

            If Not sTableName.ToUpper.ToString = ("CID.condition_exception").ToUpper Then
                sSQL = "SELECT CID.Application.Application_id,CID.APPLICATION.APPLICATION_NAME, CID.APPLICATION_STATUS.APPLICATION_STATUS_NAME," + sTableName + ".RECORD_TYPE_ID, CID.APPLICATION_STATUS.APPLICATION_STATUS_ID "
                sSQL = sSQL + "FROM(CID.APPLICATION) INNER JOIN CID.APPLICATION_STATUS ON CID.APPLICATION_STATUS.APPLICATION_STATUS_ID = CID.APPLICATION.APPLICATION_STATUS_ID "
                sSQL = sSQL + "RIGHT JOIN " + sTableName + " ON CID.APPLICATION.APPLICATION_ID = " + sTableName + ".APPLICATION_ID"

            Else
                sSQL = "SELECT CID.Application.Application_id,CID.APPLICATION.APPLICATION_NAME, CID.APPLICATION_STATUS.APPLICATION_STATUS_NAME," + sTableName + ".RECORD_TYPE_ID, CID.APPLICATION_STATUS.APPLICATION_STATUS_ID, CID.condition_exception.cond_exc_status_id "
                sSQL = sSQL + "FROM(CID.APPLICATION) INNER JOIN CID.APPLICATION_STATUS ON CID.APPLICATION_STATUS.APPLICATION_STATUS_ID = CID.APPLICATION.APPLICATION_STATUS_ID "
                sSQL = sSQL + "RIGHT JOIN " + sTableName + " ON CID.APPLICATION.APPLICATION_ID = " + sTableName + ".APPLICATION_ID"
            End If


            Dim oradb As String = "Data Source=(DESCRIPTION=" & "(ADDRESS_LIST=(ADDRESS=(PROTOCOL=" & sProtocol & ")(HOST=" & sHost & " )(PORT=" & sPort & ")))" & "(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=" & sServiceName & ")));" & "User Id=" & sUser & "; Password=" & sPass & ";"


            'If sTableName = "CID.fin_feasibility" Then
            '    Stop
            'End If

            Using conn As New OracleConnection(oradb)
                Try
                    conn.Open()

                    Using cmd As New OracleCommand()
                        cmd.Connection = conn

                        cmd.CommandText = sSQL

                        cmd.CommandType = CommandType.Text

                        Using dr As OracleDataReader = cmd.ExecuteReader()
                            ' Labs 1 and 2 data retrieval

                            dr.Read()


                            Do While (dr.Read())

                                Dim iAppId As String = dr.Item("application_id").ToString

                                'If iAppId = "3230" And sTableName = "CID.fin_feasibility" Then
                                '    Stop
                                'End If

                                If dr.Item("record_type_id").ToString = String.Empty Then
                                    If sTableName.ToUpper = "CID.Attachment".ToUpper Then
                                        GoTo NextRecord
                                    End If
                                    isPassed = False
                                    returnValues(0) = executionStatusFailed
                                    returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record ids"
                                    mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " is displaying a null value TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                ElseIf dr.Item("record_type_id").ToString() <> "1" AndAlso dr.Item("record_type_id").ToString() <> "2" AndAlso dr.Item("record_type_id").ToString() <> "3" Then
                                    isPassed = False
                                    returnValues(0) = executionStatusFailed
                                    returnValues(1) = "Error | Unknown record_type_id was found for application id " & iAppId
                                    mosaicDll.Logger(senderMCPAction, "Error | Unknown record_type_id was found for application id " & iAppId, myLogPath, , actionHistoryRecordID)

                                Else
                                    If dr.Item("record_type_id").ToString = "1" Then

                                        If sTableName.ToUpper.ToString = ("CID.condition_exception").ToUpper Then

                                            If Not IsDBNull(dr.Item("cond_exc_status_id")) Then
                                                If CDbl(dr.Item("cond_exc_status_id")) >= 21 And CDbl(dr.Item("cond_exc_status_id")) <= 22 Then
                                                    GoTo normalProcesing
                                                Else
                                                    GoTo NextRecord
                                                End If
                                            Else
                                                GoTo NextRecord
                                            End If

                                        Else
                                            'other table
                                        End If

normalProcesing:
                                        Select Case CDbl(dr.Item("application_status_id").ToString())
                                            Case Is < 130, Is = 140
                                                Dim cmd2 As New OracleCommand
                                                cmd2.Connection = conn
                                                cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=2"
                                                cmd2.CommandType = CommandType.Text
                                                Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                    If dr2.HasRows Then
                                                        isPassed = False
                                                        returnValues(0) = executionStatusFailed
                                                        returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record_type_ids"
                                                        mosaicDll.Logger(senderMCPAction, "Error |For application with status: " & dr.Item("application_status_id").ToString() & "Table name: " & sTableName & " has invalid recordtype_id=2 ", myLogPath, , actionHistoryRecordID)
                                                    Else
                                                        'Passed
                                                    End If
                                                End Using

                                                'cmd2 = Nothing
                                                cmd2.Connection = conn
                                                cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=3"
                                                cmd2.CommandType = CommandType.Text
                                                Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                    If dr2.HasRows Then
                                                        isPassed = False
                                                        returnValues(0) = executionStatusFailed
                                                        returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record_type_ids"
                                                        mosaicDll.Logger(senderMCPAction, "Error |For application with status: " & dr.Item("application_status_id").ToString() & "Table name: " & sTableName & " has invalid record_type_id=3", myLogPath, , actionHistoryRecordID)
                                                    Else
                                                        'passed
                                                    End If
                                                End Using



                                            Case Is = 130
                                                '
                                                ' Case Is >= 130, Is <> 140, Is < 150
                                                Dim cmd2 As New OracleCommand
                                                cmd2.Connection = conn
                                                cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=2"
                                                cmd2.CommandType = CommandType.Text
                                                Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                    If dr2.HasRows Then
                                                        'executionStatusPassed

                                                    Else
                                                        isPassed = False
                                                        returnValues(0) = executionStatusFailed
                                                        returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record_type_ids"
                                                        mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " could not find record_type_id=2  TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                    End If
                                                End Using

                                                'cmd2 = Nothing
                                                cmd2.Connection = conn
                                                cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=3"
                                                cmd2.CommandType = CommandType.Text
                                                Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                    If dr2.HasRows Then


                                                        isPassed = False
                                                        returnValues(0) = executionStatusFailed
                                                        returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record_type_ids"
                                                        mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " found record_type_id=3 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                    Else

                                                    End If
                                                End Using
                                            Case Is >= 160
                                                Dim cmd2 As New OracleCommand
                                                cmd2.Connection = conn
                                                cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=2"
                                                cmd2.CommandType = CommandType.Text
                                                Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                    If dr2.HasRows Then
                                                        'executionStatusPassed
                                                    Else
                                                        isPassed = False
                                                        returnValues(0) = executionStatusFailed
                                                        returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record_type_ids"
                                                        mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " could not find record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                    End If
                                                End Using



                                                If bCanHave3RecID = True Then

                                                    cmd2.Connection = conn
                                                    cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=3"
                                                    cmd2.CommandType = CommandType.Text
                                                    Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                                        If dr2.HasRows Then
                                                            'ExecutionStatusPassed
                                                            isPassed = False
                                                            msgFlag = True
                                                            'returnValues(0) = executionStatusFailed
                                                            'returnValues(1) = "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " has records with record_type_id=3.TableName:" & sTableName
                                                            mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " has records with record_type_id=3.TableName:" & sTableName, myLogPath, , actionHistoryRecordID)
                                                        Else
                                                            isPassed = False
                                                            msgFlag = True
                                                            'returnValues(0) = executionStatusFailed
                                                            'returnValues(1) = "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " no record_type_id=3 was found. TableName:" & sTableName
                                                            mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " no record_type_id=3 was found. TableName:" & sTableName, myLogPath, , actionHistoryRecordID)
                                                        End If
                                                    End Using
                                                Else
                                                    'skip looing for rec id 3

                                                End If


                                            Case 150
                                                'special
                                                Dim cmd2 As New OracleCommand
                                                Dim cmd3 As New OracleCommand
                                                Dim iComplete As Integer = 0

                                                Dim sMessage As String = " - While viewing " & iAppId & " and status of 150 "
                                                cmd2.Connection = conn
                                                cmd2.CommandText = "select * from cid.disb_request where application_id =" & dr.Item("Application_id").ToString
                                                cmd2.CommandType = CommandType.Text
                                                Using dr2 As OracleDataReader = cmd2.ExecuteReader()


                                                    If dr2.HasRows Then
                                                        'has disbursements
                                                        'cmd3 = Nothing
                                                        cmd3.Connection = conn
                                                        cmd3.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=2"
                                                        cmd3.CommandType = CommandType.Text
                                                        Using dr3 As OracleDataReader = cmd3.ExecuteReader()
                                                            If dr3.HasRows Then
                                                                iComplete = iComplete + 1
                                                            Else
                                                                sMessage = sMessage & " could not find record with record_type_id=2 "
                                                            End If
                                                        End Using


                                                        'cmd3 = Nothing
                                                        If bCanHave3RecID = True Then


                                                            cmd3.Connection = conn
                                                            cmd3.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=3"
                                                            cmd3.CommandType = CommandType.Text
                                                            Using dr3 As OracleDataReader = cmd3.ExecuteReader()
                                                                If dr3.HasRows Then
                                                                    'iComplete = iComplete + 1
                                                                    sMessage = sMessage & " Application ID : " & dr.Item("Application_id").ToString() & " in status " & dr.Item("application_status_id").ToString() & " with disbursements has records with record_type_id=3 TableName: " & sTableName
                                                                Else
                                                                    'iComplete = iComplete + 1
                                                                    sMessage = sMessage & " Application ID : " & dr.Item("Application_id").ToString() & " in status " & dr.Item("application_status_id").ToString() & " with disbursements no records found with record_type_id=3 " & sTableName
                                                                    ' sMessage = sMessage & " could not find record with record_type_id=3 "
                                                                End If
                                                            End Using
                                                            '    isPassed = False
                                                            '    returnValues(0) = executionStatusFailed
                                                            'returnValues(1) = sMessage
                                                            mosaicDll.Logger(senderMCPAction, sMessage, myLogPath, , actionHistoryRecordID)
                                                        End If


                                                        If iComplete = 1 Then
                                                            'success
                                                        Else
                                                            isPassed = False
                                                            returnValues(0) = executionStatusFailed
                                                            returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record_type_ids"
                                                            mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " with disbursements in status " & dr.Item("application_status_id").ToString() & "in Table: " & sTableName & sMessage, myLogPath, , actionHistoryRecordID)
                                                        End If
                                                    Else
                                                        'no disbursement rows
                                                        iComplete = 0

                                                        cmd3.Connection = conn
                                                        cmd3.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=2"
                                                        cmd3.CommandType = CommandType.Text
                                                        Using dr3 As OracleDataReader = cmd3.ExecuteReader()
                                                            If dr3.HasRows Then
                                                                iComplete = iComplete + 1
                                                            Else
                                                                sMessage = sMessage & " could not find record type 2 "
                                                            End If
                                                        End Using
                                                        'cmd3 = Nothing
                                                        cmd3.Connection = conn
                                                        cmd3.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=3"
                                                        cmd3.CommandType = CommandType.Text
                                                        Using dr3 As OracleDataReader = cmd3.ExecuteReader()
                                                            If dr3.HasRows Then
                                                                'iComplete = iComplete + 1
                                                                sMessage = sMessage & " found record with record_type_id=3 "
                                                            End If
                                                        End Using

                                                        If iComplete = 1 Then
                                                            'success
                                                        Else
                                                            isPassed = False
                                                            returnValues(0) = executionStatusFailed
                                                            returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record id type =2 "
                                                            mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " without disbursements in status " & dr.Item("application_status_id").ToString() & "in Table: " & sTableName & sMessage, myLogPath, , actionHistoryRecordID)
                                                            ' mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " in status" & dr.Item("application_status_id").ToString() & " could not find record_type_id = 2 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                                        End If
                                                    End If

                                                End Using




                                        End Select

                                    End If

                                End If

TypeTwoCheck:

                                If dr.Item("record_type_id").ToString = "2" Then


                                    If sTableName = "CID.condition.exception" Then
                                        If dr.Item("cond_exc_status_id").ToString() <> "21" AndAlso dr.Item("cond_exc_status_id").ToString() <> "22" Then
                                            isPassed = False
                                            returnValues(0) = executionStatusFailed
                                            returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record_type_ids"
                                            mosaicDll.Logger(senderMCPAction, "ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & " found record_type_id=2 for cond_exc_status_id: " & "put in field name" & sTableName, myLogPath, , actionHistoryRecordID)
                                        End If
                                    End If

                                    'if table name 
                                    Dim cmd2 As New OracleCommand
                                    cmd2.Connection = conn
                                    cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=1"
                                    cmd2.CommandType = CommandType.Text
                                    Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                        If dr2.HasRows Then
                                            'Execution Passed
                                        Else
                                            returnValues(0) = executionStatusFailed
                                            returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record ids"
                                            mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & "has a record_type_id = 2 but no record with record_type_id =1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                        End If
                                    End Using


                                End If


                                If dr.Item("record_type_id").ToString = "3" Then
                                    Dim iType3Rows As Integer = 0

                                    Dim cmd2 As New OracleCommand
                                    cmd2.Connection = conn
                                    cmd2.CommandText = "Select * from " & sTableName & " where " & sTableName & ".application_id=" & dr.Item("Application_id").ToString & " and record_type_id=1"
                                    cmd2.CommandType = CommandType.Text
                                    Using dr2 As OracleDataReader = cmd2.ExecuteReader()
                                        If dr2.HasRows Then
                                            iType3Rows = iType3Rows + 1
                                            'executionStatusPassed()
                                        Else
                                            returnValues(0) = executionStatusFailed
                                            returnValues(1) = "Error | One or more records for: " & sTableName & " has invalid record ids"
                                            mosaicDll.Logger(senderMCPAction, "Error | ApplicationID: " & iAppId & " in status " & dr.Item("application_status_id").ToString() & "has a record_type_id = 3 but no record with record_type_id =1 TableName: " & sTableName, myLogPath, , actionHistoryRecordID)
                                        End If
                                    End Using

                                End If

NextRecord:
                            Loop

                        End Using
                    End Using
                Catch ex As OracleException
                    ' catches only Oracle errors
                    Select Case ex.Number
                        Case 1
                            ' MessageBox.Show("Error attempting to insert duplicate data.")
                            Exit Select
                        Case 12545
                            'MessageBox.Show("The database is unavailable.")
                            Exit Select
                        Case 904
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = "Error Message: " & ex.Message
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Error Message: " & ex.Message, myLogPath, , actionHistoryRecordID)
                            Exit Select
                        Case Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = "Oracle Error"
                            '  mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1", myLogPath, , actionHistoryRecordID)
                    End Select
                Catch ex As Exception
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Oracle Error"
                    ' mosaicDll.Logger(senderMCPAction, "Actual Result|ApplicationID: " & iAppId & " is incorrectly assigned. It has a status which is for record_type_id=1", myLogPath, , actionHistoryRecordID)
                Finally
                End Try
            End Using
            If Not isPassed Then
                If bCanHave3RecID = True Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result |  Tablename: " & sTableName & " See log to Check if Existence of Record ID 3 Status is Correct ", myLogPath, , actionHistoryRecordID)
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result | One more records have invalid or missing record_type_ids for Tablename: " & sTableName & " See Log", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result | All records have valid record_type_ids for :" & sTableName, myLogPath, , actionHistoryRecordID)

            End If

            If msgFlag = True Then
                Dim sNewMessage As String = " Tablename: " & sTableName & " - See log to Check if Existence of Record ID 3 Status is Correct "
                Dim newMessage As String = returnValues(1).ToString() & sNewMessage

                returnValues(1) = newMessage
            End If


        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Com_Val_RecID_in_DBTbl_For_App = returnValues
        End Try
    End Function
    Public Function Com_Click_App_Area_From_Ext_Home_Access_Window(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Dim sApplicationID As String = String.Empty
        Dim iAreasFound As Integer = 0



        Try


            Dim sAppArea As String = mosaicDll.dt(excelPath, iteration, "apparea_application_areas", "app_area")
            Dim sResultWindow As String = mosaicDll.dt(excelPath, iteration, "apparea_application_areas", "Resulting_ExAHP_Window")
            Dim sResultArea As String = mosaicDll.dt(excelPath, iteration, "apparea_application_areas", "resulting_tab")

            'Full path to table
            '/html/body/div[4]/form/div[2]/div[2]/div[1]/div/div/table[2]/tbody/tr[2]/td[1]/a/span
            If sAppArea.ToUpper = "N/A" Then
                GoTo ExitApp
            End If

            Dim iAppsFound As Integer = 0

            Dim prefixOptionXPath As String = "/html/body/div[4]/form/div[2]/div[2]/div[1]/div/div/table[2]/tbody/tr["
            Dim suffixOptionPath As String = "]/td[1]/a/span"
            Dim table_element As IWebElement = Nothing

            'this table is a list of organizatios to select from found after search is clicked
            'Dim oTable As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:sectionTable"))
            'If Not oTable Is Nothing Then
            '    table_element = DirectCast(oTable, IWebElement)
            '    returnValues(1) = "Located the table containing list of areas."
            '    mosaicDll.Logger(senderMCPAction, "Located the the table containing the list of areas.", myLogPath, , actionHistoryRecordID)
            'Else
            '    returnValues(0) = executionStatusFailedAbort
            '    returnValues(1) = "Could not locate the areas table:"
            '    mosaicDll.Logger(senderMCPAction, "Could not locate the areas table.", myLogPath, , actionHistoryRecordID)
            '    CaptureScreenshot(actionHistoryRecordID)
            '    GoTo ExitApp

            'End If

            Dim TopLevelMenu As IWebElement = driver.FindElement(By.XPath("//a[contains(>" & "Products" & "<"))
            If Not TopLevelMenu Is Nothing Then
                iAreasFound = iAreasFound + 1
                TopLevelMenu.Click()
            End If

            'Dim tr_collection As IList(Of IWebElement) = table_element.FindElements(By.XPath("id('pageTemplateForm:sectionTable')/tbody/tr"))
            'Dim done As Boolean = False

            'Dim row_num As Integer = 0
            'Dim col_num As Integer = 0

            'row_num = 1

            ''Set the organization
            'For Each trElement As IWebElement In tr_collection

            '    Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
            '    col_num = 1

            '    For Each tdElement As IWebElement In td_collection
            '        col_num = col_num + 1
            '        If tdElement.Text.ToUpper.ToString() = sAppArea.ToUpper.ToString() Then
            '            Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '            Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '            If Not oOption Is Nothing Then
            '                Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                oElement.Click()
            '                mosaicDll.Logger(senderMCPAction, "Selected the application area: " & sAppArea.ToString(), myLogPath, , actionHistoryRecordID)
            '                mosaicDll.Logger(senderMCPAction, "Actual Result | Selected the application area: " & sAppArea.ToString(), myLogPath, , actionHistoryRecordID)
            '                iAreasFound = iAreasFound + 1
            '                done = True
            '                Exit For
            '            End If
            '        End If
            '    Next

            '    If done = True Then
            '        Exit For
            '    End If
            '    row_num = row_num + 1
            'Next

            If iAreasFound = 0 Then
                returnValues(0) = executionStatusFailedAbort
                'returnValues(1) = " Could not find the application area: " & sAppArea.ToString()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not find the application area: " & sAppArea.ToString(), myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Dim sPageValidationObject As Object = Nothing
            sPageValidationObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[1]/table/tbody/tr/td[1]/div/h1"))
            If Not sPageValidationObject Is Nothing Then
                Dim sValElement As IWebElement = DirectCast(sPageValidationObject, IWebElement)
                If Not sValElement.Text.ToUpper.ToString() = sResultWindow.ToUpper.ToString() Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not find the result window: " & sResultWindow.ToString(), myLogPath, , actionHistoryRecordID)
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = " Could not find the result window:: " & sResultWindow.ToString()
                    CaptureScreenshot(actionHistoryRecordID)
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Navigated to window: " & sResultWindow.ToString(), myLogPath, , actionHistoryRecordID)
                    returnValues(1) = "Navigated to window: " & sResultWindow.ToString()
                End If
            End If


ExitApp:


        Catch ex As Exception

            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Com_Click_App_Area_From_Ext_Home_Access_Window = returnValues
        End Try
    End Function
    Public Function Com_Click_Appl_Nbr_to_Access_App(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        ' Dim sApplicationID As String = String.Empty


        Try

            'Full path to table
            '/html/body/div[3]/form/div[2]/div[1]/div/table/tbody/tr[8]/td[1]/a/span

            Dim sAppNumber As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "appl_nbr")
            Dim iAppsFound As Integer = 0

            Dim prefixOptionXPath As String = "/html/body/div[3]/form/div[2]/div[1]/div/table/tbody/tr["
            Dim suffixOptionPath As String = "]/td[1]/a/span"
            Dim table_element As IWebElement = Nothing

            'this table is a list of organizatios to select from found after search is clicked
            'Dim oTable As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:roundTable"))
            'If Not oTable Is Nothing Then
            '    table_element = DirectCast(oTable, IWebElement)
            '    returnValues(1) = "Located the table containing list of applications."
            '    mosaicDll.Logger(senderMCPAction, "Located the table containing list of applications.", myLogPath, , actionHistoryRecordID)
            'Else
            '    returnValues(0) = executionStatusFailedAbort
            '    returnValues(1) = "Could not locate the table containing the list of applications."
            '    mosaicDll.Logger(senderMCPAction, "Could not locate the table containing the list of applications.", myLogPath, , actionHistoryRecordID)
            '    CaptureScreenshot(actionHistoryRecordID)
            '    GoTo Endproc
            'End If


            'faster than commented code
            Dim AppNumberMenu As IWebElement = driver.FindElement(By.XPath("//a[contains(.,'" & sAppNumber & "')]"))
            If Not AppNumberMenu Is Nothing Then
                iAppsFound = iAppsFound + 1
                AppNumberMenu.Click()
            End If

            '//td[@id='pageTemplateForm:roundTable:0:j_id109:0:j_id110']
            'Dim tr_collection As IList(Of IWebElement) = table_element.FindElements(By.XPath("id('pageTemplateForm:roundTable')/tbody/tr"))
            'Dim done As Boolean = False

            'Dim row_num As Integer = 0
            'Dim col_num As Integer = 0

            'row_num = 1

            ''Set the organization
            'For Each trElement As IWebElement In tr_collection

            '    Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
            '    col_num = 1

            '    For Each tdElement As IWebElement In td_collection
            '        col_num = col_num + 1
            '        If tdElement.Text.ToUpper.ToString() = sAppNumber.ToUpper.ToString() Then
            '            Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '            Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '            If Not oOption Is Nothing Then
            '                Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                oElement.Click()
            '                mosaicDll.Logger(senderMCPAction, "Selected the application with id: " & sAppNumber.ToString(), myLogPath, , actionHistoryRecordID)
            '                mosaicDll.Logger(senderMCPAction, "Actual Result | Selected the application with id: " & sAppNumber.ToString(), myLogPath, , actionHistoryRecordID)
            '                iAppsFound = iAppsFound + 1
            '                done = True
            '                Exit For
            '            End If
            '        End If
            '    Next

            '    If done = True Then
            '        Exit For
            '    End If
            '    row_num = row_num + 1
            'Next

            If iAppsFound = 0 Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not find the application with id: " & sAppNumber.ToString(), myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = " Could not locate the application with id: " & sAppNumber.ToString()
                CaptureScreenshot(actionHistoryRecordID)
            End If

Endproc:
        Catch ex As Exception

            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Com_Click_Appl_Nbr_to_Access_App = returnValues
        End Try
    End Function
    Public Function Com_Click_Browse_EnterFileName_Select(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        ' Dim sApplicationID As String = String.Empty


        Try


            'Full path to table
            '/html/body/div[3]/form/div[2]/div[1]/div/table/tbody/tr[8]/td[1]/a/span

            Dim sAppNumber As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "appl_nbr")
            Dim iAppsFound As Integer = 0

            Dim prefixOptionXPath As String = "/html/body/div[3]/form/div[2]/div[1]/div/table/tbody/tr["
            Dim suffixOptionPath As String = "]/td[1]/a/span"
            Dim table_element As IWebElement = Nothing

            'this table is a list of organizatios to select from found after search is clicked
            Dim oTable As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:roundTable"))
            If Not oTable Is Nothing Then
                table_element = DirectCast(oTable, IWebElement)
                returnValues(1) = "Located the table containing list of applications."
                mosaicDll.Logger(senderMCPAction, "Located the table containing list of applications.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not locate the table containing the list of applications."
                mosaicDll.Logger(senderMCPAction, "Could not locate the table containing the list of applications.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            '//td[@id='pageTemplateForm:roundTable:0:j_id109:0:j_id110']
            Dim tr_collection As IList(Of IWebElement) = table_element.FindElements(By.XPath("id('pageTemplateForm:roundTable')/tbody/tr"))
            Dim done As Boolean = False

            Dim row_num As Integer = 0
            Dim col_num As Integer = 0

            row_num = 1

            'Set the organization
            For Each trElement As IWebElement In tr_collection

                Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
                col_num = 1

                For Each tdElement As IWebElement In td_collection
                    col_num = col_num + 1
                    If tdElement.Text.ToUpper.ToString() = sAppNumber.ToUpper.ToString() Then
                        Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
                        Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                        If Not oOption Is Nothing Then
                            Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
                            oElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Selected the application with id: " & sAppNumber.ToString(), myLogPath, , actionHistoryRecordID)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Selected the application with id: " & sAppNumber.ToString(), myLogPath, , actionHistoryRecordID)
                            iAppsFound = iAppsFound + 1
                            done = True
                            Exit For
                        End If
                    End If
                Next

                If done = True Then
                    Exit For
                End If
                row_num = row_num + 1
            Next

            If iAppsFound = 0 Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not find the application with id: " & sAppNumber.ToString(), myLogPath, , actionHistoryRecordID)
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = " Could not locate the application with id:" & sAppNumber.ToString()
                CaptureScreenshot(actionHistoryRecordID)
            End If


        Catch ex As Exception


            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Com_Click_Browse_EnterFileName_Select = returnValues
        End Try
    End Function
    Public Function Gen1_Val_Enter_Application_Information_and_Save_Clk_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Dim sXpath As String = String.Empty
        Dim This_Element As IWebElement = Nothing
        Dim thisObject As Object = Nothing

        Try

            'Start by clearing the project text area

            'thisObject = WaitForElement(driver, WaitForTime, By.XPath("//textarea[@id='applicationDescription']"))
            'If Not thisObject Is Nothing Then
            '    This_Element = DirectCast(thisObject, IWebElement)
            '    'This_Element.Clear()
            '    This_Element.SendKeys(Keys.Control + "Aa
            '    This_Element.SendKeys(Keys.Delete)
            'End If




            Dim sProjectName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Name")
            Dim sProjectType As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Type")

            'for Project Type Home Ownership
            Dim lstActivities As New List(Of String)

            lstActivities.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type1"))
            lstActivities.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type2"))
            lstActivities.Add(mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Activity_Type3"))


            Dim sServeElderly As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Serve_Elderly?")
            Dim sSROUnitsAvailable As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "SRO_Units_Avail?")
            Dim sFedGovPropUsed As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Fed_Gov_Prop_Used?")
            Dim sHudOwnedPropUsed As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Hud_Owned_Prop_Used?")
            Dim sMixedUse As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Mixed_Use")
            Dim sMultiFamilyStructure As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Multi-Family_Structure")
            Dim sSingleFamilyStructure As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Single_Family_Structure")
            Dim sProjectDescription As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Description")

            Dim sProjectTypeFromIE As String = String.Empty

            'Validate Project Name
            Dim oProjectName As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='applicationName']"))
            If Not oProjectName Is Nothing Then
                Dim oProjectName_element As IWebElement = DirectCast(oProjectName, IWebElement)
                If Not oProjectName_element.GetAttribute("value") = sProjectName.Trim Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Project name did not match the name supplied in the data template: " & sProjectName
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Project name did not match the name supplied in the data template: " & sProjectName, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                Else
                    ' We matched this part test OK
                End If
                returnValues(1) = "Project name matched correctly"
                mosaicDll.Logger(senderMCPAction, "Project name matched correctly", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not locate the project name element."
                mosaicDll.Logger(senderMCPAction, "Could not locate the project name element.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            'Validate Project Type
            Dim oProjectType As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[2]/td/table/tbody/tr[3]/td/table/tbody/tr/td[2]/span"))
            If Not oProjectType Is Nothing Then
                Dim sProjectType_element As IWebElement = DirectCast(oProjectType, IWebElement)
                sProjectTypeFromIE = sProjectType_element.Text.ToUpper
                If Not sProjectTypeFromIE = sProjectType.ToUpper Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = "Project type did not match the name supplied in the data template: " & sProjectType
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Project type did not match the name supplied in the data template: " & sProjectType, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                Else
                    returnValues(1) = "Project type was matched correctly"
                    mosaicDll.Logger(senderMCPAction, "Project type was matched correctly", myLogPath, , actionHistoryRecordID)
                End If

            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Could not locate the project type element."
                mosaicDll.Logger(senderMCPAction, "Could not locate the project type element.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If



            'Check for project type home ownership if found see if drive types are displayed and validate
            'Dim bDriverType As Boolean = False
            'If sProjectTypeFromIE.ToUpper.ToString = "HOME OWNERSHIP" Then
            '    Dim oDriverType As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[2]/td/table/tbody/tr[6]/td/table/tbody/tr/td[1]/div/label"))
            '    If Not oDriverType Is Nothing Then
            '        Dim DriverType_Element As IWebElement = DirectCast(oDriverType, IWebElement)
            '        If Not DriverType_Element.GetAttribute("value").ToUpper = "HOME OWNERSHIP" Then
            '            returnValues(0) = executionStatusFailed
            '            mosaicDll.Logger(senderMCPAction, "Driver type was not home ownership.", myLogPath, , actionHistoryRecordID)
            '            CaptureScreenshot(actionHistoryRecordID)
            '        Else
            '            bDriverType = True
            '        End If
            '    Else
            '        returnValues(0) = executionStatusFailed
            '        returnValues(1) = "Could not locate the driver type element"
            '        mosaicDll.Logger(senderMCPAction, "Could not locate the driver type element", myLogPath, , actionHistoryRecordID)
            '        CaptureScreenshot(actionHistoryRecordID)
            '    End If
            'End If

            ''match the activity types if necessary
            'Dim prefixOptionXPath As String = String.Empty
            'Dim suffixOptionPath As String = String.Empty
            'Dim counter As Integer = 0


            ''Path to table holding the activities for the driver type
            ''/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[2]/td/table/tbody/tr[6]/td/table/tbody/tr/td[2]/span
            'prefixOptionXPath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[2]/td/table/tbody/tr[6]/td/table/tbody/tr["
            'suffixOptionPath = "]/td[1]/table/tbody/tr/td/label/input"


            'If bDriverType = True Then
            '    prefixOptionXPath = "/html/body/div[3]/form/div[2]/div/table/tbody/tr/td[1]/table/tbody/tr[1]/td/div/div/div/div/table/tbody/tr["
            '    suffixOptionPath = "]/td[2]/span"
            'End If




            ''table_element = driver.FindElement(By.Id("pageTemplateForm:inputOrgorgSerachDT"))
            'Dim oTable2 As Object = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:inputOrgorgSerachDT"))
            'If Not oTable2 Is Nothing Then
            '    table_element = DirectCast(oTable2, IWebElement)
            '    returnValues(1) = "Found the second organization table for:" & sOrgName
            '    mosaicDll.Logger(senderMCPAction, "Actual Result|Found the second organization for:" & sOrgName, myLogPath, , actionHistoryRecordID)
            'Else
            '    returnValues(0) = executionStatusFailed
            '    returnValues(1) = "Did not find the second organization for:" & sOrgName
            '    mosaicDll.Logger(senderMCPAction, "Actual Result|Search returned no results for the second organization: " & sOrgName, myLogPath, , actionHistoryRecordID)
            '    CaptureScreenshot(actionHistoryRecordID)
            '    GoTo Thirdset
            'End If

            'tr_collection = table_element.FindElements(By.XPath("id('pageTemplateForm:inputOrgorgSerachDT')/tbody/tr"))

            'Dim bDone As Boolean = False

            'row_num = 0
            'col_num = 0

            'row_num = 1

            'For Each trElement As IWebElement In tr_collection

            '    Dim td_collection As IList(Of IWebElement) = trElement.FindElements(By.XPath("td"))
            '    col_num = 1

            '    For Each tdElement As IWebElement In td_collection
            '        col_num = col_num + 1
            '        If tdElement.Text.ToUpper.ToString() = sOrgName.ToUpper.ToString() Then
            '            Dim sXPath As String = prefixOptionXPath & row_num.ToString() & suffixOptionPath
            '            Dim oOption As Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            '            If Not oOption Is Nothing Then
            '                Dim oElement As IWebElement = DirectCast(oOption, IWebElement)
            '                oElement.Click()
            '                mosaicDll.Logger(senderMCPAction, "Actual Result | Set the second organization to:" & sOrgName, myLogPath, , actionHistoryRecordID)
            '                iSecodOrgFound = iSecodOrgFound + 1
            '                done = True
            '                Exit For
            '            End If
            '        End If
            '    Next

            '    If done = True Then
            '        Exit For
            '    End If
            '    row_num = row_num + 1
            'Next

            'If iSecodOrgFound = 0 Then
            '    mosaicDll.Logger(senderMCPAction, "Actual Result | Count not find the second organization:" & sOrgName, myLogPath, , actionHistoryRecordID)
            '    returnValues(0) = executionStatusFailed
            '    returnValues(1) = "Could not find the second organization: " & sOrgName & " in results."
            '    CaptureScreenshot(actionHistoryRecordID)
            '    GoTo Thirdset
            'End If


            'Project Description
            If Not String.IsNullOrEmpty(sProjectDescription) Then
                System.Windows.Forms.Clipboard.Clear()

                Dim sRetVal As String = GetWordText(sProjectDescription)
                If sRetVal.ToUpper = "FILE NOT FOUND" Then
                    sXpath = "//textarea[@id='applicationDescription']"
                    thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not thisObject Is Nothing Then
                        This_Element = DirectCast(thisObject, IWebElement)
                        This_Element.SendKeys(Keys.Control + "a")
                        This_Element.SendKeys(Keys.Delete)
                        This_Element.SendKeys(sProjectDescription)

                    End If
                ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                    sXpath = "//textarea[@id='applicationDescription']"
                    thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not thisObject Is Nothing Then
                        This_Element = DirectCast(thisObject, IWebElement)
                        This_Element.SendKeys(Keys.Control + "a")
                        This_Element.SendKeys(Keys.Delete)

                        Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                        'This_Element.SendKeys(myClipboardTest)
                        This_Element.SendKeys(Keys.Control + "v")
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No project description was entered: Processing Continued. ", myLogPath, , actionHistoryRecordID)
            End If

            'Elderly
            If Not String.IsNullOrEmpty(sServeElderly) Then
                If sServeElderly.ToUpper.ToString() = "YES" Then
                    sXpath = "//table[@id='elderly']/tbody/tr/td[1]/label"
                Else
                    sXpath = "//table[@id='elderly']/tbody/tr/td[2]/label"
                End If

                thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not thisObject Is Nothing Then
                    This_Element = DirectCast(thisObject, IWebElement)
                    This_Element.Click()
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not select the Serve_Elderly control."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select the Serve_Elderly control.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No Serve_Elderly? value was entered. Processing Continued ", myLogPath, , actionHistoryRecordID)
            End If




            'SRO_Units
            sXpath = String.Empty
            If Not String.IsNullOrEmpty(sSROUnitsAvailable) Then
                If sSROUnitsAvailable.ToUpper.ToString() = "YES" Then
                    sXpath = "//table[@id='singleRoomOccupancy']/tbody/tr/td[1]/label"
                Else
                    sXpath = "//table[@id='singleRoomOccupancy']/tbody/tr/td[2]/label"
                End If

                thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not thisObject Is Nothing Then
                    This_Element = DirectCast(thisObject, IWebElement)
                    This_Element.Click()
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not select the single room occupancy control."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select the single room occupancy control.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No SRO_Units_Avail? value was entered. Processing Continued ", myLogPath, , actionHistoryRecordID)
            End If

            'Fed Gov
            sXpath = String.Empty
            If Not String.IsNullOrEmpty(sFedGovPropUsed) Then
                If sFedGovPropUsed.ToUpper.ToString() = "YES" Then
                    sXpath = "//table[@id='fedGovtProperty']/tbody/tr/td[1]/label"
                Else
                    sXpath = "//table[@id='fedGovtProperty']/tbody/tr/td[2]/label"
                End If

                thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not thisObject Is Nothing Then
                    This_Element = DirectCast(thisObject, IWebElement)
                    This_Element.Click()
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not select the Federal Gov control."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select the Federal Gov.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No Fed_Gov_Prop_Used? value was entered. Processing Continued ", myLogPath, , actionHistoryRecordID)
            End If


            'Hud
            sXpath = String.Empty
            If Not String.IsNullOrEmpty(sHudOwnedPropUsed) Then
                If sHudOwnedPropUsed.ToUpper.ToString() = "YES" Then
                    sXpath = "//table[@id='HUDOwnedProperty']/tbody/tr/td[1]/label"
                Else
                    sXpath = "//table[@id='HUDOwnedProperty']/tbody/tr/td[2]/label"
                End If

                thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not thisObject Is Nothing Then
                    This_Element = DirectCast(thisObject, IWebElement)
                    This_Element.Click()
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not select the Hud owned control."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select the Hud Owned control.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No HUD_Owned_Prop_Used? value was entered. Processing Continued ", myLogPath, , actionHistoryRecordID)
            End If


            'Mixed Use - Done
            sXpath = String.Empty
            If Not String.IsNullOrEmpty(sMixedUse) Then
                If sMixedUse.ToUpper.ToString() = "YES" Then
                    sXpath = "//table[@id='mixedUseProject']/tbody/tr/td[1]/label"
                Else
                    sXpath = "//table[@id='mixedUseProject']/tbody/tr/td[2]/label"
                End If

                thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not thisObject Is Nothing Then
                    This_Element = DirectCast(thisObject, IWebElement)
                    This_Element.Click()
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not select the mixed use control."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select the mixed use control.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No Mixed_Use? value was entered. Processing Continued ", myLogPath, , actionHistoryRecordID)
            End If


            'Multi Family Structure - Done
            sXpath = String.Empty
            If Not String.IsNullOrEmpty(sMultiFamilyStructure) Then
                If sMultiFamilyStructure.ToUpper.ToString() = "YES" Then
                    sXpath = "//table[@id='renterOrOwnerOccupied']/tbody/tr/td[1]/label"
                Else
                    sXpath = "//table[@id='renterOrOwnerOccupied']/tbody/tr/td[2]/label"
                End If

                thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not thisObject Is Nothing Then
                    This_Element = DirectCast(thisObject, IWebElement)
                    This_Element.Click()
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not select the multi family structure control."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select multi family structure control.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No multi_family_structure value was entered. Processing Continued ", myLogPath, , actionHistoryRecordID)
            End If


            'Single family structure - Done
            sXpath = String.Empty
            If Not String.IsNullOrEmpty(sSingleFamilyStructure) Then
                If sSingleFamilyStructure.ToUpper.ToString() = "YES" Then
                    sXpath = "//table[@id='singleFamily']/tbody/tr/td[1]/label"
                Else
                    sXpath = "//table[@id='singleFamily']/tbody/tr/td[2]/label"
                End If

                thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not thisObject Is Nothing Then
                    This_Element = DirectCast(thisObject, IWebElement)
                    This_Element.Click()
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not select the single family structure control."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select the single family structure use control.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No single_family_structure value was entered. Processing Continued ", myLogPath, , actionHistoryRecordID)
            End If


SaveButton:

            'Click Save
            Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oSave Is Nothing Then
                Dim oSaveElement As IWebElement = DirectCast(oSave, IWebElement)
                oSaveElement.Click()
                mosaicDll.Logger(senderMCPAction, "Selected the file name. ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not enter the description"
                mosaicDll.Logger(senderMCPAction, "Could not select the file name.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


NextButton:
            'click next
            Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext Is Nothing Then
                Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
                oNextElement.Click()
                mosaicDll.Logger(senderMCPAction, "Selected the file name. ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not enter the description"
                mosaicDll.Logger(senderMCPAction, "Could not select the file name.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If
EndAction:

        Catch ex As Exception


            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Gen1_Val_Enter_Application_Information_and_Save_Clk_Next = returnValues
        End Try
    End Function
    Public Function Gen3_Val_Site_Parcel_Display_Click_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Dim this_Object As Object = Nothing
        Dim this_Element As IWebElement = Nothing
        Dim sXPath As String = String.Empty
        Dim sElementValue As String = String.Empty

        Try

            'Path to site information label
            sXPath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[1]/tbody/tr/td[1]/label"
            this_Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            If Not this_Object Is Nothing Then
                this_Element = DirectCast(this_Object, IWebElement)
                'sElementValue = this_Element.GetAttribute("value")
                sElementValue = this_Element.Text
                If sElementValue.ToUpper = "Is the Project single site?*".ToUpper Then
                    'Click next
                    Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
                    If Not oNext Is Nothing Then
                        Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
                        oNextElement.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the next button on the site information tab. ", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailedAbort
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button on the site information tab.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailedAbort
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Site information tab is not available.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            'Path to site parcel label
            sXPath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table/tbody/tr[1]/td/div/span"
            Dim sXPath2 As String = "//table[@id='pageTemplateForm:sitesList']/thead/tr[1]/th"
            this_Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
            If Not this_Object Is Nothing Then
                this_Element = DirectCast(this_Object, IWebElement)
                sElementValue = this_Element.Text
                If sElementValue.ToUpper = "There are no Donated or Discounted sites identified. Site Parcel information is not applicable.".ToUpper() Then
                    'Click next
                    Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
                    If Not oNext Is Nothing Then
                        Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
                        oNextElement.Click()
                        mosaicDll.Logger(senderMCPAction, "Clicked the next button on the site parcel tab. ", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailedAbort
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button on the site parcel tab.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                Else
                    returnValues(0) = executionStatusFailedAbort
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Site parcel tab is not available.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If

            Else
                ' search for Sites Table
                this_Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath2))
                If Not this_Object Is Nothing Then
                    'Click next
                    Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
                    If Not oNext Is Nothing Then
                        Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
                        oNextElement.Click()
                        mosaicDll.Logger(senderMCPAction, "Clicked the next button on the site parcel tab. ", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailedAbort
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button on the site parcel tab.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailedAbort
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Site parcel tab is not available.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If



            Gen3_Val_Site_Parcel_Display_Click_Next = returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function GetWordText(ByVal sStringValue As String) As String

        Dim objWord As New Word.Application
        Dim WordDoc As New Word.Document

        '0 = file not found
        '1 = File found
        '2 = error message

        Try
            If System.IO.File.Exists(sStringValue) Then


                WordDoc = objWord.Documents.Open(sStringValue.ToString())
                Dim sParagraph As New StringBuilder

                '  If you want the user to see it ... 
                objWord.WindowState = Word.WdWindowState.wdWindowStateMinimize
                objWord.Visible = False

                WordDoc.Select()
                objWord.Selection.Copy()
                GetWordText = "File found"


            Else
                GetWordText = "File not found"
            End If


        Catch ex As Exception
            GetWordText = ex.Message

        Finally
            WordDoc.Close(SaveChanges:=False)
            WordDoc = Nothing
            objWord.Quit()
            objWord = Nothing


        End Try



    End Function
    Public Function Gen2a_Ent_Known_Site_Valid_Zip_Upd_Save(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            'Zip Code Information

            Dim sAddrLine1 As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Address_Line_1")
            Dim sAddrLine2 As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Address_Line_2")
            Dim sZip As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "ZIP")
            Dim sZipPlus4 As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "ZIP+4")
            Dim sCity As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "City")
            Dim sCounty As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "County")
            Dim SState As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "State")
            Dim sCongressDistrict As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Congressional_District")
            Dim sCensusTrct As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Census_Tract")
            Dim sCBSA As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "CBSA")
            Dim Validate_ZIP As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Validate_Zip?")

            'Main Window Data
            Dim sNbrUnits As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Nbr_of_Units")
            Dim sTargetedArea As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Targeted_Area")
            Dim sAppraisalDate As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Appraisal_Date")
            Dim sLocIndianLand As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Located_on_Indian_Land?")
            Dim sAcquisitionPrice As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Acquisition_Price")
            Dim sLandTrust As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Located_in_Land_Trust?")
            Dim sAppraisedValue As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Appraised_Value")
            Dim sDonatedDiscounted As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Donated_or_Discounted")
            Dim sForeclosureREQShortSale As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Foreclosure/REQ/Short-Sale")
            Dim sRural As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Rural")
            Dim sDwellingType As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Dwelling_Type")

            ' Ownership Interest or Conflict
            Dim sMbrCurrPastFinOwnInterest As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Mbr_Curr_Past_Fin_or_Ownr_Interest?")
            Dim sOwnedByReoAMAPendForeclose As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Owned_by_Reo_or_AMA_or_Pend_ForeClosur")
            Dim sOwnPriorOwner As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Owned_by_Mbr_Prior_Owner")
            Dim sHoldMortgPriorSalePastOwn As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Hold_Mortgage_Prior_Sale_or_Past_Owner_Interest")
            Dim sCurrHoldMortOwnInterest As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Currently_Hold_Mortgage_or_Owner_Interest")
            Dim sMbrInterest_Descr As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Mbr_Interest_Descr")
            Dim sRelorConflict As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Relationship_or_Conflict?")
            Dim sRelConflictDescr As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Rel_Conflict_Descr")
            Dim sAsIsAppraiseFile As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "As_Is_Appraisal_File_Location")

            Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "site_site_data_for_apps", "Error_Message")

            Dim MAX_DAY_IN_A_MONTH As Integer = 31
            Dim index As Integer = 0
            Dim oZeroPath_element As IWebElement = Nothing

            Dim this_Object As Object = Nothing
            Dim this_Element As IWebElement = Nothing
            Dim sXPath As String = String.Empty
            ' Dim site_Object As Object = Nothing
            ' Dim site_Element As IWebElement = Nothing

            'Enter Address Line 1 and 2 

            If Not sAddrLine1 = String.Empty Then
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='adrsl1']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(Keys.Control + "a")
                    this_Element.SendKeys(sAddrLine1)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Address Line 1 then Entered: " & sAddrLine1.ToString, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Address Line 1."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAddrLine1.ToString & " in Address Line 1.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If Not sAddrLine2 = String.Empty Then
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:adrsl2']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(Keys.Control + "a")
                    this_Element.SendKeys(sAddrLine2)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Address Line 2 then Entered: " & sAddrLine2.ToString, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Address Line 2."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAddrLine2.ToString & " in Address Line 2.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            'Enter Zip and Zip4 but hold Lookup to end

            If Not sZip = String.Empty Then
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='lookupZip']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(Keys.Control + "a")
                    this_Element.SendKeys(sZip)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Zip Code then Entered: " & sZip.ToString, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Zip code."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sZip.ToString & " in Zip Code.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If Not sZipPlus4 = String.Empty Then
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='plus4']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(Keys.Control + "a")
                    this_Element.SendKeys(sZipPlus4)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Zip+4 then Entered: " & sZipPlus4.ToString, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Zip+4."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sZipPlus4.ToString & " in Zip+4.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            'Enter Number of Units

            If Not sNbrUnits = String.Empty Then
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='numUnits']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(Keys.Control + "a")
                    this_Element.SendKeys(sNbrUnits)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Number of Units then Entered: " & sNbrUnits, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Number of Units."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sNbrUnits & " in Number of Units.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If


            Dim elem As IWebElement = driver.FindElement(By.XPath("//select[@id='tType']"))
            Dim FoundREO As Boolean = False
            Dim selectList As New SelectElement(elem)
            Dim options As IList(Of IWebElement) = selectList.Options
SelectTarget:

            If sTargetedArea = String.Empty Then
                GoTo Skip_Target_Area
            End If

            'Select Targeted Area
            Dim FoundOption As Boolean = False
            elem = driver.FindElement(By.XPath("//select[@id='tType']"))

            selectList = New SelectElement(elem)
            options = selectList.Options


            For Each myelement As IWebElement In options
                If myelement.Text.ToUpper = sTargetedArea.ToUpper Then
                    myelement.Click()
                    FoundOption = True
                End If
            Next


            If FoundOption = True Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Selected Targeted Area: " & sTargetedArea.ToString, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not select Targeted Area."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select " & sTargetedArea.ToString & " from Targeted Area.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)

            End If

Skip_Target_Area:
            '********* routine for dates *********************************************************************************
            'Implement Calendar for Appraisal Date
            If Not sAppraisalDate = String.Empty Then
                'New up a calendar object
                Dim myCalendar As New CalendarParams

                'change text date to real date
                Dim properDate As DateTime = DateTime.Parse(sAppraisalDate)

                'set parameters 
                myCalendar.monthdec = "//td[@id='pageTemplateForm:appraisalDateHeader']/table/tbody/tr/td[2]/div"
                myCalendar.monthinc = "//td[@id='pageTemplateForm:appraisalDateHeader']/table/tbody/tr/td[4]/div"
                myCalendar.yeardec = "//td[@id='pageTemplateForm:appraisalDateHeader']/table/tbody/tr/td[1]/div"
                myCalendar.yearinc = "//td[@id='pageTemplateForm:appraisalDateHeader']/table/tbody/tr/td[5]/div"
                myCalendar.clean = "//td[@id='pageTemplateForm:appraisalDateFooter']/table/tbody/tr/td[2]/div"
                myCalendar.ctoday = "//td[@id='pageTemplateForm:appraisalDateFooter']/table/tbody/tr/td[5]/div"
                myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:appraisalDatePopupButton']"
                myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:appraisalDateDayCell0']"
                myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:appraisalDateDayCell"
                myCalendar.dayXPathPart2 = "']"
                myCalendar.CalHeader = "//td[@id='pageTemplateForm:appraisalDateHeader']/table/tbody/tr/td[3]/div"
                myCalendar.CurrentDay = Now.Day
                myCalendar.CurrentMonth = Now.Month
                myCalendar.CurrentYear = Now.Year
                myCalendar.TargetDay = properDate.Day
                myCalendar.TargetMonth = properDate.Month
                myCalendar.TargetYear = properDate.Year
                myCalendar.CurrentDate = Today
                myCalendar.TargetDate = properDate

                'call calendar method WELLA

                Call DoCalendar(sAppraisalDate, myCalendar, returnValues, actionHistoryRecordID)

            End If

            '************************ End of Date Routine ************************************

            'Select Indian Land Location

            If sLocIndianLand.ToUpper = "NO" Then
                'click Indian Land button
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propertyOnIndianLand']/tbody/tr/td[2]/label"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Located on Indian Land NO button", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click single site NO button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Located on Indian Land NO button", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            ElseIf sLocIndianLand.ToUpper = "YES" Then
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propertyOnIndianLand']/tbody/tr/td[1]/label"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Located on Indian Land YES button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click Located on Indian Land YES button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Located on Indian Land YES button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            ElseIf Not sLocIndianLand.ToUpper = String.Empty Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Invalid Value for Located on Indian Land Specified: " & sLocIndianLand
                mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Located on Indian Land Specified: " & sLocIndianLand & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
            End If

            ' Enter Acquisition Price

            If Not sAcquisitionPrice = String.Empty Then
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='acquisitionPrice']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(Keys.Control + "a")
                    this_Element.SendKeys(sAcquisitionPrice)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Aquisition Price then Entered: " & sAcquisitionPrice, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Acquisition Price."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAcquisitionPrice & " in Acquisition Price.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If Not sAppraisedValue = String.Empty Then
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='appraisedValue']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(Keys.Control + "a")
                    this_Element.SendKeys(sAppraisedValue)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Appraised Value then Entered: " & sAppraisedValue, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Acquisition Price."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAppraisedValue & " in Appraised Value.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
            If sLandTrust.ToUpper = "NO" Then
                'click Land Trust button
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propertyOnLandTrust']/tbody/tr/td[2]/label"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Located in Land Trust NO button", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click in Land Trust  NO button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click in Land Trust  NO button", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            ElseIf sLandTrust.ToUpper = "YES" Then
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propertyOnLandTrust']/tbody/tr/td[1]/label"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Located in Land Trust  YES button", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click Located in Land Trust  YES button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Located in Land Trust YES button", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            ElseIf Not sLandTrust.ToUpper = String.Empty Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Invalid Value for Located in Land Trust Specified: " & sLandTrust
                mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Located in Land Trust Specified: " & sLandTrust & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
            End If

            'Set the Donated or Discounted
            If sDonatedDiscounted = String.Empty Then
                GoTo SkipDonatedDiscount
            End If
            FoundOption = False
            'Dim DonDiscElement As IWebElement = driver.FindElement(By.XPath("//select"))
            elem = driver.FindElement(By.XPath("//select[@id='donType']"))

            selectList = New SelectElement(elem)
            options = selectList.Options


            For Each myelement As IWebElement In options
                If myelement.Text.ToUpper = sDonatedDiscounted.ToString.ToUpper Then
                    myelement.Click()
                    FoundOption = True
                End If
            Next


            If FoundOption = True Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Selected Donated/Discounted value: " & sDonatedDiscounted.ToString, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not select Site is Donated or Discounted field."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select " & sDonatedDiscounted.ToString & " from Is Site Donated or Discounted?", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

SkipDonatedDiscount:

            elem = driver.FindElement(By.XPath("//select[@id='pType']"))
            FoundREO = False
            selectList = New SelectElement(elem)
            options = selectList.Options


            For Each myelement As IWebElement In options
                If myelement.Text.ToUpper = sForeclosureREQShortSale.ToString.ToUpper Then
                    myelement.Click()
                    FoundREO = True
                End If
            Next


            If FoundREO = True Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Selected Property is Foreclosure, REO or Short Sale: " & sForeclosureREQShortSale.ToString, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not select Property is Foreclosure, REO or Short Sale."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select " & sForeclosureREQShortSale.ToString & " from Property is Foreclosure, REO or Short Sale.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

SkipForeclosureREQShortSale:

            'Select if Rural

            If sRural.ToUpper = "NO" Then
                'click Rural button
                'site_Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='ruralRadio']/tbody/tr/td[2]/label"))
                'site_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[2]/div[3]/table[3]/tbody/tr/td[1]/table/tbody/tr[5]/td[1]/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label/input"))
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='ruralRadio']/tbody/tr/td[2]"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Rural NO button", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Could not click Rural NO button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Rural NO button", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            ElseIf sRural.ToUpper = "YES" Then
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='ruralRadio']/tbody/tr/td[1]/label"))
                'site_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[2]/div[3]/table[3]/tbody/tr/td[1]/table/tbody/tr[5]/td[1]/table/tbody/tr/td[2]/table/tbody/tr/td[1]/label/input"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Located Rural YES button", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click Located Rural YES button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Located Rural YES button", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            ElseIf Not sRural.ToUpper = String.Empty Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Invalid Value for Rural Specified: " & sRural.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Rural Specified: " & sRural.ToString & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
            End If

            'Select Dwelling Type

            If sDwellingType Is String.Empty Then
                GoTo SkipDwellingType
            End If

            FoundOption = False

            elem = driver.FindElement(By.XPath("//select[@id='dwType']"))

            selectList = New SelectElement(elem)
            options = selectList.Options


            For Each myelement As IWebElement In options
                If myelement.Text.ToUpper = sDwellingType.ToString.ToUpper Then
                    myelement.Click()
                    FoundOption = True
                End If
            Next


            If FoundOption = False Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not select Dwelling Type."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select " & sDwellingType.ToString & " from Dwelling Type.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

SkipDwellingType:

            If sMbrCurrPastFinOwnInterest.ToUpper = "NO" Then
                'click No Current or Past Financial Interest button
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='memberFinOrOwnerInterest']/tbody/tr/td[2]/label"))
                'site_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[3]/div[3]/table[4]/tbody/tr[1]/td/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label"))
                'Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[2]/div[3]/table[4]/tbody/tr[1]/td/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label/input"))

                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Current or Past Financial Interest NO button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click Current or Past Financial Interest NO button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Current or Past Financial Interest NO button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
                GoTo RelationshipQuestion
            ElseIf sMbrCurrPastFinOwnInterest.ToUpper = "YES" Then
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='memberFinOrOwnerInterest']/tbody/tr/td[1]/label"))
                'Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[2]/div[3]/table[4]/tbody/tr[1]/td/table/tbody/tr/td[2]/table/tbody/tr/td[1]/label/input"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Current or Past Financial Interest YES button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click Current or Past Financial Interest YES button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Current or Past Financial Interest YES button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
                ' Process extra questions from Yes answer to Financial or Ownership Interest

                'Owned by REO AMA or Pending Foreclosure?

                If sOwnedByReoAMAPendForeclose.ToUpper = "NO" Then
                    'click No Current or Past Financial Interest button
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propOwnedByReoAmaFc']/tbody/tr/td[2]/label"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Owned by REO, AMA or Pending Foreclosure NO button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Owned by REO, AMA or Pending Foreclosure NO button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Owned by REO, AMA or Pending Foreclosure NO button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                ElseIf sOwnedByReoAMAPendForeclose.ToUpper = "YES" Then
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propOwnedByReoAmaFc']/tbody/tr/td[1]/label"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Owned by REO, AMA or Pending Foreclosure YES button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Owned by REO, AMA or Pending Foreclosure YES button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Owned by REO, AMA or Pending Foreclosure YES button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                ElseIf Not sOwnedByReoAMAPendForeclose = String.Empty Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Invalid Value for Owned by REO, AMA or Pending Foreclosure Specified: " & sOwnedByReoAMAPendForeclose.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Owned by REO, AMA or Pending Foreclosure Specified: " & sOwnedByReoAMAPendForeclose.ToString & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
                End If

                ' Owned Prior to Sale 

                If sOwnPriorOwner.ToUpper = "NO" Then
                    'click No Current or Past Financial Interest button
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propOwnedByMemberpriorToSale']/tbody/tr/td[2]/label"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Owned Prior to Sale NO button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Owned by Owned Prior to Sale NO button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Owned Prior to Sale NO button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                ElseIf sOwnPriorOwner.ToUpper = "YES" Then
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='propOwnedByMemberpriorToSale']/tbody/tr/td[1]/label"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Owned Prior to Sale YES button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Owned Prior to Sale YES button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Owned Prior to Sale YES button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                ElseIf Not sOwnPriorOwner = String.Empty Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Invalid Value for Owned Prior to Sale Specified: " & sOwnPriorOwner.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Owned Prior to Sale Specified: " & sOwnPriorOwner.ToString & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
                End If

                ' Hold Mortgage or Prior Financial Ownership Prior to Sale 

                If sHoldMortgPriorSalePastOwn.ToUpper = "NO" Then
                    'click No Current or Past Financial Interest button
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='memMortPriorToSale']/tbody/tr/td[2]"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Held Mortgage or Financial Interest Prior to Sale NO button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Held Mortgage or Financial Interest Prior to Sale NO button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Held Mortgage or Financial Interest Prior to Sale NO button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                ElseIf sHoldMortgPriorSalePastOwn.ToUpper = "YES" Then
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='memMortPriorToSale']/tbody/tr/td[1]"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Held Mortgage or Financial Interest Prior to Sale YES button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Held Mortgage or Financial Interest Prior to Sale YES button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Held Mortgage or Financial Interest Prior to Sale YES button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                ElseIf Not sHoldMortgPriorSalePastOwn = String.Empty Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Invalid Value for Held Mortgage or Financial Interest Prior to Sale Specified: " & sOwnPriorOwner.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Held Mortgage or Financial Interest Prior to Sale Specified: " & sOwnPriorOwner.ToString & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
                End If

                ' Acquired or Currently Hold Mortgage

                If sCurrHoldMortOwnInterest.ToUpper = "NO" Then
                    'click No Current or Past Financial Interest button
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='notAcqMemMortFinOwnInt']/tbody/tr/td[2]"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Current Owner or Currently Hold Mortgage NO button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Current Owner or Currently Hold Mortgage NO button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Current Owner or Currently Hold Mortgage NO button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                ElseIf sCurrHoldMortOwnInterest.ToUpper = "YES" Then
                    Dim site_Object2 As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='notAcqMemMortFinOwnInt']/tbody/tr/td[1]"))
                    If Not site_Object2 Is Nothing Then
                        Dim site_Element As IWebElement = DirectCast(site_Object2, IWebElement)
                        site_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Current Owner or Currently Hold Mortgage YES button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click Current Owner or Currently Hold Mortgage YES button."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Current Owner or Currently Hold Mortgage YES button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                ElseIf Not sCurrHoldMortOwnInterest = String.Empty Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Invalid Value for Held Mortgage or Financial Interest Prior to Sale Specified: " & sOwnPriorOwner.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Held Mortgage or Financial Interest Prior to Sale Specified: " & sOwnPriorOwner.ToString & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
                End If

                'Enter Circumstances of Member Interest in Property

                If Not String.IsNullOrEmpty(sMbrInterest_Descr) Then
                    System.Windows.Forms.Clipboard.Clear()
                    Dim sRetVal As String = GetWordText(sMbrInterest_Descr)
                    If sRetVal.ToUpper = "FILE NOT FOUND" Then
                        this_Object = WaitForElement(driver, WaitForTime, By.XPath("//textarea[@id='memberIntExpl']"))
                        If Not this_Object Is Nothing Then
                            this_Element = DirectCast(this_Object, IWebElement)
                            this_Element.SendKeys(Keys.Control + "a")
                            this_Element.SendKeys(sMbrInterest_Descr)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Circumstances of member applicant's interest in property was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                        End If
                    ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                        this_Object = WaitForElement(driver, WaitForTime, By.XPath("//textarea[@id='memberIntExpl']"))
                        If Not this_Object Is Nothing Then
                            this_Element = DirectCast(this_Object, IWebElement)
                            this_Element.SendKeys(Keys.Control + "a")
                            this_Element.SendKeys(Keys.Delete)

                            Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                            this_Element.SendKeys(Keys.Control + "v")

                            mosaicDll.Logger(senderMCPAction, "Actual Result|Circumstances of member applicant's interest in property was entered from Word document.", myLogPath, , actionHistoryRecordID)
                        End If
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & sRetVal
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                    End If

                End If

            ElseIf Not sMbrCurrPastFinOwnInterest.ToUpper = String.Empty Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Invalid Value for Current or Past Financial Interest Specified: " & sLocIndianLand
                mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Current or Past Financial Interest Specified: " & sLocIndianLand & "Expected Yes or No.", myLogPath, , actionHistoryRecordID)
            End If

RelationshipQuestion:
            ' Relationship of Conflict of Interest Between Sellers and Sponsor or Dev Team

            If sRelorConflict.ToUpper = "NO" Then
                'click No Current or Past Financial Interest button
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='conflictRelation']/tbody/tr/td[2]/label"))
                'site_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[2]/div[3]/table[4]/tbody/tr[2]/td/table/tbody/tr[1]/td/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label"))
                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Conflict of Interest Bet Sellers and Sponsor NO button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click Conflict of Interest Bet Sellers and Sponsor NO button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Conflict of Interest Bet Sellers and Sponsor NO button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If

            ElseIf sRelorConflict.ToUpper = "YES" Then
                Dim site_Object As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='conflictRelation']/tbody/tr/td[1]/label"))
                'site_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[2]/div[3]/table[4]/tbody/tr[2]/td/table/tbody/tr[1]/td/table/tbody/tr/td[2]/table/tbody/tr/td[1]/label"))

                If Not site_Object Is Nothing Then
                    Dim site_Element As IWebElement = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Conflict of Interest Bet Sellers and Sponsor YES button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click Conflict of Interest Bet Sellers and Sponsor YES button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Conflict of Interest Bet Sellers and Sponsor YES button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
                If Not String.IsNullOrEmpty(sRelConflictDescr) Then
                    System.Windows.Forms.Clipboard.Clear()
                    Dim sRetVal As String = GetWordText(sRelConflictDescr)
                    If sRetVal.ToUpper = "FILE NOT FOUND" Then
                        this_Object = WaitForElement(driver, WaitForTime, By.XPath("//textarea[@id='conflictRelationExpl']"))
                        If Not this_Object Is Nothing Then
                            this_Element = DirectCast(this_Object, IWebElement)
                            this_Element.SendKeys(Keys.Control + "a")
                            this_Element.SendKeys(sRelConflictDescr)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Description of Relationship or Conflict of Interest was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                        End If
                    ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                        this_Object = WaitForElement(driver, WaitForTime, By.XPath("//textarea[@id='conflictRelationExpl']"))
                        If Not this_Object Is Nothing Then
                            this_Element = DirectCast(this_Object, IWebElement)
                            this_Element.SendKeys(Keys.Control + "a")
                            this_Element.SendKeys(Keys.Delete)

                            Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                            this_Element.SendKeys(Keys.Control + "v")

                            mosaicDll.Logger(senderMCPAction, "Actual Result|Description of Relationship or Conflict of Interest was entered from Word document.", myLogPath, , actionHistoryRecordID)
                        End If
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & sRetVal
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function: " & sRetVal, myLogPath, , actionHistoryRecordID)
                    End If

                End If

            ElseIf Not sRelorConflict = String.Empty Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Invalid Value for Conflict of Interest Bet Sellers and Sponsor  Specified: " & sOwnPriorOwner.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value for Conflict of Interest Bet Sellers and Sponsor Specified: " & sOwnPriorOwner.ToString & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
            End If


            Dim bSetFile As Boolean = False

            'if there is a file location set select it
            If Not sAsIsAppraiseFile = String.Empty Then
                If Not System.IO.File.Exists(sAsIsAppraiseFile) Then
                    'message
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "The file named: " & sAsIsAppraiseFile & " was not found."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sAsIsAppraiseFile & " was not found.", myLogPath, , actionHistoryRecordID)
                Else
                    Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:appraisalDocAtt']"))
                    If Not oAttachFile Is Nothing Then
                        Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                        oAttachFileElement.Click()
                        oAttachFileElement.SendKeys(sAsIsAppraiseFile)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Attached appraisal document.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not attach file named: " & sAsIsAppraiseFile
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sAsIsAppraiseFile, myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                End If
            End If


            'find the lookup button
            'Dim sLookup As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[2]/table[2]/tbody/tr/td[2]/table/tbody/tr[2]/td/table[1]/tbody/tr/td[3]/div/input"
            'Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath(sLookup)

            Dim Foundlookup As Boolean = False
            'Dim a As New AutomationObject

            'a.aObject = WaitForElement(driver, WaitForTime, By.XPath(sLookup))
            'If Not a.aObject Is Nothing Then
            '    a.aElement = DirectCast(a.aObject, IWebElement)
            '    a.aElement.Click()
            '    Foundlookup = True
            'End If
            Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//input"))


            For y As Integer = 1 To inputElements.Count - 1
                If inputElements(y).GetAttribute("value").ToUpper.ToString() = "LOOKUP" Then
                    Dim inputElement As IWebElement = inputElements(y)
                    inputElement.Click()
                    Foundlookup = True
                    Exit For
                End If
            Next
            'Click and Validate Zip Lookup
            If Foundlookup = False Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not Click lookup for Zip Code. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not Click lookup for Zip Code. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo SaveButton

            End If
            'find and compare the fields

            Dim cityElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:city']"))
            Dim countyElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:county']"))
            Dim StateElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:state']"))
            Dim CongressDElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:conDist']"))
            Dim CensusTrElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:censusTract']"))
            Dim CBSAElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:msa']"))

            Dim bZipLookupPass As Boolean = True
            Dim sZipErrors As String = String.Empty
            cityElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:city']"))
            If Not cityElement Is Nothing Then
                If sCity.ToUpper.ToString <> cityElement.Text.ToUpper.ToString And Not sCity.ToUpper.ToString = String.Empty Then
                    sZipErrors = sZipErrors & " Cities did not match: Template has: " & sCity.ToUpper.ToString & " App has: " & cityElement.Text.ToUpper.ToString & " "
                End If
            End If
            If Validate_ZIP.ToUpper <> "NO" Then
                If Not countyElement Is Nothing Then
                    If sCounty.ToUpper.ToString <> countyElement.Text.ToUpper.ToString() And Not sCounty.ToUpper.ToString = String.Empty Then
                        sZipErrors = sZipErrors & " Counties did not match: Template has: " & sCounty.ToUpper.ToString & " App has: " & countyElement.Text.ToUpper.ToString & " "
                    End If
                End If

                If Not StateElement Is Nothing Then
                    If SState.ToUpper.ToString() <> StateElement.Text.ToUpper.ToString() And Not SState.ToUpper.ToString = String.Empty Then
                        sZipErrors = sZipErrors & " State did not match: Template has: " & SState.ToUpper.ToString & " App has: " & StateElement.Text.ToUpper.ToString & " "
                    End If
                End If

                If Not CongressDElement Is Nothing Then
                    If sCongressDistrict.ToUpper.ToString <> CongressDElement.Text.ToUpper.ToString And Not sCongressDistrict.ToUpper.ToString = String.Empty Then
                        sZipErrors = sZipErrors & " Congressional District did not match: Template has: " & sCongressDistrict.ToUpper.ToString & " App has: " & CongressDElement.Text.ToUpper.ToString & " "
                    End If
                End If

                If Not CensusTrElement Is Nothing Then
                    If sCensusTrct.ToUpper.ToString <> CensusTrElement.Text.ToUpper.ToString And Not sCensusTrct Is String.Empty Then
                        sZipErrors = sZipErrors & " Census Tract did not match: Template has: " & sCensusTrct.ToUpper.ToString & " App has: " & CensusTrElement.Text.ToUpper.ToString & " "
                    End If
                End If

                If Not CBSAElement Is Nothing Then
                    If sCBSA.ToUpper.ToString <> CBSAElement.Text.ToUpper.ToString And Not sCBSA = String.Empty Then
                        sZipErrors = sZipErrors & " CBSA did not match: Template has: " & sCBSA.ToUpper.ToString & " App has: " & CBSAElement.Text.ToUpper.ToString & " "
                    End If
                End If

                If Not sZipErrors = String.Empty Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " One or more Zip Code Values Do Not Match Expected Results."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| " & sZipErrors, myLogPath, , actionHistoryRecordID)
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Zip Code Validation Passed", myLogPath, , actionHistoryRecordID)

                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|Skipped Zip Code Validation. ", myLogPath, , actionHistoryRecordID)
            End If
            'Click Update Site

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            Dim sUpdSiteObject As Object = Nothing
            sUpdSiteObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[1]/div/table/tbody/tr/td[2]/input"))
            If Not sUpdSiteObject Is Nothing Then
                Dim sElementReq As IWebElement = DirectCast(sUpdSiteObject, IWebElement)
                sElementReq.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Update Site ", myLogPath, , actionHistoryRecordID)

                'Threading.Thread.Sleep(1000)


                Dim wait2 As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
                wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

                'Dim sSiteTable As Object = Nothing
                ''look for site window
                'sSiteTable = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:siteList']/thead/tr[1]/th"))
                'See if still on Update Window
                Dim sUpdSiteObjectck As Object = Nothing
                sUpdSiteObjectck = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[1]/div/table/tbody/tr/td[2]/input"))
                If Not sUpdSiteObjectck Is Nothing Then
                    If sErrorMessage = String.Empty Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Update Failed - Check Error."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Update Failed - Check Error.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        ' try to click cancel
                        Dim sCancelobj As Object = Nothing
                        sCancelobj = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[1]/div/table/tbody/tr/td[1]/input"))
                        If Not sCancelobj Is Nothing Then
                            Dim sElementCancel As IWebElement = DirectCast(sCancelobj, IWebElement)
                            sElementCancel.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Cancel to Clear Invalid Site. ", myLogPath, , actionHistoryRecordID)
                        End If
                    Else
                        returnValues(1) = returnValues(1) & " Update Failed - Check for Correct Message."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Update Failed - Check for Correct Message.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If

                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Update Successful- Update Button Closed.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click Update Site."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not Click Update Site ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

SaveButton:

            'Click Save
            Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            'Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[3]/tbody/tr/td[2]/table/tbody/tr[2]/td[1]/div/input"))
            If Not oSave Is Nothing Then
                Dim oSaveElement As IWebElement = DirectCast(oSave, IWebElement)
                'Dim oSaveElement As IWebElement = driver.FindElement(By.XPath("//input[@id='pageTemplateForm:saveButton']"))
                oSaveElement.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click the save button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


            'NextButton:
            '            'click next
            '            Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            '            If Not oNext Is Nothing Then
            '                Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
            '                oNextElement.Click()
            '                mosaicDll.Logger(senderMCPAction, "Clicked the next button.", myLogPath, , actionHistoryRecordID)
            '            Else
            '                returnValues(0) = executionStatusFailedAbort
            '                returnValues(1) = returnValues(1) & " Could not click the next button ."
            '                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button.", myLogPath, , actionHistoryRecordID)
            '                CaptureScreenshot(actionHistoryRecordID)
            '            End If


            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Gen2_Click_Single_or_Multi_Site_and_Nbr_Unknown(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try


            Dim sSingleSite As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Single_Site?")
            Dim sNbrSites As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Nbr_Sites")
            Dim sAllAddressKnown As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "All_Addr_Known?")
            Dim sNbrSitesKnown As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Nbr_Site_Addr_Known")

            Dim this_Object As Object = Nothing
            Dim this_Element As IWebElement = Nothing
            Dim sXPath As String = String.Empty
            Dim site_Object As Object = Nothing
            Dim site_Element As IWebElement = Nothing
            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))


            If sSingleSite.ToUpper = "NO" Then
                'click single site button
                site_Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='site1']/tbody/tr/td[2]/label"))
                If Not site_Object Is Nothing Then
                    site_Element = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked single site NO button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Could not click single site NO button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click single site NO button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo EndProc
                End If

                this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='numOfSites']"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.SendKeys(sNbrSites)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Entered " & sNbrSites & " sites.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Could not enter " & sNbrSites & " sites."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sNbrSites & " sites.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo EndProc
                End If

                If sAllAddressKnown.ToUpper = "YES" Then
                    sXPath = "//table[@id='multiSiteAddress']/tbody/tr/td[1]/label"
                ElseIf sAllAddressKnown.ToUpper = "NO" Then
                    sXPath = "//table[@id='multiSiteAddress']/tbody/tr/td[2]/label"
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Unknown value provided for All Addresses Known."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value Specified for Addresses Known: " & sAllAddressKnown.ToString & " Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                    GoTo EndProc
                End If
                this_Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the all addresses " & sAllAddressKnown & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click the all addresses " & sAllAddressKnown & " button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the all addresses " & sAllAddressKnown & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
                If sAllAddressKnown.ToUpper = "YES" Then
                    GoTo AddSite
                ElseIf sAllAddressKnown.ToUpper = "NO" Then
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='knownSiteAddresses']"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.SendKeys(sNbrSitesKnown)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Number of Sites Known " & sNbrSitesKnown, myLogPath, , actionHistoryRecordID)
                        GoTo EndProc
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter Number of Sites Known " & sNbrSitesKnown
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Number of Sites Known " & sNbrSitesKnown, myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If

                End If
            End If


            'reinit vars
            this_Object = Nothing
            this_Element = Nothing

            If sSingleSite.ToUpper = "YES" Then
                site_Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='site1']/tbody/tr/td[1]/label"))
                If Not site_Object Is Nothing Then
                    site_Element = DirectCast(site_Object, IWebElement)
                    site_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result |Clicked the single site YES button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Could not click the single site YES button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result |Could not click single site YES button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo EndProc
                End If


AddSite:
                'Click the add site button
                this_Object = WaitForElement(driver, WaitForTime, By.XPath(" /html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div[3]/input"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.Click()
                    Dim sSuccess As Boolean = True

                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Could not click the Add Site button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result |Could not click the Add Site button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo EndProc
                End If

                If sSingleSite.ToUpper <> "YES" Then
                    GoTo EndProc
                End If
                'reinit vars
                this_Object = Nothing
                this_Element = Nothing

                If sAllAddressKnown.ToUpper = "YES" Then
                    sXPath = "//table[@id='site1Radio']/tbody/tr/td[1]/label"
                ElseIf sAllAddressKnown.ToUpper = "NO" Then
                    sXPath = "//table[@id='site1Radio']/tbody/tr/td[2]/label"
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Unknown Value Provided for All Address Known."
                    mosaicDll.Logger(senderMCPAction, "Actual Result |Invalid Value Provided for All Address Known " & sAllAddressKnown.ToString & " Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo EndProc

                End If
                this_Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the all addresses " & sAllAddressKnown & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click the all addresses " & sAllAddressKnown & " button."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the all addresses " & sAllAddressKnown & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            ElseIf Not sSingleSite.ToUpper = String.Empty Then
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & " Invalid Value Specified for Single Site " & sSingleSite.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result | Invalid Value Specified for Single Site " & sSingleSite.ToString & " Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If
EndProc:


            Gen2_Click_Single_or_Multi_Site_and_Nbr_Unknown = returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Gen2c_Enter_Unknown_Site(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sAddrLine1 As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Address_Line_1")
            Dim sAddrLine2 As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Address_Line_2")
            Dim sZip As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "ZIP")
            Dim sZip4 As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "ZIP+4")
            Dim sCity As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "City")
            Dim sCounty As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "County")
            Dim sState As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "State")
            Dim sCongressDistrict As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Congressional_District")
            Dim sCensusTract As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Census_Tract")
            Dim sCBSA As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "CBSA")
            Dim sGeographicalArea As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Georgraphical_Area_Descr")
            Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Error_Message")
            Dim sSingleSite As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Single_Site?")
            Dim Validate_ZIP As String = mosaicDll.dt(excelPath, iteration, "zip_addr_zip_code_unknown_sites", "Validate_Zip?")
            Dim thisObject As Object = Nothing
            Dim This_Element As IWebElement

            Dim sXpathA1 As String
            If sSingleSite.ToUpper = "YES" Then
                sXpathA1 = "//input[@id='adrsl1_optional']"
            ElseIf sSingleSite.ToUpper = "NO" Then
                sXpathA1 = "//input[@id='adrsl1']"
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Single Site Data Template Value Invalid - Update Data Template then Rerun "
                mosaicDll.Logger(senderMCPAction, "Actual Result|Single Site Data Template Value Invalid - Update Data Template then Rerun ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo SaveButton
            End If

            Dim sXpathAz4 As String
            If sSingleSite.ToUpper = "YES" Then
                sXpathAz4 = "//input[@id='plus4_optional']"
            ElseIf sSingleSite.ToUpper = "NO" Then
                sXpathAz4 = "//input[@id='plus4']"
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Single Site Data Template Value Invalid - Update Data Template then Rerun "
                mosaicDll.Logger(senderMCPAction, "Actual Result|Single Site Data Template Value Invalid - Update Data Template then Rerun ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo SaveButton
            End If

            If Not sAddrLine1 = String.Empty Then
                Dim sAObject As Object = Nothing
                sAObject = WaitForElement(driver, WaitForTime, By.XPath(sXpathA1))

                'if you find the Addr Line 1 field then type in the address
                If Not sAObject Is Nothing Then
                    Dim sElementAddr As IWebElement = DirectCast(sAObject, IWebElement)
                    sElementAddr.SendKeys(Keys.Control + "a")
                    sElementAddr.SendKeys(sAddrLine1)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the Address One field and entered the address " & sAddrLine1.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the Address Line One."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the Address Line One: " & sAddrLine1.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If Not sAddrLine2 = String.Empty Then
                Dim sAObject As Object = Nothing
                sAObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:adrsl2']"))

                'if you find the Address Line Two field then type in the address
                If Not sAObject Is Nothing Then
                    Dim sElementAddr As IWebElement = DirectCast(sAObject, IWebElement)
                    sElementAddr.SendKeys(Keys.Control + "a")
                    sElementAddr.SendKeys(sAddrLine2)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the Address Line Two field and entered the address " & sAddrLine2.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the Address Line Two."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the Address Line Two: " & sAddrLine2.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If Not sZip = String.Empty Then
                Dim sAObject As Object = Nothing
                sAObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='lookupZip']"))

                'if you find the Addr Line 1 field then type in the address
                If Not sAObject Is Nothing Then
                    Dim sElementAddr As IWebElement = DirectCast(sAObject, IWebElement)
                    sElementAddr.SendKeys(Keys.Control + "a")
                    sElementAddr.SendKeys(sZip)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the Zip Code field and entered the zip code " & sZip.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the Zip Code."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the Zip Code: " & sZip.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If Not sZip4 = String.Empty Then
                Dim sAObject As Object = Nothing
                sAObject = WaitForElement(driver, WaitForTime, By.XPath(sXpathAz4))

                'if you find the Addr Line 1 field then type in the address
                If Not sAObject Is Nothing Then
                    Dim sElementAddr As IWebElement = DirectCast(sAObject, IWebElement)
                    sElementAddr.SendKeys(Keys.Control + "a")
                    sElementAddr.SendKeys(sZip4)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the Zip+4 field and entered the Zip4 " & sZip4.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the Zip+4 field."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the Zip+4 : " & sZip4.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If



            'Dim s As String = String.Empty
            'Dim sXpath As String



            If Not String.IsNullOrEmpty(sGeographicalArea) Then
                System.Windows.Forms.Clipboard.Clear()
                Dim sXpathg As String
                If sSingleSite.ToUpper = "YES" Then
                    sXpathg = "//textarea[@id='distanceFromSite']"
                ElseIf sSingleSite.ToUpper = "NO" Then
                    sXpathg = "//textarea[@id='addressDescription']"
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Single Site Data Template Value Invalid - Update Data Template then Rerun "
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Single Site Data Template Value Invalid - Update Data Template then Rerun ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo SaveButton
                End If
                Dim sRetVal As String = GetWordText(sGeographicalArea)
                If sRetVal.ToUpper = "FILE NOT FOUND" Then
                    thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpathg))
                    If Not thisObject Is Nothing Then
                        This_Element = DirectCast(thisObject, IWebElement)
                        This_Element.SendKeys(Keys.Control + "a")
                        This_Element.SendKeys(sGeographicalArea)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Geographical Area description was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                    End If
                ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                    thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpathg))
                    If Not thisObject Is Nothing Then
                        This_Element = DirectCast(thisObject, IWebElement)
                        This_Element.SendKeys(Keys.Control + "a")
                        This_Element.SendKeys(Keys.Delete)

                        Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                        This_Element.SendKeys(Keys.Control + "v")

                        mosaicDll.Logger(senderMCPAction, "Actual Result|Geographical Area description was entered from Word document", myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No geographical area description was entered: Processing Continued. ", myLogPath, , actionHistoryRecordID)
            End If

            'find the lookup button
            Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//input"))


            For y As Integer = 1 To inputElements.Count - 1
                If inputElements(y).GetAttribute("value").ToUpper.ToString() = "LOOKUP" Then
                    Dim inputElement As IWebElement = inputElements(y)
                    inputElement.Click()
                    Exit For
                End If
            Next

            If Validate_ZIP.ToUpper <> "NO" Then
                'find and compare the fields
                Dim cityElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:city']"))
                Dim countyElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:county']"))
                Dim StateElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:state']"))
                Dim CongressDElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:conDist']"))
                Dim CensusTrElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:censusTract']"))
                Dim CBSAElement As IWebElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:msa']"))


                Dim bZipLookupPass As Boolean = True
                Dim sZipErrors As String = String.Empty
                If Not cityElement Is Nothing And Not countyElement Is Nothing And Not StateElement Is Nothing Then
                    cityElement = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='pageTemplateForm:city']"))
                    If sCity.ToUpper.ToString <> cityElement.Text.ToUpper.ToString Or sCounty.ToUpper.ToString <> countyElement.Text.ToUpper.ToString() Or sState.ToUpper.ToString() <> StateElement.Text.ToUpper.ToString() Then
                        If sCity.ToUpper.ToString <> cityElement.Text.ToUpper.ToString Then

                            sZipErrors = sZipErrors & " Cities did not match: Template has: " & sCity.ToUpper.ToString & " App has: " & cityElement.Text.ToUpper.ToString & " "
                        End If

                        If sCounty.ToUpper.ToString <> countyElement.Text.ToUpper.ToString Then
                            sZipErrors = sZipErrors & " Counties did not match: Template has: " & sCounty.ToUpper.ToString & " App has: " & countyElement.Text.ToUpper.ToString & " "
                        End If

                        If sState.ToUpper.ToString <> StateElement.Text.ToUpper.ToString Then
                            sZipErrors = sZipErrors & " State did not match: Template has: " & sState.ToUpper.ToString & " App has: " & StateElement.Text.ToUpper.ToString & " "
                        End If
                    End If
                End If
                If Not CongressDElement Is Nothing And Not CensusTrElement Is Nothing And Not CBSAElement Is Nothing Then
                    If sCongressDistrict.ToUpper.ToString <> CongressDElement.Text.ToUpper.ToString Or sCensusTract.ToUpper.ToString <> CensusTrElement.Text.ToUpper.ToString() Or sCBSA.ToUpper.ToString() <> CBSAElement.Text.ToUpper.ToString() Then

                        If sCongressDistrict.ToUpper.ToString <> CongressDElement.Text.ToUpper.ToString And Not sCongressDistrict Is Nothing Then
                            sZipErrors = sZipErrors & " Congressional District did not match: Template has: " & sCongressDistrict.ToUpper.ToString & " App has: " & CongressDElement.Text.ToUpper.ToString & " "
                        End If

                        If sCensusTract.ToUpper.ToString <> CensusTrElement.Text.ToUpper.ToString And Not sCensusTract Is Nothing Then
                            sZipErrors = sZipErrors & " Census Tract did not match: Template has: " & sCensusTract.ToUpper.ToString & " App has: " & CensusTrElement.Text.ToUpper.ToString & " "
                        End If

                        If sCBSA.ToUpper.ToString <> CBSAElement.Text.ToUpper.ToString And Not sCBSA Is Nothing Then
                            sZipErrors = sZipErrors & " CBSA did not match: Template has: " & sCBSA.ToUpper.ToString & " App has: " & CBSAElement.Text.ToUpper.ToString & " "
                        End If
                    End If
                End If
                If Not sZipErrors = String.Empty Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " One or more Zip Code Values Do Not Match Expected Results."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| " & sZipErrors, myLogPath, , actionHistoryRecordID)
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Zip Code Validation Passed", myLogPath, , actionHistoryRecordID)

                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|Skipped Zip Code Validation. ", myLogPath, , actionHistoryRecordID)
            End If

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            Dim sUpdSiteObject As Object = Nothing
            sUpdSiteObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[2]/td/div/fieldset/div[1]/div/table/tbody/tr/td[2]/input"))


            If Not sUpdSiteObject Is Nothing Then
                Dim sElementReq As IWebElement = DirectCast(sUpdSiteObject, IWebElement)
                sElementReq.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked Update Site ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click Update Site."
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not Click Update Site ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


            Dim sXpath2 As String
            If sSingleSite.ToUpper = "YES" Then
                sXpath2 = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[1]/td/div/table/tbody/tr/td[2]"
            Else
                sXpath2 = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr[1]/td/div/table/tbody/tr/td[3]"
            End If

            Dim sAddrinTbl As Object = Nothing
            sAddrinTbl = WaitForElement(driver, WaitForTime, By.XPath(sXpath2))
            If Not sAddrinTbl Is Nothing Then
                Dim sAddrinTblElement As IWebElement = DirectCast(sAddrinTbl, IWebElement)
                If sAddrinTblElement.Text.ToUpper.Trim = sAddrLine1.ToString.ToUpper.Trim Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Central Site Displayed in Site Table " & sAddrLine1.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Unknown Site not Displayed in Site Table"
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Site Table Does not Display Unknown Site Address Line 1: " & sAddrLine1.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Site Table Not Displayed"
                mosaicDll.Logger(senderMCPAction, "Actual Result|Site Table was Not Found ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)


            End If

SaveButton:

            'Click Save
            Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oSave Is Nothing Then
                Dim oSaveElement As IWebElement = DirectCast(oSave, IWebElement)
                oSaveElement.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click the save button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


            Return returnValues

        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Nav_Access_Window_By_Top_Menu(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)

        Try
            Dim this_Object As Object = Nothing
            Dim this_element As IWebElement = Nothing


            Dim sApplication As String = mosaicDll.dt(excelPath, iteration, "mopt2_top_menu_option", "Application")
            Dim sTopMenuOption As String = mosaicDll.dt(excelPath, iteration, "mopt2_top_menu_option", "Top_Menu_Option")
            Dim menuXPath As String = mosaicDll.dt(excelPath, iteration, "mopt2_top_menu_option", "Automation_Xpath")
            Dim sResultingPage As String = mosaicDll.dt(excelPath, iteration, "mopt2_top_menu_option", "Resulting_Page")

            Dim sHomeXPath As String = "/html/body/form/div/a[1]"
            Dim sCurrentMenuPath As String = "/html/body/form/div/span"
            Dim homeObject As Object = Nothing
            Dim homeElement As IWebElement = Nothing
            Dim isHome As Boolean = False

            'Threading.Thread.Sleep(500)

            Dim currentMenuObject As Object = WaitForElement(driver, WaitForTime, By.XPath(sCurrentMenuPath))

            If Not currentMenuObject Is Nothing Then
                Dim CurrentMenuElement As IWebElement = DirectCast(currentMenuObject, IWebElement)
                If CurrentMenuElement.Text.ToUpper = "HOME" Then
                    isHome = True
                End If
                mosaicDll.Logger(senderMCPAction, "Home menu was found. ", myLogPath, , actionHistoryRecordID)
            Else
                mosaicDll.Logger(senderMCPAction, "Home menu was not found. ", myLogPath, , actionHistoryRecordID)
            End If



            If Not sApplication = "AHP Online for Sponsors" Then

                'Threading.Thread.Sleep(500)

                'go the home menu first 
                If Not isHome Then
                    homeObject = WaitForElement(driver, WaitForTime, By.XPath(sHomeXPath))
                    If Not homeObject Is Nothing Then
                        homeElement = DirectCast(homeObject, IWebElement)
                        homeElement.Click()

                    Else

                    End If

                End If
            End If

            'Threading.Thread.Sleep(500)
            'Now find the proper menu to click and click it
            this_Object = WaitForElement(driver, WaitForTime, By.XPath(menuXPath))
            If Not this_Object Is Nothing Then
                this_element = DirectCast(this_Object, IWebElement)
                this_element.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Navigated to: " & sResultingPage, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = "Could not navigage to: " & sResultingPage
                mosaicDll.Logger(senderMCPAction, "Acutal Result | Could not navigate to: " & sResultingPage, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If




            Nav_Access_Window_By_Top_Menu = returnValues


        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Nav_Access_Window_By_Top_Menu = returnValues

        End Try
    End Function
    Public Function Gen4_Enter_Fair_Housing_Data_Save_Clk_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)


        Try
            'check status of field
            Dim thisObject As Object = Nothing
            Dim This_Element As IWebElement
            'thisObject = WaitForElement(driver, WaitForTime, By.XPath("//textarea[@id='description']"))
            'If Not thisObject Is Nothing Then
            '    this_Element = DirectCast(thisObject, IWebElement)
            '    ' this_Element.Clear()
            '    This_Element.SendKeys(Keys.Control + "a")
            '    This_Element.SendKeys(Keys.Delete)
            'End If

            'Find and select the yes option button
            Dim oYesOption As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@name='lawDocQn']"))
            If Not oYesOption Is Nothing Then
                Dim iYes_Element As IWebElement = DirectCast(oYesOption, IWebElement)
                iYes_Element.Click()
                'returnValues(1) = "Clicked the yes option"
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the yes option", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not locate the yes option. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not locate the yes option.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If

            'get all the data for this action from RStar
            Dim sFairHousingDesc As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Fair_Housing_Desc")
            Dim sFairHousingDescDocLocation As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Fair_Housing_Plan_Doc_Loc")
            Dim sFourOrMoreUnits As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Four_or_More_Units")
            Dim sArchAccCert As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Arch_Accessibility_Certif")

            Dim s As String = String.Empty
            Dim sXpath As String

            If Not sFairHousingDescDocLocation = String.Empty Then
                'clear the fh document if it exists

                Dim sFHXPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div[2]/div/div[1]/table[2]/tbody/tr/td[2]/div/div/div/div/div/div[2]/table/tbody/tr/td[2]/input"

                Dim oFairHousingDoc As Object = WaitForElement(driver, WaitForTime, By.XPath(sFHXPath))

                If Not oFairHousingDoc Is Nothing Then
                    Dim oFairHousingElement As IWebElement = DirectCast(oFairHousingDoc, IWebElement)
                    oFairHousingElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Removed the previous Fair Housing document.", myLogPath, , actionHistoryRecordID)
                End If

            End If



            If Not String.IsNullOrEmpty(sFairHousingDesc) Then
                System.Windows.Forms.Clipboard.Clear()

                Dim sRetVal As String = GetWordText(sFairHousingDesc)
                If sRetVal.ToUpper = "FILE NOT FOUND" Then
                    sXpath = "//textarea[@id='description']"
                    thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not thisObject Is Nothing Then
                        This_Element = DirectCast(thisObject, IWebElement)
                        This_Element.SendKeys(Keys.Control + "a")
                        This_Element.SendKeys(sFairHousingDesc)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Fair housing description was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                    End If
                ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                    sXpath = "//textarea[@id='description']"
                    thisObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not thisObject Is Nothing Then
                        This_Element = DirectCast(thisObject, IWebElement)
                        This_Element.SendKeys(Keys.Control + "a")
                        This_Element.SendKeys(Keys.Delete)

                        Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                        This_Element.SendKeys(Keys.Control + "v")

                        mosaicDll.Logger(senderMCPAction, "Actual Result|Fair housing description was entered from Word document.", myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No project description was entered for fair housing description: Processing Continued. ", myLogPath, , actionHistoryRecordID)
            End If


            Dim bSetFile As Boolean = False

            'if there is a file location set select it
            If Not sFairHousingDescDocLocation = String.Empty Then
                If Not System.IO.File.Exists(sFairHousingDescDocLocation) Then
                    'message
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "The file named: " & sFairHousingDescDocLocation & " was not found."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sFairHousingDescDocLocation & " was not found.", myLogPath, , actionHistoryRecordID)
                    GoTo NextStep
                End If
                Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:attachFile']"))
                If Not oAttachFile Is Nothing Then
                    Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                    oAttachFileElement.Click()
                    oAttachFileElement.SendKeys(sFairHousingDescDocLocation)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Attached fair housing document.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not attach file named: " & sFairHousingDescDocLocation
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sFairHousingDescDocLocation, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextStep
                End If
            End If

NextStep:

            If Not sFourOrMoreUnits = String.Empty And sFourOrMoreUnits.ToUpper.ToString() = "YES" Then
                Dim oFourOrMore As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='moreThanFourUnitQn']/tbody/tr/td[1]/label"))
                If Not oFourOrMore Is Nothing Then
                    Dim oFourOrMoreElement As IWebElement = DirectCast(oFourOrMore, IWebElement)
                    oFourOrMoreElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Selected four or more option yes.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Actual Result | Could not click yes for four units or more option."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select four or more option yes.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo SaveButton
                End If
            Else
                'No
                Dim oFourOrMore As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='moreThanFourUnitQn']/tbody/tr/td[2]/label"))
                If Not oFourOrMore Is Nothing Then
                    Dim oFourOrMoreElement As IWebElement = DirectCast(oFourOrMore, IWebElement)
                    oFourOrMoreElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Selected four or more option no.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Actual Result | Could not select four or more option no. "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select four or more option no.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo SaveButton
                End If
            End If

            'Clear the Acc Cert Doc 
            Dim sCertFHXPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div[2]/div/div[3]/div/table/tbody/tr/td[3]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
            Dim oAccCertDoc As Object = WaitForElement(driver, WaitForTime, By.XPath(sCertFHXPath))
            If Not oAccCertDoc Is Nothing Then
                Dim oAccCertElement As IWebElement = DirectCast(oAccCertDoc, IWebElement)
                oAccCertElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Removed the previous Accessibility Cert.", myLogPath, , actionHistoryRecordID)
            End If

            'if certificate has a path open the word document and select all text
            If Not sArchAccCert.ToUpper = String.Empty Then
                If Not System.IO.File.Exists(sArchAccCert) Then
                    'message
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "The file named: " & sArchAccCert & " was not found."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sArchAccCert & " was not found.", myLogPath, , actionHistoryRecordID)
                    GoTo SaveButton
                End If
                Dim oAccCert As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:accessibilityCertificate']"))
                If Not oAccCert Is Nothing Then
                    Dim oAccCertElement As IWebElement = DirectCast(oAccCert, IWebElement)
                    oAccCertElement.Click()
                    oAccCertElement.SendKeys(sArchAccCert)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Attached the file " & sArchAccCert.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Actual Result | Could not select the architectual certificate file name. "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select the architectual certificate file name. ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If

            End If

SaveButton:

            'Click Save
            Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oSave Is Nothing Then
                Dim oSaveElement As IWebElement = DirectCast(oSave, IWebElement)
                oSaveElement.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click the save button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


NextButton:
            'click next
            Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext Is Nothing Then
                Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
                oNextElement.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & " Could not click the next button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

        Catch ex As Exception


            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Gen4_Enter_Fair_Housing_Data_Save_Clk_Next = returnValues
        End Try
    End Function
    Public Function Gen5a_Subsidy_Funds_Othr_Bank(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            Dim sGrantAmount As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Grant_Amt")
            Dim sAcquistion As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Assist_Acquisition_Costs_Use")
            Dim sAcqDownPaymentAssistanceUse As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Acquisition_Down_Payment_Assist_Use")
            Dim sAcqDownFinance As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Acquisition_Finan_Literacy_HomeBuyer_Consul_Use")
            Dim sRefinanceUse As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Refinance_Use")
            Dim sOtherUse As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Other_Use")
            Dim sOtherUseDescription As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Other_Use_Descr")

            Dim sNewConstruction As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "New_Construction_Use")
            Dim sRehabilitation As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Rehabilitation_Use")

            Dim sProjectType As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Type")
            Dim sAcqClosedCostUse As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Acquisition_Closing_Costs_Use")

            Dim sHowMuchSubsidy As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "How_much_Subsidy_Fin_Lit?")
            Dim sEstTotCostFinLit As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Est_tot_cost_Fin_Lit")
            Dim sAHPSpecRetention As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "AHP_Spec_Retention")
            Dim sSubmittedToAnotherForFunding As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Submitted_to_Another_FHLB_for_Funding")


            Dim myAutoMate As New AutomationObject
            Dim tableElement As IWebElement
            Dim rowCollection As IEnumerable(Of IWebElement)

            'if there is a grant amount then enter it.
            If Not sGrantAmount = String.Empty Then
                myAutoMate.aObject = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:grantAmount"))
                If Not myAutoMate.aObject Is Nothing Then
                    myAutoMate.aElement = DirectCast(myAutoMate.aObject, IWebElement)
                    myAutoMate.aElement.SendKeys(Keys.Control + "a")
                    myAutoMate.aElement.SendKeys(sGrantAmount)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Entered the grant amount: " & sGrantAmount, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter the grant amount."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the grant amount.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No grant amount specified: skipped.", myLogPath, , actionHistoryRecordID)
            End If


            'load up a generic list of strings with the check box xpaths
            Dim lstOfXPaths As New List(Of String)

            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[2]/td/table/tbody/tr[1]/td/label/input")
            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[2]/td/table/tbody/tr[2]/td/label/input")
            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[2]/td/table/tbody/tr[3]/td/label/input")

            'the 4th check box is either other or refinance
            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[2]/td/table/tbody/tr[4]/td/label/input")
            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[2]/td/table/tbody/tr[5]/td/label/input")

            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[3]/td/div/table/tbody/tr[1]/td/label/input")
            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[3]/td/div/table/tbody/tr[2]/td/label/input")
            lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[3]/td/div/table/tbody/tr[3]/td/label/input")

            'this is refinance
            ' lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[2]/td/table/tbody/tr[4]/td/label/input")

            'This is other if refinance is enabled
            'lstOfXPaths.Add("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/table/tbody/tr[2]/td/table/tbody/tr[5]/td/label/input")

            'Lets get an automation object to use here
            Dim cdAutomate As New AutomationObject



            Dim bIsSelected As Boolean = False

            'Acquisition
            If Not sAcquistion.ToString.ToUpper.Trim = String.Empty Then
                tableElement = driver.FindElement(By.XPath("//table[@id='fundsType']"))
                rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='fundsType']/tbody/tr"))
                For Each row As IWebElement In rowCollection
                    If row.Text.ToUpper.Trim.ToString = "ASSISTANCE WITH ACQUISITION COSTS" Then
                        cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(0))) 'This locates the xpath reference in the generic list
                        If Not cdAutomate.aObject Is Nothing Then
                            cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                            'check if there is an x in the check box already and the data wants the box checked
                            'the and portion is really unecessary but ....

                            If sAcquistion.ToString.ToUpper.Trim = "X" Then
                                If cdAutomate.aElement.Selected = True Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Checked ASSISTANCE WITH ACQUISITION COSTS.", myLogPath, , actionHistoryRecordID)
                            ElseIf sAcquistion.ToString.ToUpper.Trim = "R" Then
                                If cdAutomate.aElement.Selected = False Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Un-Checked ASSISTANCE WITH ACQUISITION COSTS.", myLogPath, , actionHistoryRecordID)
                            End If
                            bIsSelected = True 'this means is the check box in the correct state based on the data
                            mosaicDll.Logger(senderMCPAction, "senderMCPAction|Found and Processed ASSISTANCE WITH ACQUISITION COSTS.", myLogPath, , actionHistoryRecordID)

                        End If

                    End If
                Next
                If Not bIsSelected Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not find: ASSISTANCE WITH ACQUISITION COSTS."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: ASSISTANCE WITH ACQUISITION COSTS.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If


            bIsSelected = False
            If Not sNewConstruction.ToString.ToUpper.Trim = String.Empty Then
                tableElement = driver.FindElement(By.XPath("//table[@id='fundsType']"))
                rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='fundsType']/tbody/tr"))
                For Each row As IWebElement In rowCollection
                    If row.Text.ToUpper.Trim.ToString = "NEW CONSTRUCTION" Then

                        cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(1)))
                        If Not cdAutomate.aObject Is Nothing Then
                            cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                            If sNewConstruction.ToString.ToUpper.Trim = "X" Then
                                If cdAutomate.aElement.Selected = True Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Checked NEW CONSTRUCTION.", myLogPath, , actionHistoryRecordID)
                            ElseIf sNewConstruction.ToString.ToUpper.Trim = "R" Then
                                If cdAutomate.aElement.Selected = False Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Un-checked NEW CONSTRUCTION.", myLogPath, , actionHistoryRecordID)
                            End If
                            bIsSelected = True
                        End If

                    End If
                Next
                If Not bIsSelected Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not find: NEW CONSTRUCTION."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: NEW CONSTRUCTION.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If



            bIsSelected = False
            If Not sRehabilitation.ToString.ToUpper.Trim = String.Empty Then
                tableElement = driver.FindElement(By.XPath("//table[@id='fundsType']"))
                rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='fundsType']/tbody/tr"))
                For Each row As IWebElement In rowCollection
                    If row.Text.ToUpper.Trim.ToString = "REHABILITATION" Then
                        cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(2)))
                        If Not cdAutomate.aObject Is Nothing Then
                            cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                            If sRehabilitation.ToString.ToUpper.Trim = "X" Then
                                If cdAutomate.aElement.Selected = True Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result|Checked REHABILITATION.", myLogPath, , actionHistoryRecordID)
                            ElseIf sRehabilitation.ToString.ToUpper.Trim = "R" Then
                                If cdAutomate.aElement.Selected = False Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Un-checked REHABILITATION.", myLogPath, , actionHistoryRecordID)
                            End If
                            bIsSelected = True
                            mosaicDll.Logger(senderMCPAction, "senderMCPAction|Found and Processed REHABILITATION.", myLogPath, , actionHistoryRecordID)

                        End If

                    End If
                Next
                If Not bIsSelected Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not find: REHABILITATION."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: REHABILITATION.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If


            'add project type check
            bIsSelected = False
            If Not sOtherUse.ToString.ToUpper.Trim = String.Empty Then
                tableElement = driver.FindElement(By.XPath("//table[@id='fundsType']"))
                rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='fundsType']/tbody/tr"))
                For Each row As IWebElement In rowCollection
                    If row.Text.ToUpper.Trim.ToString = "OTHER" Then
                        If Not sProjectType.ToUpper.Trim = "HOME OWNERSHIP" Then
                            cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(4)))
                        Else
                            cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(3)))
                        End If

                        If Not cdAutomate.aObject Is Nothing Then
                            cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                            If sOtherUse.ToString.ToUpper.Trim = "X" Then
                                If cdAutomate.aElement.Selected = True Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Checked OTHER.", myLogPath, , actionHistoryRecordID)
                            ElseIf sOtherUse.ToString.ToUpper.Trim = "R" Then
                                If cdAutomate.aElement.Selected = False Then
                                    'proper state
                                Else
                                    cdAutomate.aElement.Click()
                                End If
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Un-checked OTHER.", myLogPath, , actionHistoryRecordID)
                            End If
                            bIsSelected = True
                        End If

                    End If
                Next
                If Not bIsSelected Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not find: OTHER."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: OTHER.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If



            bIsSelected = False

            If Not sProjectType.ToUpper.Trim = "HOME OWNERSHIP" Then
                If Not sRefinanceUse.ToUpper.Trim = String.Empty Then
                    tableElement = driver.FindElement(By.XPath("//table[@id='fundsType']"))
                    rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='fundsType']/tbody/tr"))
                    For Each row As IWebElement In rowCollection
                        If row.Text.ToUpper.Trim.ToString = "REFINANCE" Then
                            cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(3)))
                            If Not cdAutomate.aObject Is Nothing Then
                                cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                                If sRefinanceUse.ToString.ToUpper.Trim = "X" Then
                                    If cdAutomate.aElement.Selected = True Then
                                        'proper state
                                    Else
                                        cdAutomate.aElement.Click()
                                    End If
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Checked REFINANCE.", myLogPath, , actionHistoryRecordID)
                                ElseIf sRefinanceUse.ToString.ToUpper.Trim = "R" Then
                                    If cdAutomate.aElement.Selected = False Then
                                        'proper state
                                    Else
                                        cdAutomate.aElement.Click()
                                    End If
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Un-checked REFINANCE.", myLogPath, , actionHistoryRecordID)
                                End If
                                bIsSelected = True
                            End If

                        End If
                    Next
                    If Not bIsSelected Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not find: REFINANCE."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: REFINANCE.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
            End If


            '//table[@id='childfundsType']/tbody/tr[1]/td/label
            bIsSelected = False
            If sProjectType.ToUpper.Trim = "HOME OWNERSHIP" And sAcquistion.ToUpper.Trim = "X" Then
                If Not sAcqClosedCostUse.ToUpper.Trim = String.Empty Then
                    tableElement = driver.FindElement(By.XPath("//table[@id='childfundsType']"))
                    rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='childfundsType']/tbody/tr"))
                    For Each row As IWebElement In rowCollection
                        If row.Text.ToUpper.Trim.ToString = "CLOSING COSTS" Then
                            cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(5)))
                            If Not cdAutomate.aObject Is Nothing Then
                                cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                                If sAcqClosedCostUse.ToString.ToUpper.Trim = "X" Then
                                    If cdAutomate.aElement.Selected = True Then
                                        'proper state
                                    Else
                                        cdAutomate.aElement.Click()
                                    End If
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Checked CLOSING COSTS.", myLogPath, , actionHistoryRecordID)
                                ElseIf sAcqClosedCostUse.ToString.ToUpper.Trim = "R" Then
                                    If cdAutomate.aElement.Selected = False Then
                                        'proper state
                                    Else
                                        cdAutomate.aElement.Click()
                                    End If
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Un-checked CLOSING COSTS.", myLogPath, , actionHistoryRecordID)
                                End If
                                bIsSelected = True
                            End If

                        End If
                    Next
                    If Not bIsSelected Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not find: CLOSING COSTS."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: CLOSING COSTS.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If

                bIsSelected = False
                If Not sAcqDownPaymentAssistanceUse.ToUpper.Trim = String.Empty Then
                    tableElement = driver.FindElement(By.XPath("//table[@id='childfundsType']"))
                    rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='childfundsType']/tbody/tr"))
                    For Each row As IWebElement In rowCollection
                        If row.Text.ToUpper.Trim.ToString = "DOWN PAYMENT ASSISTANCE" Then
                            cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(6)))
                            If Not cdAutomate.aObject Is Nothing Then
                                cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                                If sAcqDownPaymentAssistanceUse.ToString.ToUpper.Trim = "X" Then
                                    If cdAutomate.aElement.Selected = True Then
                                        'proper state
                                    Else
                                        cdAutomate.aElement.Click()
                                    End If
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Checked DOWN PAYMENT ASSISTANCE.", myLogPath, , actionHistoryRecordID)
                                ElseIf sAcqDownPaymentAssistanceUse.ToString.ToUpper.Trim = "R" Then
                                    If cdAutomate.aElement.Selected = False Then
                                        'proper state
                                    Else
                                        cdAutomate.aElement.Click()
                                    End If
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Un-checked DOWN PAYMENT ASSISTANCE.", myLogPath, , actionHistoryRecordID)
                                End If
                                bIsSelected = True
                            End If



                        End If
                    Next
                    If Not bIsSelected Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not find: DOWN PAYMENT ASSISTANCE."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: DOWN PAYMENT ASSISTANCE.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If

                bIsSelected = False

                If Not sAcqDownFinance.ToUpper.Trim = String.Empty Then
                    tableElement = driver.FindElement(By.XPath("//table[@id='childfundsType']"))
                    rowCollection = WaitForElements(driver, WaitForTime, tableElement, By.XPath("//table[@id='childfundsType']/tbody/tr"))
                    For Each row As IWebElement In rowCollection
                        If row.Text.ToUpper.Trim.ToString = "FINANCIAL LITERACY/HOMEBUYER COUNSELING" Then
                            cdAutomate.aObject = WaitForElement(driver, WaitForTime, By.XPath(lstOfXPaths(7)))
                            If Not cdAutomate.aObject Is Nothing Then
                                cdAutomate.aElement = DirectCast(cdAutomate.aObject, IWebElement)
                                If sAcqDownFinance.ToString.ToUpper.Trim = "X" Then
                                    If cdAutomate.aElement.Selected = True Then
                                        'proper state
                                        mosaicDll.Logger(senderMCPAction, "Actual Result| Checked FINANCIAL LITERACY/HOMEBUYER COUNSELING.", myLogPath, , actionHistoryRecordID)
                                        If Not sHowMuchSubsidy = String.Empty Then
                                            Dim a As New AutomationObject
                                            a.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='subsidyFinancialHomebuyerCouseling']"))
                                            If Not a.aObject Is Nothing Then
                                                a.aElement = DirectCast(a.aObject, IWebElement)
                                                a.aElement.SendKeys(Keys.Control + "a")
                                                a.aElement.SendKeys(sHowMuchSubsidy)
                                                mosaicDll.Logger(senderMCPAction, "Actual Result|Entered AHP grant subsidy for financial literacy: " & sHowMuchSubsidy, myLogPath, , actionHistoryRecordID)

                                            Else
                                                returnValues(0) = executionStatusFailed
                                                returnValues(1) = returnValues(1) & " Could not enter AHP subsidy used for financial literacy."
                                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter AHP subsidy used for financial literacy. ", myLogPath, , actionHistoryRecordID)
                                                CaptureScreenshot(actionHistoryRecordID)
                                            End If
                                        End If
                                        If Not sEstTotCostFinLit = String.Empty Then
                                            Dim b As New AutomationObject
                                            b.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='totalCostFinancialHomebuyerCouseling']"))
                                            If Not b.aObject Is Nothing Then
                                                b.aElement = DirectCast(b.aObject, IWebElement)
                                                b.aElement.SendKeys(Keys.Control + "a")
                                                b.aElement.SendKeys(sEstTotCostFinLit)
                                                mosaicDll.Logger(senderMCPAction, "Actual Result|Entered estimated total cost of financial literacy: " & sEstTotCostFinLit, myLogPath, , actionHistoryRecordID)

                                            Else
                                                returnValues(0) = executionStatusFailed
                                                returnValues(1) = returnValues(1) & " Could not enter estimated total cost of financial literacy."
                                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter estimated total cost of financial literacy.", myLogPath, , actionHistoryRecordID)
                                                CaptureScreenshot(actionHistoryRecordID)
                                            End If
                                        End If
                                    Else
                                        cdAutomate.aElement.Click()
                                        mosaicDll.Logger(senderMCPAction, "Actual Result| Checked FINANCIAL LITERACY/HOMEBUYER COUNSELING.", myLogPath, , actionHistoryRecordID)
                                        If Not sHowMuchSubsidy = String.Empty Then
                                            Dim a As New AutomationObject
                                            a.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='subsidyFinancialHomebuyerCouseling']"))
                                            If Not a.aObject Is Nothing Then
                                                a.aElement = DirectCast(a.aObject, IWebElement)
                                                a.aElement.SendKeys(Keys.Control + "a")
                                                a.aElement.SendKeys(sHowMuchSubsidy)
                                                mosaicDll.Logger(senderMCPAction, "Actual Result|Entered AHP grant subsidy for financial literacy: " & sHowMuchSubsidy, myLogPath, , actionHistoryRecordID)
                                            Else
                                                returnValues(0) = executionStatusFailed
                                                returnValues(1) = returnValues(1) & " Could not enter AHP subsidy used for financial literacy."
                                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter AHP subsidy used for financial literacy. ", myLogPath, , actionHistoryRecordID)
                                                CaptureScreenshot(actionHistoryRecordID)
                                            End If
                                        End If
                                        If Not sEstTotCostFinLit = String.Empty Then
                                            Dim b As New AutomationObject
                                            b.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='totalCostFinancialHomebuyerCouseling']"))
                                            If Not b.aObject Is Nothing Then
                                                b.aElement = DirectCast(b.aObject, IWebElement)
                                                b.aElement.SendKeys(Keys.Control + "a")
                                                b.aElement.SendKeys(sEstTotCostFinLit)
                                                mosaicDll.Logger(senderMCPAction, "Actual Result|Entered estimated total cost of financial literacy: " & sEstTotCostFinLit, myLogPath, , actionHistoryRecordID)
                                            Else
                                                returnValues(0) = executionStatusFailed
                                                returnValues(1) = returnValues(1) & " Could not enter estimated total cost of financial literacy."
                                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter estimated total cost of financial literacy.", myLogPath, , actionHistoryRecordID)
                                                CaptureScreenshot(actionHistoryRecordID)
                                            End If
                                        End If
                                    End If
                                ElseIf sAcqDownFinance.ToString.ToUpper.Trim = "R" Then
                                    If cdAutomate.aElement.Selected = False Then
                                        'proper state
                                    Else
                                        cdAutomate.aElement.Click()
                                    End If
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Un-Checked FINANCIAL LITERACY/HOMEBUYER COUNSELING.", myLogPath, , actionHistoryRecordID)
                                End If

                                bIsSelected = True
                                mosaicDll.Logger(senderMCPAction, "senderMCPAction|Found and Processed FINANCIAL LITERACY/HOMEBUYER COUNSELING.", myLogPath, , actionHistoryRecordID)
                            End If

                        End If
                    Next
                    If Not bIsSelected Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not find: FINANCIAL LITERACY/HOMEBUYER COUNSELING."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find: FINANCIAL LITERACY/HOMEBUYER COUNSELING.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo MortgageNext
                    End If

                End If
            End If

            Dim this_Object As Object = Nothing
            Dim this_Element As IWebElement = Nothing
            Dim sXPath As String = String.Empty

            If sOtherUse.ToString.ToUpper.Trim = "X" And Not sOtherUseDescription = String.Empty Then
                System.Windows.Forms.Clipboard.Clear()

                Dim sRetVal As String = GetWordText(sOtherUseDescription)
                If sRetVal.ToUpper = "FILE NOT FOUND" Then
                    sXPath = "//textarea[@id='otherOptionDescription']"
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.SendKeys(Keys.Control + "a")
                        this_Element.SendKeys(sOtherUseDescription)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Entered other uses of funds description: Typed in.", myLogPath, , actionHistoryRecordID)
                    End If
                ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                    sXPath = "//textarea[@id='otherOptionDescription']"
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath(sXPath))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.SendKeys(Keys.Control + "a")
                        this_Element.SendKeys(Keys.Delete)

                        Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                        this_Element.SendKeys(Keys.Control + "v")
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Entered other uses of funds description: From file." & sOtherUseDescription, myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "Error message from get word text function"

                End If
            End If

MortgageNext:
            If Not String.IsNullOrEmpty(sAHPSpecRetention) Then
                Dim element As IWebElement = driver.FindElement(By.XPath("//Select"))
                Dim AllDropDownList As IList(Of IWebElement) = element.FindElements(By.XPath("//option"))
                Dim DpListCount As Integer = AllDropDownList.Count

                bIsSelected = False

                For i As Integer = 0 To DpListCount - 1
                    If AllDropDownList(i).Text.Trim.ToUpper = sAHPSpecRetention.ToUpper Then
                        AllDropDownList(i).Click()
                        bIsSelected = True
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Selected AHP specific retention.", myLogPath, , actionHistoryRecordID)
                    End If
                Next
                If Not bIsSelected Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "Could not select AHP specific retention."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not select AHP specific retention." & sAHPSpecRetention, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
            Dim FundingXPath As String = String.Empty

            If sSubmittedToAnotherForFunding.ToUpper.Trim = "YES" Then
                FundingXPath = "//table[@id='anotherBankRadio']/tbody/tr/td[1]/label"
            ElseIf sSubmittedToAnotherForFunding.ToUpper.Trim = "NO" Then
                FundingXPath = "//table[@id='anotherBankRadio']/tbody/tr/td[2]/label"
            ElseIf Not sSubmittedToAnotherForFunding.ToUpper.Trim = String.Empty Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " " & "Unrecognized value specified for Has application been submitted to another FHLB."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Unrecognized value specified for Has application been submitted to another FHLB: " & sSubmittedToAnotherForFunding.ToUpper.Trim, myLogPath, , actionHistoryRecordID)
                GoTo SkipSubmittedToFHLBQuestion
            Else
                GoTo SkipSubmittedToFHLBQuestion
            End If

            this_Object = WaitForElement(driver, WaitForTime, By.XPath(FundingXPath))
            If Not this_Object Is Nothing Then
                this_Element = DirectCast(this_Object, IWebElement)
                this_Element.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Selected the value for submitted to another for funding: " & sSubmittedToAnotherForFunding.ToUpper.Trim, myLogPath, , actionHistoryRecordID)
                ' wait for FHLB area so there for next action
                'this_Object = WaitForElement(driver, WaitForTime, By.XPath("//select[@id='pageTemplateForm:fhlb']"))
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " " & "Could not select the value for submitted to another for funding."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not select the value for submitted to another for funding: " & sSubmittedToAnotherForFunding.ToUpper.Trim, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)

            End If

SkipSubmittedToFHLBQuestion:

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function

    Public Function Gen5b_Clk_Add_Up_to_3_FHLB(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sFHLBCCity1 As String = mosaicDll.dt(excelPath, iteration, "subsdy_subsidy_fhlb_loc_amounts", "FHLB1_City")
            Dim sAmount1 As String = mosaicDll.dt(excelPath, iteration, "subsdy_subsidy_fhlb_loc_amounts", "Amount1")
            Dim sNbrFHLBC As String = mosaicDll.dt(excelPath, iteration, "subsdy_subsidy_fhlb_loc_amounts", " Nbr_of_FHLBs")

            Dim sFHLBCCity2 As String = mosaicDll.dt(excelPath, iteration, "subsdy_subsidy_fhlb_loc_amounts", "FHLB2_City")
            Dim sAmount2 As String = mosaicDll.dt(excelPath, iteration, "subsdy_subsidy_fhlb_loc_amounts", "Amount2")

            Dim sFHLBCCity3 As String = mosaicDll.dt(excelPath, iteration, "subsdy_subsidy_fhlb_loc_amounts", "FHLB3_City")
            Dim sAmount3 As String = mosaicDll.dt(excelPath, iteration, "subsdy_subsidy_fhlb_loc_amounts", "Amount3")

            Dim elem As IWebElement = driver.FindElement(By.XPath("//select[@id='pageTemplateForm:fhlb']"))
            Dim FoundREO As Boolean = False
            Dim selectList As New SelectElement(elem)
            Dim options As IList(Of IWebElement) = selectList.Options

            If Not String.IsNullOrEmpty(sFHLBCCity1) Then
                'Select City 
                Dim FoundOption As Boolean = False
                elem = driver.FindElement(By.XPath("//select[@id='pageTemplateForm:fhlb']"))

                selectList = New SelectElement(elem)
                options = selectList.Options

                For Each myelement As IWebElement In options
                    If CleanString(myelement.Text) = CleanString(sFHLBCCity1) Then
                        myelement.Click()
                        FoundOption = True
                        Exit For
                    End If
                Next

                If FoundOption = True Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Selected FHLB Location: " & sFHLBCCity1.ToString, myLogPath, , actionHistoryRecordID)
                    If Not String.IsNullOrEmpty(sAmount1) Then
                        Dim AppAmt As New AutomationObject
                        AppAmt.aObject = driver.FindElement(By.XPath("//input[@id='pageTemplateForm:amount']"))
                        AppAmt.aElement = DirectCast(AppAmt.aObject, IWebElement)
                        AppAmt.aElement.SendKeys(Keys.Control + "a")
                        AppAmt.aElement.SendKeys(sAmount1)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Amount and Entered: " & sAmount1.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter Amount."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAmount1.ToString & " in Amount.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo SecondFHLBC
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not select FHLB At."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select " & sFHLBCCity1.ToString & " from FHLB At.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo SecondFHLBC
                End If
            Else
                GoTo SecondFHLBC
            End If
            ' Click Add to add first FHLBC
            Dim FHLBAdd As New AutomationObject
            FHLBAdd.aObject = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[10]/td/div/fieldset/table/tbody/tr/td[3]/span/input"))
            If Not FHLBAdd.aObject Is Nothing Then
                FHLBAdd.aElement = DirectCast(FHLBAdd.aObject, IWebElement)
                FHLBAdd.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Add to Add Amount for: " & sFHLBCCity1.ToString, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter Add to Add FHLB and Amt."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Add to Add FHLB and Amt for: " & sFHLBCCity1.ToString, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo SecondFHLBC
            End If

SecondFHLBC:
            If Not String.IsNullOrEmpty(sFHLBCCity2) Then
                'Select City 
                Dim FoundOption As Boolean = False
                elem = driver.FindElement(By.XPath("//select[@id='pageTemplateForm:fhlb']"))

                selectList = New SelectElement(elem)
                options = selectList.Options

                For Each myelement As IWebElement In options
                    If myelement.Text.ToUpper = CleanString(sFHLBCCity2) Then
                        myelement.Click()
                        FoundOption = True
                        Exit For
                    End If
                Next

                If FoundOption = True Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Selected FHLB Location: " & sFHLBCCity2.ToString, myLogPath, , actionHistoryRecordID)
                    If Not String.IsNullOrEmpty(sAmount2) Then
                        Dim AppAmt As New AutomationObject
                        AppAmt.aObject = driver.FindElement(By.XPath("//input[@id='pageTemplateForm:amount']"))
                        AppAmt.aElement = DirectCast(AppAmt.aObject, IWebElement)
                        AppAmt.aElement.SendKeys(Keys.Control + "a")
                        AppAmt.aElement.SendKeys(sAmount2)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Amount and Entered: " & sAmount2.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter Amount."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAmount2.ToString & " in Amount.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ThirdFHLB
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not select FHLB At."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select " & sFHLBCCity2.ToString & " from FHLB At.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo ThirdFHLB
                End If
            Else
                GoTo ThirdFHLB
            End If

            ' Click Add to add second FHLBC
            Dim FHLBAdd2 As New AutomationObject
            FHLBAdd2.aObject = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[10]/td/div/fieldset/table/tbody/tr/td[3]/span/input"))
            If Not FHLBAdd2.aObject Is Nothing Then
                FHLBAdd2.aElement = DirectCast(FHLBAdd2.aObject, IWebElement)
                FHLBAdd2.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Add to Add Amount for: " & sFHLBCCity2.ToString, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter Add to Add FHLB and Amt."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Add to Add FHLB and Amt for: " & sFHLBCCity2.ToString, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo ThirdFHLB
            End If

ThirdFHLB:
            If Not String.IsNullOrEmpty(sFHLBCCity3) Then
                'Select City 
                Dim FoundOption As Boolean = False
                elem = driver.FindElement(By.XPath("//select[@id='pageTemplateForm:fhlb']"))

                selectList = New SelectElement(elem)
                options = selectList.Options

                For Each myelement As IWebElement In options
                    If myelement.Text.ToUpper = CleanString(sFHLBCCity3) Then
                        myelement.Click()
                        FoundOption = True
                        Exit For
                    End If
                Next

                If FoundOption = True Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Selected FHLB Location: " & sFHLBCCity3.ToString, myLogPath, , actionHistoryRecordID)
                    If Not String.IsNullOrEmpty(sAmount3) Then
                        Dim AppAmt As New AutomationObject
                        AppAmt.aObject = driver.FindElement(By.XPath("//input[@id='pageTemplateForm:amount']"))
                        AppAmt.aElement = DirectCast(AppAmt.aObject, IWebElement)
                        AppAmt.aElement.SendKeys(Keys.Control + "a")
                        AppAmt.aElement.SendKeys(sAmount3)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Amount and Entered: " & sAmount3.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter Amount."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAmount3.ToString & " in Amount.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo Done
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not select FHLB At."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not select " & sFHLBCCity3.ToString & " from FHLB At.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo Done
                End If
            Else
                GoTo Done
            End If

            ' Click Add to add second FHLBC
            Dim FHLBAdd3 As New AutomationObject
            FHLBAdd3.aObject = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[10]/td/div/fieldset/table/tbody/tr/td[3]/span/input"))
            If Not FHLBAdd3.aObject Is Nothing Then
                FHLBAdd3.aElement = DirectCast(FHLBAdd3.aObject, IWebElement)
                FHLBAdd3.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Add to Add Amount for: " & sFHLBCCity3.ToString, myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter Add to Add FHLB and Amt."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Add to Add FHLB and Amt for: " & sFHLBCCity3.ToString, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Done
            End If

Done:

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues

        End Try
    End Function
    Public Function Gen5c_Ind_if_Prev_Sub_Ent_Prev_Submit_Save(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sPreviouslySubmitted As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Application_Prev_Submitted")
            Dim sPreviousAppNbr As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Prev_App_Number")
            Dim sPreviousAppName As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Prev_App_Name")

            Dim nextPath As String = "//div[@id='tab']/table[4]/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = Nothing

            If CleanString(sPreviouslySubmitted) = "NO" Then
                optionPath = "//table[@id='fundedRadio']/tbody/tr/td[2]/label"
            ElseIf CleanString(sPreviouslySubmitted) = "YES" Then
                optionPath = "//table[@id='fundedRadio']/tbody/tr/td[1]/label"
            ElseIf Not String.IsNullOrEmpty(sPreviouslySubmitted) Then
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Unknown value specified for application previously submitted: " & sPreviouslySubmitted & ". Expected Yes or No", myLogPath, , actionHistoryRecordID)
                GoTo ClickSave
            Else
                GoTo EnterPrevSubm
            End If

            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sPreviouslySubmitted & " button for application previously submitted.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the " & sPreviouslySubmitted & " button for application previously submitted.", myLogPath, , actionHistoryRecordID)
                GoTo ClickSave
            End If

EnterPrevSubm:
            Dim p As New AutomationObject
            If Not CleanString(sPreviouslySubmitted) = "NO" Then
                If Not String.IsNullOrEmpty(sPreviousAppNbr) Then
                    p.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='previousApplicationNum']"))
                    If Not p.aObject Is Nothing Then
                        p.aElement = DirectCast(p.aObject, IWebElement)
                        p.aElement.SendKeys(Keys.Control + "a")
                        p.aElement.SendKeys(sPreviousAppNbr)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Entered the Previous Application ID: " & sPreviousAppNbr, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter the previous application ID."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the Previous Application ID.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
                If Not String.IsNullOrEmpty(sPreviousAppName) Then
                    Dim TextAreaInfo As New TextAreaParms
                    TextAreaInfo.TextToEnter = sPreviousAppName
                    TextAreaInfo.TextAreaXpath = "//textarea[@id='previousApplicationName']"
                    Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Previous project name(s)")
                End If
            End If


ClickSave:
            'click save button
            Dim savebutton As New AutomationObject
            savebutton.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not savebutton.aObject Is Nothing Then
                savebutton.aElement = DirectCast(savebutton.aObject, IWebElement)
                savebutton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            nextbutton.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not nextbutton.aObject Is Nothing Then
                nextbutton.aElement = DirectCast(nextbutton.aObject, IWebElement)
                nextbutton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If


            Return returnValues

        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Sc1T_Enter_Targeting_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            Dim sTargetLTEQ50 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Target_LT_EQ_50%")
            Dim sTargetGT50LT60 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Target_GT_50%_LT_EQ_60%")
            Dim sTargetGT60LTEQ80 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Target_GT_60%_LT_EQ_80%")
            Dim sTargetGT80 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Target_GT_80%")
            Dim sTargetTotal As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Target_Total")
            Dim sTargetLTEQ30 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Target_LT_EQ_30%")

            If Not sTargetLTEQ50 = String.Empty Then
                Dim sEObject As Object = Nothing
                sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='units[0]']"))


                'if you find the target LT or EQ field then type in the the units
                If Not sEObject Is Nothing Then
                    Dim sElementTarget50 As IWebElement = DirectCast(sEObject, IWebElement)
                    sElementTarget50.SendKeys(Keys.Control + "a")
                    sElementTarget50.SendKeys(sTargetLTEQ50)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the Less than or equal 50% AMI field and entered the units " & sTargetLTEQ50.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the 50% AMI Units."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the 50% AMI Units: " & sTargetLTEQ50.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
            If Not sTargetGT50LT60 = String.Empty Then
                Dim sEObject As Object = Nothing
                sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='units[1]']"))
                'if you find the target Greater 50% or LTEQ 60% field then type in the the units
                If Not sEObject Is Nothing Then
                    Dim sElementTarget5060 As IWebElement = DirectCast(sEObject, IWebElement)
                    sElementTarget5060.SendKeys(Keys.Control + "a")
                    sElementTarget5060.SendKeys(sTargetGT50LT60)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the greater than 50% and Less that on equal 60% AMI field and entered the units " & sTargetGT50LT60.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the greater than 50% and less than equal 60% AMI Units."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|CCould not enter the greater than 50% and less than equal 60% AMI Units: " & sTargetGT50LT60.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
            If Not sTargetGT60LTEQ80 = String.Empty Then
                Dim sEObject As Object = Nothing
                sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='units[2]']"))

                'if you find the target Greater 50% or LTEQ 60% field then type in the the units
                If Not sEObject Is Nothing Then
                    Dim sElementTarget6080 As IWebElement = DirectCast(sEObject, IWebElement)
                    sElementTarget6080.SendKeys(Keys.Control + "a")
                    sElementTarget6080.SendKeys(sTargetGT60LTEQ80)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the greater than 60% and Less that on equal 80% AMI field and entered the units " & sTargetGT60LTEQ80.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the greater than 60% and less than equal 80% AMI Units."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|CCould not enter the greater than 60% and less than equal 80% AMI Units: " & sTargetGT60LTEQ80.ToString(), myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
            If Not sTargetGT80 = String.Empty Then

                Dim sEObject As Object = Nothing
                sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='units[3]']"))
                'if you find the target Greater than 80% field then type in the the units
                If Not sEObject Is Nothing Then
                    Dim sElementTarget6080 As IWebElement = DirectCast(sEObject, IWebElement)
                    If sElementTarget6080.Enabled = True Then
                        sElementTarget6080.SendKeys(Keys.Control + "a")
                        sElementTarget6080.SendKeys(sTargetGT80)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the greater than 80% and entered the units " & sTargetGT80.ToString(), myLogPath, , actionHistoryRecordID)
                    ElseIf sTargetGT80 > 0 Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Field Disabled - Could not enter the greater than 80% AMI Units."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Field Disabled - Could not enter the greater than 80% AMI Units. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not enter the greater than 80% AMI Units."
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the greater than 80% AMI Units. ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If

            End If


            'find the lookup button
            Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//input"))


            For y As Integer = 1 To inputElements.Count - 1
                If inputElements(y).GetAttribute("value").ToUpper.ToString() = "UPDATE" Then
                    Dim inputElement As IWebElement = inputElements(y)
                    inputElement.Click()
                    Exit For
                End If
            Next

            'Verify total
            'Dim Total_value As IWebElement = driver.FindElement(By.XPath("//span[@id='total']"))

            Dim Total_ValueObject As Object = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='total']"))
            If Not Total_ValueObject Is Nothing Then
                Dim total_value As IWebElement = DirectCast(Total_ValueObject, IWebElement)
                If total_value.Text.ToUpper = sTargetTotal.ToUpper Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Total Units Equals Expected Results " & sTargetTotal.ToString(), myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Total Units Does Not Match Expected Results"
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Total Units: " & total_value.Text.ToUpper & " Does Not Equal Expected Results: " & sTargetTotal.ToString(), myLogPath, , actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Total units element was not found. "
                mosaicDll.Logger(senderMCPAction, "Actual Result|Total units element was not found. ", myLogPath, , actionHistoryRecordID)

            End If




            'Check if 50% AMI is zero so no less than 30% possible Need Help Does not work
            Dim AMI_50_value As IWebElement = driver.FindElement(By.XPath("//input[@id='units[0]']"))
            Dim o50AMI As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='units[0]']"))
            If o50AMI.GetAttribute("value") = "0" Then
                mosaicDll.Logger(senderMCPAction, "Actual Result|0 units specified for less than or equal 50%; skipped less than or equal 30% field.", myLogPath, , actionHistoryRecordID)
                GoTo SaveButton
            Else
                If Not sTargetLTEQ30 = String.Empty Then
                    Dim sEObject As Object = Nothing
                    sEObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='lt30pcUnits[0]']"))

                    'if you find the target LTEQ 30% then type in the the units
                    If Not sEObject Is Nothing Then
                        Dim sElementTarget30 As IWebElement = DirectCast(sEObject, IWebElement)
                        sElementTarget30.SendKeys(Keys.Control + "a")
                        sElementTarget30.SendKeys(sTargetLTEQ30)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Cleared the less than or equal 30% AMI and entered the units " & sTargetLTEQ30.ToString(), myLogPath, , actionHistoryRecordID)
                    Else

                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not enter the less than or equal 30% AMI Units."
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the less than or equal 30% AMI Units: " & sTargetLTEQ30.ToString(), myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo SaveButton
                    End If
                End If
            End If




SaveButton:

            'Click Save
            Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oSave Is Nothing Then
                Dim oSaveElement As IWebElement = DirectCast(oSave, IWebElement)
                oSaveElement.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click the save button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


NextButton:
            'click next
            'Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"))
            If Not oNext Is Nothing Then
                Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
                oNextElement.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked the next button.", myLogPath, , actionHistoryRecordID)
                Dim oCheckNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@name='unitsReserved']"))
                If oCheckNext Is Nothing Then
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & " Homeless Window not Detected on Next Click."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | CHomeless Window not Detected on Next Click.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & " Could not click the next button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Return returnValues

        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)

            Return returnValues
        End Try
    End Function
    Public Function Feas1_Import_Sprsht_Plan_Valid(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)


        Try


            'get all the data for this action from RStar
            Dim sFeasSpreadsheet As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "Feasibility_SpreadsheetFile")
            Dim sFeasFloorSitePlan As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "Feas_Floor_Site_Plan_File")


            'path to the remove button
            'find the remove button
            'Dim remove_spd_button_xpath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table[2]/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
            Dim remove_spd_button_xpath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[2]/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
            'Dim remove_flr_plan_button_xpath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table[3]/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
            Dim remove_flr_plan_button_xpath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/table[3]/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"

            If Not String.IsNullOrEmpty(sFeasSpreadsheet) Then
                Dim oremove1 As Object = WaitForElement(driver, WaitForTime, By.XPath(remove_spd_button_xpath))
                'if found click them
                If Not oremove1 Is Nothing Then
                    Dim remove_element1 As IWebElement = DirectCast(oremove1, IWebElement)
                    remove_element1.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Removed the previous feasibilty spreadsheet", myLogPath, , actionHistoryRecordID)
                End If
            End If

            If Not String.IsNullOrEmpty(sFeasFloorSitePlan) Then
                Dim oremove2 As Object = WaitForElement(driver, WaitForTime, By.XPath(remove_flr_plan_button_xpath))
                If Not oremove2 Is Nothing Then
                    Dim remove_element2 As IWebElement = DirectCast(oremove2, IWebElement)
                    remove_element2.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Removed the previous floor\site plan.", myLogPath, , actionHistoryRecordID)
                End If
            End If

            'if there is a feasibility file location set select it
            If Not String.IsNullOrEmpty(sFeasSpreadsheet) Then
                If Not System.IO.File.Exists(sFeasSpreadsheet) Then
                    'message
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "The file named: " & sFeasSpreadsheet & " was not found."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sFeasSpreadsheet & " was not found.", myLogPath, , actionHistoryRecordID)
                    GoTo NextStep
                End If
                Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:spreadsheet']"))
                If Not oAttachFile Is Nothing Then
                    Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                    oAttachFileElement.Click()
                    oAttachFileElement.SendKeys(sFeasSpreadsheet)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Attached feasibility spreadsheet " & sFeasSpreadsheet, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not attach file named: " & sFeasSpreadsheet
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sFeasSpreadsheet, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextStep
                End If
            End If

NextStep:
            If Not String.IsNullOrEmpty(sFeasFloorSitePlan) Then
                If Not System.IO.File.Exists(sFeasFloorSitePlan) Then
                    'message
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "The file named: " & sFeasFloorSitePlan & " was not found."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sFeasFloorSitePlan & " was not found.", myLogPath, , actionHistoryRecordID)
                    GoTo NextButton
                End If
                Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:supplementalAttachment']"))
                If Not oAttachFile Is Nothing Then
                    Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                    oAttachFileElement.Click()
                    oAttachFileElement.SendKeys(sFeasFloorSitePlan)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Attached site / floor plan.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not attach file named: " & sFeasFloorSitePlan
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sFeasFloorSitePlan, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextButton
                End If
            End If


SaveButton:

            'Click Save
            Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oSave Is Nothing Then
                Dim oSaveElement As IWebElement = DirectCast(oSave, IWebElement)
                oSaveElement.Click()
                mosaicDll.Logger(senderMCPAction, "Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not click the save button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            'check for results table
            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.Id("pageTemplateForm:fundsSourcesTable"))
            If Not a.aObject Is Nothing Then
                mosaicDll.Logger(senderMCPAction, "Actual Result | Feasibility spreadsheet accepted.  Data displayed.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result | Feasibility spreadsheet not accepted.  Data not displayed.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo NextButton
            End If



NextButton:
            'click next
            Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext Is Nothing Then
                Dim oNextElement As IWebElement = DirectCast(oNext, IWebElement)
                oNextElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & " Could not click the next button ."
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

        Catch ex As Exception


            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
        Finally
            ' Close the DB.
            If CloseSqlDB() <> dbClosed Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = "Error closing the database."
                mosaicDll.Logger(senderMCPAction, "Error|Error closing the database.", myLogPath, , actionHistoryRecordID)
            End If
            Feas1_Import_Sprsht_Plan_Valid = returnValues
        End Try
    End Function
    Public Function Feas2c_Enter_HomeOwner_Reh(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sDescrRepairTypes As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Dsscr_Type_Rep")
            Dim sDescProcScopeCosts As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Proc_Det_Ass_Scope_Costs")
            Dim sDescProcScrSelContr As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Desc_Proc_Screen_Sel_Contractr")
            Dim sDescProcConfirmWk As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Descr_Proc_Confirm_Work")
            Dim sIdentPartyVerWk As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Ident_Party_Ver_Work")
            Dim sDescprocCollRevPayContr As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Proc_Coll_Rev_Pay_Contr")
            Dim sDescProcIdenRecRptSourcesUses As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Descr_Proc_Ident_Rec_Srce_Funds")
            Dim sPostPurchCounselAdmin As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Post_Purch_counsel_Admin")
            Dim sSupplInfoFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "HO_Suppl_Info_File")
            Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "Error_Message")

            ' Describe Types of Repairs
            If Not String.IsNullOrEmpty(sDescrRepairTypes) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescrRepairTypes
                TextAreaInfo.TextAreaXpath = "//textarea[@id='repairsFocusExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Types of Repairs")
            End If

            ' Describe Process Access Scope and Costs
            If Not String.IsNullOrEmpty(sDescProcScopeCosts) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescProcScopeCosts
                TextAreaInfo.TextAreaXpath = "//textarea[@id='scopeCostExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Process to Assess Scope and Costs")
            End If

            ' Describe Process Screen and Select Contractors
            If Not String.IsNullOrEmpty(sDescProcScrSelContr) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescProcScrSelContr
                TextAreaInfo.TextAreaXpath = "//textarea[@id='screenContractorsExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Process to Screen/Select Contractors")
            End If

            ' Describe Process Confirm Work Complete
            If Not String.IsNullOrEmpty(sDescProcConfirmWk) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescProcConfirmWk
                TextAreaInfo.TextAreaXpath = "//textarea[@id='workConfirmProcessExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Process to Confirm Work Complete")
            End If

            ' Describe Identify Party Verify Work
            If Not String.IsNullOrEmpty(sIdentPartyVerWk) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sIdentPartyVerWk
                TextAreaInfo.TextAreaXpath = "//textarea[@id='workCompletePartyExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Party to Verify Work")
            End If

            ' Describe Process to Pay Contractors
            If Not String.IsNullOrEmpty(sDescprocCollRevPayContr) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescprocCollRevPayContr
                TextAreaInfo.TextAreaXpath = "//textarea[@id='contractBillProcessExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Process the Pay Contractors")
            End If

            ' Describe Process Identify Record and Report Sources Uses for Funds
            If Not String.IsNullOrEmpty(sDescProcIdenRecRptSourcesUses) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescProcIdenRecRptSourcesUses
                TextAreaInfo.TextAreaXpath = "//textarea[@id='useOfFundsExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Process Control Sources Uses Funds")
            End If

            ' If Post-Purch Counsel How Administer
            If Not String.IsNullOrEmpty(sPostPurchCounselAdmin) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sPostPurchCounselAdmin
                TextAreaInfo.TextAreaXpath = "//textarea[@id='postPurchaseExplanation']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Administration for Post-Purchase Counseling")
            End If

            'Supplemental Information File
            If Not String.IsNullOrEmpty(sSupplInfoFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:supplementaryInformationHO']"
                FileToUpload.FileToAttach = sSupplInfoFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Supplemental Information")
            End If

ClickSave:

            Dim oAuto As New AutomationObject
            'Dim TimetoWait As System.TimeSpan = System.TimeSpan.FromSeconds(120)
            'driver.Manage().Timeouts().SetPageLoadTimeout(TimetoWait)
            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
                If Not String.IsNullOrEmpty(sErrorMessage) Then
                    CaptureScreenshot(actionHistoryRecordID)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Check Screen Shot for Message. ", myLogPath, , actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))


ClickNext:
            Dim oNext As New AutomationObject

            oNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext.aObject Is Nothing Then
                oNext.aElement = DirectCast(oNext.aObject, IWebElement)
                oNext.aElement.Click()
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the next button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Class TextAreaParms
        Private _TextToEnter As String
        Private _TextAreaXpath As String
        Public Property TextToEnter() As String
            Get
                Return _TextToEnter
            End Get

            Set(ByVal value As String)
                _TextToEnter = value
            End Set

        End Property
        Public Property TextAreaXpath() As String
            Get
                Return _TextAreaXpath
            End Get

            Set(ByVal value As String)
                _TextAreaXpath = value
            End Set

        End Property
    End Class
    Public Function Feas2d_Enter_RE_LP_Rehab(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sAuditFInStmtFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Audit_Fin_stmt_File")
            Dim sMostCurrInspectFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Most_Curr_Inspect_File")
            Dim sMostCurrTitleALTAFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Most_Curr_Title_ALTA_File")
            Dim sDtlScopeWorkFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Dtl_Scope_Work_File")

            Dim sCNAPNAFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_CNA_PNA_File")
            Dim sRehabChkListFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Rehab_Checklist_File")
            Dim sDateSponPurchProp As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Date_Spon_Pur_Prop")
            Dim sExplainDeterioration As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Explain_Deterioration")

            Dim sExplLTCNAFinance As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Explain_LT_CNA_Finance")
            Dim sExplExceedScopeCNA As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Explain_Exceed_Scope_CNA")
            Dim sNoDelSuppCostFile As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Not_Del_Supp_Cost_File")
            Dim sDescrDiscrepancies As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Descr_Discrepancies")

            Dim sReplReserveBal As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Replacement_Reserve_Bal")
            Dim sReplResBalAsOfDate As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Repl_Res_Bal_AsOf_Dte")
            Dim sOtherReserves As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Other_Reserves")
            Dim sOtherReserveAsofDate As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Othr_Res_AsOfDate")
            Dim sPurposeOtherReserve As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Purpose_Other_Reserve")

            Dim sExplExistResNotApply As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Explain_Exist_Res_Not_Apply")
            Dim sDescrExtReport As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Descr_Ext_Rpt")
            Dim sIndSubjOnsiteRev As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Ind_Subj_OnSite_Rev")
            Dim sErrorMessage As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "Error_Message")

            ' Audit Financial Statement File
            If Not String.IsNullOrEmpty(sAuditFInStmtFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[1]/div[2]/table/tbody/tr[2]/td/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:rentalRehabilitationAtt1']"
                FileToUpload.FileToAttach = sAuditFInStmtFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Audit Financial Statement")
            End If

            ' Most Current Inspection File
            If Not String.IsNullOrEmpty(sMostCurrInspectFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[1]/div[2]/table/tbody/tr[5]/td/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:rentalRehabilitationAtt2']"
                FileToUpload.FileToAttach = sMostCurrInspectFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Most Current Inspection")
            End If

            ' Most Current Title/ALTA
            If Not String.IsNullOrEmpty(sMostCurrTitleALTAFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[1]/div[2]/table/tbody/tr[8]/td/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:rentalRehabilitationAtt3']"
                FileToUpload.FileToAttach = sMostCurrTitleALTAFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Most Current Title/ALTA")
            End If

            ' Most Detailed Scope of Work
            If Not String.IsNullOrEmpty(sDtlScopeWorkFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[1]/div[2]/table/tbody/tr[11]/td/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:rentalRehabilitationAtt4']"
                FileToUpload.FileToAttach = sDtlScopeWorkFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Detailed Scope of Work")
            End If

            ' CNA/PNA
            If Not String.IsNullOrEmpty(sCNAPNAFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[1]/div[2]/table/tbody/tr[14]/td/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:rentalRehabilitationAtt5']"
                FileToUpload.FileToAttach = sCNAPNAFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "CNA/PNA")
            End If

            ' Rental Rehab Checklist
            If Not String.IsNullOrEmpty(sRehabChkListFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[1]/div[2]/table/tbody/tr[17]/td/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:rentalRehabilitationScopeCheckList']"
                FileToUpload.FileToAttach = sRehabChkListFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Rental Rehabilitation Checklist")
            End If

            ' Date Purchased
            If Not String.IsNullOrEmpty(sDateSponPurchProp) Then
                'New up a calendar object
                Dim myCalendar As New CalendarParams

                'change text date to real date
                Dim properDate As DateTime = DateTime.Parse(sDateSponPurchProp)

                'set parameters 
                myCalendar.monthdec = "//td[@id='pageTemplateForm:purchasedDateHeader']/table/tbody/tr/td[2]/div"
                myCalendar.monthinc = "//td[@id='pageTemplateForm:purchasedDateHeader']/table/tbody/tr/td[4]/div"
                myCalendar.yeardec = "//td[@id='pageTemplateForm:purchasedDateHeader']/table/tbody/tr/td[1]/div"
                myCalendar.yearinc = "//td[@id='pageTemplateForm:purchasedDateHeader']/table/tbody/tr/td[5]/div"
                myCalendar.clean = "//td[@id='pageTemplateForm:purchasedDateFooter']/table/tbody/tr/td[2]/div"
                myCalendar.ctoday = "//td[@id='pageTemplateForm:purchasedDateFooter']/table/tbody/tr/td[5]/div"
                myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:purchasedDatePopupButton']"
                myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:purchasedDateDayCell0']"
                myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:purchasedDateDayCell"
                myCalendar.dayXPathPart2 = "']"
                myCalendar.CalHeader = "//td[@id='pageTemplateForm:purchasedDateHeader']/table/tbody/tr/td[3]/div"
                myCalendar.CurrentDay = Now.Day
                myCalendar.CurrentMonth = Now.Month
                myCalendar.CurrentYear = Now.Year
                myCalendar.TargetDay = properDate.Day
                myCalendar.TargetMonth = properDate.Month
                myCalendar.TargetYear = properDate.Year
                myCalendar.CurrentDate = Today
                myCalendar.TargetDate = properDate

                'call calendar method WELLA

                Call DoCalendar(sDateSponPurchProp, myCalendar, returnValues, actionHistoryRecordID, "Date Sponsor")

            End If

            ' Explain What led to deterioration
            If Not String.IsNullOrEmpty(sExplainDeterioration) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sExplainDeterioration
                TextAreaInfo.TextAreaXpath = "//textarea[@id='deterioration']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "What Led to Deterioration or Need for Rehab")
            End If

            ' Explain How Remaining Repairs will be financed
            If Not String.IsNullOrEmpty(sExplLTCNAFinance) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sExplLTCNAFinance
                TextAreaInfo.TextAreaXpath = "//textarea[@id='finLessRemRepExplanationTxt']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Explanation for CNA/PNA how remaining repairs financed")
            End If

            ' Explain Reason for Repairs if Exceed Scope in CNA/PNA
            If Not String.IsNullOrEmpty(sExplExceedScopeCNA) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sExplExceedScopeCNA
                TextAreaInfo.TextAreaXpath = "//textarea[@id='repairReasonsTxt']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Reason for Repairs if Exceed CNA/PNA scope")
            End If

            ' Support for Cost Estimates if rehab items are not delinerated in CNA/PNA
            If Not String.IsNullOrEmpty(sNoDelSuppCostFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table[3]/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:rentalRehabilitationAtt6']"
                FileToUpload.FileToAttach = sNoDelSuppCostFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Support for Cost Estimates")
            End If

            ' Describe Discrepancies between cost certification, CNA/PNA and dev; Itemize Difference in cost and scope by type of work
            If Not String.IsNullOrEmpty(sDescrDiscrepancies) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescrDiscrepancies
                TextAreaInfo.TextAreaXpath = "//textarea[@id='rehabDescrepanciesTxt']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Description of Discrepancies")
            End If

            'Current Balances for replacement 
            If Not String.IsNullOrEmpty(sReplReserveBal) Then
                Dim ofield As New AutomationObject
                ofield.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='reserveAmt1']"))
                If Not ofield.aObject Is Nothing Then
                    ofield.aElement = DirectCast(ofield.aObject, IWebElement)
                    ofield.aElement.SendKeys(Keys.Control + "a")
                    ofield.aElement.SendKeys(sReplReserveBal)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Replacement reserve balance then Entered: " & sReplReserveBal.ToString, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Replacement reserve balance."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sReplReserveBal.ToString & " in Replacement reserve balance.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If


            ' Reserve Balance As-Of-Date
            If Not String.IsNullOrEmpty(sReplResBalAsOfDate) Then
                'New up a calendar object
                Dim myCalendar As New CalendarParams

                'change text date to real date
                Dim properDate As DateTime = DateTime.Parse(sReplResBalAsOfDate)

                'set parameters 
                myCalendar.monthdec = "//td[@id='pageTemplateForm:reserveAsOf1Header']/table/tbody/tr/td[2]/div"
                myCalendar.monthinc = "//td[@id='pageTemplateForm:reserveAsOf1Header']/table/tbody/tr/td[4]/div"
                myCalendar.yeardec = "//td[@id='pageTemplateForm:reserveAsOf1Header']/table/tbody/tr/td[1]/div"
                myCalendar.yearinc = "//td[@id='pageTemplateForm:reserveAsOf1Header']/table/tbody/tr/td[5]/div"
                myCalendar.clean = "//td[@id='pageTemplateForm:reserveAsOf1Footer']/table/tbody/tr/td[2]/div"
                myCalendar.ctoday = "//td[@id='pageTemplateForm:reserveAsOf1Footer']/table/tbody/tr/td[5]/div"
                myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:reserveAsOf1PopupButton']"
                myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:reserveAsOf1DayCell0']"
                myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:reserveAsOf1DayCell"
                myCalendar.dayXPathPart2 = "']"
                myCalendar.CalHeader = "//td[@id='pageTemplateForm:reserveAsOf1Header']/table/tbody/tr/td[3]/div"
                myCalendar.CurrentDay = Now.Day
                myCalendar.CurrentMonth = Now.Month
                myCalendar.CurrentYear = Now.Year
                myCalendar.TargetDay = properDate.Day
                myCalendar.TargetMonth = properDate.Month
                myCalendar.TargetYear = properDate.Year
                myCalendar.CurrentDate = Today
                myCalendar.TargetDate = properDate

                'call calendar method WELLA

                Call DoCalendar(sReplResBalAsOfDate, myCalendar, returnValues, actionHistoryRecordID, "Replacement reserve balance as of ")

            End If

            'Current Balances for other reserves
            If Not String.IsNullOrEmpty(sOtherReserves) Then
                Dim ofield As New AutomationObject
                ofield.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='reserveAmt2']"))
                If Not ofield.aObject Is Nothing Then
                    ofield.aElement = DirectCast(ofield.aObject, IWebElement)
                    ofield.aElement.SendKeys(Keys.Control + "a")
                    ofield.aElement.SendKeys(sOtherReserves)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Other reserve balance then Entered: " & sOtherReserves.ToString, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter Other Reserve Balance."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sOtherReserves.ToString & " in Other reserve balance.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If


            ' Other Reserve As-Of-Date
            If Not String.IsNullOrEmpty(sOtherReserveAsofDate) Then
                'New up a calendar object
                Dim myCalendar As New CalendarParams

                'change text date to real date
                Dim properDate As DateTime = DateTime.Parse(sOtherReserveAsofDate)

                'set parameters 
                myCalendar.monthdec = "//td[@id='pageTemplateForm:reserveAsOf2Header']/table/tbody/tr/td[2]/div"
                myCalendar.monthinc = "//td[@id='pageTemplateForm:reserveAsOf2Header']/table/tbody/tr/td[4]/div"
                myCalendar.yeardec = "//td[@id='pageTemplateForm:reserveAsOf2Header']/table/tbody/tr/td[1]/div"
                myCalendar.yearinc = "//td[@id='pageTemplateForm:reserveAsOf2Header']/table/tbody/tr/td[5]/div"
                myCalendar.clean = "//td[@id='pageTemplateForm:reserveAsOf2Footer']/table/tbody/tr/td[2]/div"
                myCalendar.ctoday = "//td[@id='pageTemplateForm:reserveAsOf2Footer']/table/tbody/tr/td[5]/div"
                myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:reserveAsOf2PopupButton']"
                myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:reserveAsOf2DayCell0']"
                myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:reserveAsOf2DayCell"
                myCalendar.dayXPathPart2 = "']"
                myCalendar.CalHeader = "//td[@id='pageTemplateForm:reserveAsOf2Header']/table/tbody/tr/td[3]/div"
                myCalendar.CurrentDay = Now.Day
                myCalendar.CurrentMonth = Now.Month
                myCalendar.CurrentYear = Now.Year
                myCalendar.TargetDay = properDate.Day
                myCalendar.TargetMonth = properDate.Month
                myCalendar.TargetYear = properDate.Year
                myCalendar.CurrentDate = Today
                myCalendar.TargetDate = properDate

                'call calendar method WELLA

                Call DoCalendar(sOtherReserveAsofDate, myCalendar, returnValues, actionHistoryRecordID, "Other reserve as of ")

            End If

            ' Purpose of Other Reserves
            If Not String.IsNullOrEmpty(sPurposeOtherReserve) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sPurposeOtherReserve
                TextAreaInfo.TextAreaXpath = "//textarea[@id='otherReservePurposeTxt']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Purpose of Other Reserve")
            End If

            ' Explain Other reserve balances not applied toward rehab costs
            If Not String.IsNullOrEmpty(sExplExistResNotApply) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sExplExistResNotApply
                TextAreaInfo.TextAreaXpath = "//textarea[@id='reserveBalancesTxt']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Explanation Other Reserve Balances Not Applied Toward Rehab Costs")
            End If

            ' Identify and Explain External Reporting
            If Not String.IsNullOrEmpty(sDescrExtReport) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sDescrExtReport
                TextAreaInfo.TextAreaXpath = "//textarea[@id='externalReportingTxt']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Identification and Explanation of External Reporting")
            End If

            ' Indicate whether property subject to on-site reviews or inspections
            If Not String.IsNullOrEmpty(sIndSubjOnsiteRev) Then
                Dim TextAreaInfo As New TextAreaParms
                TextAreaInfo.TextToEnter = sIndSubjOnsiteRev
                TextAreaInfo.TextAreaXpath = "//textarea[@id='onsiteReviewsTxt']"

                Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Indicated if property subject to on-site reviews")
            End If
ClickSave:

            Dim oAuto As New AutomationObject
            'Dim TimetoWait As System.TimeSpan = System.TimeSpan.FromSeconds(120)
            'driver.Manage().Timeouts().SetPageLoadTimeout(TimetoWait)
            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
                If Not String.IsNullOrEmpty(sErrorMessage) Then
                    CaptureScreenshot(actionHistoryRecordID)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Check Screen Shot for Message. ", myLogPath, , actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))


ClickNext:
            Dim oNext As New AutomationObject

            oNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext.aObject Is Nothing Then
                oNext.aElement = DirectCast(oNext.aObject, IWebElement)
                oNext.aElement.Click()
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the next button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the next button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Threading.Thread.Sleep(60000)
            Dim eNext As New AutomationObject
            eNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not eNext.aObject Is Nothing Then
                eNext.aElement = DirectCast(eNext.aObject, IWebElement)
                eNext.aElement.Click()
            End If
            Return returnValues
        End Try
    End Function
    Public Function Feas2e_Enter_RE_LP_REH_Loans_Save(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sLenderName1 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loan1_Lender_Name")
            Dim sOutstandingBal1 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loan1_Outs_Bal")
            Dim sMaturDate1 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loan1_Matur_Date")
            Dim sDebtServiceAmt1 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loan1_AnnLDebServ")
            Dim sLenderName2 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loan2_Lender_Name")
            Dim sOutstandingBal2 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loans2_Outs_Bal")
            Dim sMaturDate2 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loan2_Matur_Date")
            Dim sDebtServiceAmt2 As String = mosaicDll.dt(excelPath, iteration, "appreh_rehabilitation_info", "RE_Loan2_AnnLDebServ")


            Dim LoanAutoObject As New AutomationObject

            If Not String.IsNullOrEmpty(sLenderName1) Then
                'Click Add Loan
                LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[7]/div/div/div[2]/div/table/tbody/tr/td/input"))
                If Not LoanAutoObject.aObject Is Nothing Then
                    LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                    LoanAutoObject.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the Add Loan button. ", myLogPath, , actionHistoryRecordID)
                    LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='addlenderName']"))
                    If Not LoanAutoObject.aObject Is Nothing Then
                        LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                        LoanAutoObject.aElement.SendKeys(sLenderName1)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Lender Name: " & sLenderName1 & ". ", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not enter Lender Name."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Lender Name: " & sLenderName1 & ". ", myLogPath, , actionHistoryRecordID)
                        GoTo EndOfProcessing
                    End If
                    If Not String.IsNullOrEmpty(sOutstandingBal1) Then
                        LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='addOutBal']"))
                        If Not LoanAutoObject.aObject Is Nothing Then
                            LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                            LoanAutoObject.aElement.SendKeys(sOutstandingBal1)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Outstanding Balance: " & sOutstandingBal1 & ". ", myLogPath, , actionHistoryRecordID)
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = CStr(returnValues(1)) & " Could not enter Outstanding Balance."
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Outstanding Balance: " & sOutstandingBal1 & ". ", myLogPath, , actionHistoryRecordID)
                            GoTo EndOfProcessing
                        End If
                    End If
                    If Not String.IsNullOrEmpty(sDebtServiceAmt1) Then
                        LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='addDebtService']"))
                        If Not LoanAutoObject.aObject Is Nothing Then
                            LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                            LoanAutoObject.aElement.SendKeys(sDebtServiceAmt1)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Annual Debt Service: " & sDebtServiceAmt1 & ". ", myLogPath, , actionHistoryRecordID)
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = CStr(returnValues(1)) & " Could not enter Annual Debt Service."
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Annual Debt Service: " & sDebtServiceAmt1 & ". ", myLogPath, , actionHistoryRecordID)
                            GoTo EndOfProcessing
                        End If
                    End If
                    'Enter Maturity Date with Date Routine
                    '********* routine for dates *********************************************************************************
                    'Implement Calendar for Appraisal Date
                    If Not String.IsNullOrEmpty(sMaturDate1) Then
                        'New up a calendar object
                        Dim myCalendar As New CalendarParams

                        'change text date to real date
                        Dim properDate As DateTime = DateTime.Parse(sMaturDate1)

                        'set parameters 
                        myCalendar.monthdec = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[2]/div"
                        myCalendar.monthinc = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[4]/div"
                        myCalendar.yeardec = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[1]/div"
                        myCalendar.yearinc = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[5]/div"
                        myCalendar.clean = "//td[@id='pageTemplateForm:addMatDateFooter']/table/tbody/tr/td[2]/div"
                        myCalendar.ctoday = "//td[@id='pageTemplateForm:addMatDateFooter']/table/tbody/tr/td[5]/div"
                        myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:addMatDatePopupButton']"
                        myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:addMatDateDayCell0']"
                        myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:addMatDateDayCell"
                        myCalendar.dayXPathPart2 = "']"
                        myCalendar.CalHeader = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[3]/div"
                        myCalendar.CurrentDay = Now.Day
                        myCalendar.CurrentMonth = Now.Month
                        myCalendar.CurrentYear = Now.Year
                        myCalendar.TargetDay = properDate.Day
                        myCalendar.TargetMonth = properDate.Month
                        myCalendar.TargetYear = properDate.Year
                        myCalendar.CurrentDate = Today
                        myCalendar.TargetDate = properDate

                        'call calendar method WELLA

                        Call DoCalendar(sMaturDate1, myCalendar, returnValues, actionHistoryRecordID)
                    End If
                    'Click Update Loan
                    Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//input"))


                    For y As Integer = 1 To inputElements.Count - 1
                        If inputElements(y).GetAttribute("value").ToUpper.ToString() = "UPDATE LOAN" Then
                            Dim inputElement As IWebElement = inputElements(y)
                            inputElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the Update Loan button. ", myLogPath, , actionHistoryRecordID)
                            Exit For
                        End If
                    Next

                Else
                    GoTo TrySecLoan
                End If
            End If
TrySecLoan:
            If Not String.IsNullOrEmpty(sLenderName2) Then
                'Click Add Loan
                LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div[7]/div/div/div[2]/div/table/tbody/tr/td/input"))
                If Not LoanAutoObject.aObject Is Nothing Then
                    LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                    LoanAutoObject.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the Add Loan button. ", myLogPath, , actionHistoryRecordID)
                    LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='addlenderName']"))
                    If Not LoanAutoObject.aObject Is Nothing Then
                        LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                        LoanAutoObject.aElement.SendKeys(sLenderName2)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Lender Name: " & sLenderName2 & ". ", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not enter Lender Name."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Lender Name: " & sLenderName2 & ". ", myLogPath, , actionHistoryRecordID)
                        GoTo EndOfProcessing
                    End If
                    If Not String.IsNullOrEmpty(sOutstandingBal2) Then
                        LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='addOutBal']"))
                        If Not LoanAutoObject.aObject Is Nothing Then
                            LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                            LoanAutoObject.aElement.SendKeys(sOutstandingBal2)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Outstanding Balance: " & sOutstandingBal2 & ". ", myLogPath, , actionHistoryRecordID)
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = CStr(returnValues(1)) & " Could not enter Outstanding Balance."
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Outstanding Balance: " & sOutstandingBal2 & ". ", myLogPath, , actionHistoryRecordID)
                            GoTo EndOfProcessing
                        End If
                    End If
                    If Not String.IsNullOrEmpty(sDebtServiceAmt2) Then
                        LoanAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='addDebtService']"))
                        If Not LoanAutoObject.aObject Is Nothing Then
                            LoanAutoObject.aElement = DirectCast(LoanAutoObject.aObject, IWebElement)
                            LoanAutoObject.aElement.SendKeys(sDebtServiceAmt2)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Annual Debt Service: " & sDebtServiceAmt2 & ". ", myLogPath, , actionHistoryRecordID)
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = CStr(returnValues(1)) & " Could not enter Annual Debt Service."
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter Annual Debt Service: " & sDebtServiceAmt2 & ". ", myLogPath, , actionHistoryRecordID)
                            GoTo EndOfProcessing
                        End If
                    End If
                    'Enter Maturity Date with Date Routine
                    '********* routine for dates *********************************************************************************
                    'Implement Calendar for Appraisal Date
                    If Not String.IsNullOrEmpty(sMaturDate2) Then
                        'New up a calendar object
                        Dim myCalendar As New CalendarParams

                        'change text date to real date
                        Dim properDate As DateTime = DateTime.Parse(sMaturDate2)

                        'set parameters 
                        myCalendar.monthdec = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[2]/div"
                        myCalendar.monthinc = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[4]/div"
                        myCalendar.yeardec = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[1]/div"
                        myCalendar.yearinc = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[5]/div"
                        myCalendar.clean = "//td[@id='pageTemplateForm:addMatDateFooter']/table/tbody/tr/td[2]/div"
                        myCalendar.ctoday = "//td[@id='pageTemplateForm:addMatDateFooter']/table/tbody/tr/td[5]/div"
                        myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:addMatDatePopupButton']"
                        myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:addMatDateDayCell0']"
                        myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:addMatDateDayCell"
                        myCalendar.dayXPathPart2 = "']"
                        myCalendar.CalHeader = "//td[@id='pageTemplateForm:addMatDateHeader']/table/tbody/tr/td[3]/div"
                        myCalendar.CurrentDay = Now.Day
                        myCalendar.CurrentMonth = Now.Month
                        myCalendar.CurrentYear = Now.Year
                        myCalendar.TargetDay = properDate.Day
                        myCalendar.TargetMonth = properDate.Month
                        myCalendar.TargetYear = properDate.Year
                        myCalendar.CurrentDate = Today
                        myCalendar.TargetDate = properDate

                        'call calendar method WELLA

                        Call DoCalendar(sMaturDate2, myCalendar, returnValues, actionHistoryRecordID)
                    End If
                    'Click Update Loan
                    Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//input"))


                    For y As Integer = 1 To inputElements.Count - 1
                        If inputElements(y).GetAttribute("value").ToUpper.ToString() = "UPDATE LOAN" Then
                            Dim inputElement As IWebElement = inputElements(y)
                            inputElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the Update Loan button. ", myLogPath, , actionHistoryRecordID)
                            Exit For
                        End If
                    Next

                Else
                    GoTo ClickSave
                End If
            End If
ClickSave:

            Dim oAuto As New AutomationObject
            'Dim TimetoWait As System.TimeSpan = System.TimeSpan.FromSeconds(120)
            'driver.Manage().Timeouts().SetPageLoadTimeout(TimetoWait)
            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

EndOfProcessing:

            Return returnValues

        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas10_Complete_Timeline(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sExpectedAHADrawDate As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Exp_Draw_Dte")
            Dim sConstructStartDate As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Strt_Construct_Dte")
            Dim sConstructEndDate As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_End_Construct_Dte")
            Dim sDateAnticipateCertOcupany As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Anticip_Cert_Occup_Dte")
            Dim sLeaseOrSales85Compl As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_LeaseSales_85%")
            Dim sProjectTimelineFile As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_File")
            Dim sProjectHasSiteControl As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Site_Control?")
            Dim sProjectSiteControlFile As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Site_Control_File")
            Dim sDateExpectSiteControl As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Date_Site_Cont_Exp")
            Dim sExplainNoSiteControl As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Expl_No_Site_Contrl")
            Dim ComplyWithZoning As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Comply_Zoning?")
            Dim sZoningFile As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Zoning_File")
            Dim sDateZoningExpected As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Date_Zoning_Exp")
            Dim sProcessObtainZoning As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "ProjTime_Descr_Proc_Sec_Zone")

            Dim index As Integer = 0
            Dim MAX_DAY_IN_A_MONTH As Integer = 31
            Dim oZeroPath_element As IWebElement = Nothing
            Dim WaitForClean As Integer = 2

            If Not sExpectedAHADrawDate = String.Empty Then
                Dim calExpectedDrawDate As New CalendarParams
                'change value to an acutal date sExpectedAHADrawDate add back
                Dim properDate As DateTime = DateTime.Parse(sExpectedAHADrawDate)



                'Declare an calendar parameters object
                calExpectedDrawDate.yeardec = "//td[@id='pageTemplateForm:expectedDrawDateHeader']/table/tbody/tr/td[1]/div"
                calExpectedDrawDate.yearinc = "//td[@id='pageTemplateForm:expectedDrawDateHeader']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.monthdec = "//td[@id='pageTemplateForm:expectedDrawDateHeader']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.monthinc = "//td[@id='pageTemplateForm:expectedDrawDateHeader']/table/tbody/tr/td[4]/div"
                calExpectedDrawDate.clean = "//td[@id='pageTemplateForm:expectedDrawDateFooter']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.ctoday = "//td[@id='pageTemplateForm:expectedDrawDateFooter']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.CalButtonXPath = "//img[@id='pageTemplateForm:expectedDrawDatePopupButton']"
                calExpectedDrawDate.dayZeroXPath = "//td[@id='pageTemplateForm:expectedDrawDateDayCell0']"
                calExpectedDrawDate.dayXPathPart1 = "//td[@id='pageTemplateForm:expectedDrawDateDayCell"
                calExpectedDrawDate.dayXPathPart2 = "']"
                calExpectedDrawDate.CalHeader = "//td[@id='pageTemplateForm:expectedDrawDateHeader']/table/tbody/tr/td[3]/div"
                calExpectedDrawDate.CurrentDay = Now.Day
                calExpectedDrawDate.CurrentMonth = Now.Month
                calExpectedDrawDate.CurrentYear = Now.Year
                calExpectedDrawDate.TargetDay = properDate.Day
                calExpectedDrawDate.TargetMonth = properDate.Month
                calExpectedDrawDate.TargetYear = properDate.Year
                calExpectedDrawDate.CurrentDate = Today
                calExpectedDrawDate.TargetDate = properDate


                Call DoCalendar(sExpectedAHADrawDate, calExpectedDrawDate, returnValues, actionHistoryRecordID, "Expected AHP Draw Date")

            End If
            '--------------------------------------------------------sConstructStartDate
            If Not sConstructStartDate = String.Empty Then

                Dim calExpectedDrawDate As New CalendarParams
                Dim properDate As DateTime = DateTime.Parse(sConstructStartDate)

                'Declare an calendar parameters object.

                calExpectedDrawDate.yeardec = "//td[@id='pageTemplateForm:startConstructionDateHeader']/table/tbody/tr/td[1]/div"
                calExpectedDrawDate.yearinc = "//td[@id='pageTemplateForm:startConstructionDateHeader']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.monthinc = "//td[@id='pageTemplateForm:startConstructionDateHeader']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.monthdec = "//td[@id='pageTemplateForm:startConstructionDateHeader']/table/tbody/tr/td[4]/div"
                calExpectedDrawDate.clean = "//td[@id='pageTemplateForm:startConstructionDateFooter']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.ctoday = "//td[@id='pageTemplateForm:startConstructionDateFooter']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.CalButtonXPath = "//img[@id='pageTemplateForm:startConstructionDatePopupButton']"
                calExpectedDrawDate.dayZeroXPath = "//td[@id='pageTemplateForm:startConstructionDateDayCell0']"
                calExpectedDrawDate.dayXPathPart1 = "//td[@id='pageTemplateForm:startConstructionDateDayCell"
                calExpectedDrawDate.dayXPathPart2 = "']"
                calExpectedDrawDate.CalHeader = "//td[@id='pageTemplateForm:startConstructionDateHeader']/table/tbody/tr/td[3]/div"
                calExpectedDrawDate.CurrentDay = Now.Day
                calExpectedDrawDate.CurrentMonth = Now.Month
                calExpectedDrawDate.CurrentYear = Now.Year
                calExpectedDrawDate.TargetDay = properDate.Day
                calExpectedDrawDate.TargetMonth = properDate.Month
                calExpectedDrawDate.TargetYear = properDate.Year
                calExpectedDrawDate.CurrentDate = Today
                calExpectedDrawDate.TargetDate = properDate

                Call DoCalendar(sConstructStartDate, calExpectedDrawDate, returnValues, actionHistoryRecordID, "Start of construction date")





            End If
            '---------------------------------------------------------------------sConstructEndDate
            If Not sConstructEndDate = String.Empty Then

                Dim calExpectedDrawDate As New CalendarParams
                Dim properDate As DateTime = DateTime.Parse(sConstructEndDate)

                calExpectedDrawDate.yeardec = "//td[@id='pageTemplateForm:endConstructionDateHeader']/table/tbody/tr/td[1]/div"
                calExpectedDrawDate.yearinc = "//td[@id='pageTemplateForm:endConstructionDateHeader']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.monthdec = "//td[@id='pageTemplateForm:endConstructionDateHeader']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.monthinc = "//td[@id='pageTemplateForm:endConstructionDateHeader']/table/tbody/tr/td[4]/div"
                calExpectedDrawDate.clean = "//td[@id='pageTemplateForm:endConstructionDateFooter']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.ctoday = "//td[@id='pageTemplateForm:endConstructionDateFooter']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.CalButtonXPath = "//img[@id='pageTemplateForm:endConstructionDatePopupButton']"
                calExpectedDrawDate.dayZeroXPath = "//td[@id='pageTemplateForm:endConstructionDateDayCell0']"
                calExpectedDrawDate.dayXPathPart1 = "//td[@id='pageTemplateForm:endConstructionDateDayCell"
                calExpectedDrawDate.dayXPathPart2 = "']"
                calExpectedDrawDate.CalHeader = "//td[@id='pageTemplateForm:endConstructionDateHeader']/table/tbody/tr/td[3]/div"
                calExpectedDrawDate.CurrentDay = Now.Day
                calExpectedDrawDate.CurrentMonth = Now.Month
                calExpectedDrawDate.CurrentYear = Now.Year
                calExpectedDrawDate.TargetDay = properDate.Day
                calExpectedDrawDate.TargetMonth = properDate.Month
                calExpectedDrawDate.TargetYear = properDate.Year
                calExpectedDrawDate.CurrentDate = Today
                calExpectedDrawDate.TargetDate = properDate


                Call DoCalendar(sConstructEndDate, calExpectedDrawDate, returnValues, actionHistoryRecordID, "End of construction date")



            End If



            '---------------------------------------------------------------------sDateAnticipateCertOcupany
            If Not sDateAnticipateCertOcupany = String.Empty Then

                Dim calExpectedDrawDate As New CalendarParams
                Dim properDate As DateTime = DateTime.Parse(sDateAnticipateCertOcupany)

                calExpectedDrawDate.yeardec = "//td[@id='pageTemplateForm:certificateOfOccupancyHeader']/table/tbody/tr/td[1]/div"
                calExpectedDrawDate.yearinc = "//td[@id='pageTemplateForm:certificateOfOccupancyHeader']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.monthdec = "//td[@id='pageTemplateForm:certificateOfOccupancyHeader']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.monthinc = "//td[@id='pageTemplateForm:certificateOfOccupancyHeader']/table/tbody/tr/td[4]/div"
                calExpectedDrawDate.clean = "//td[@id='pageTemplateForm:certificateOfOccupancyFooter']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.ctoday = "//td[@id='pageTemplateForm:certificateOfOccupancyFooter']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.CalButtonXPath = "//img[@id='pageTemplateForm:certificateOfOccupancyPopupButton']"
                calExpectedDrawDate.dayZeroXPath = "//td[@id='pageTemplateForm:certificateOfOccupancyDayCell0']"
                calExpectedDrawDate.dayXPathPart1 = "//td[@id='pageTemplateForm:certificateOfOccupancyDayCell"
                calExpectedDrawDate.dayXPathPart2 = "']"
                calExpectedDrawDate.CalHeader = "//td[@id='pageTemplateForm:certificateOfOccupancyHeader']/table/tbody/tr/td[3]/div"
                calExpectedDrawDate.CurrentDay = Now.Day
                calExpectedDrawDate.CurrentMonth = Now.Month
                calExpectedDrawDate.CurrentYear = Now.Year
                calExpectedDrawDate.TargetDay = properDate.Day
                calExpectedDrawDate.TargetMonth = properDate.Month
                calExpectedDrawDate.TargetYear = properDate.Year
                calExpectedDrawDate.CurrentDate = Today
                calExpectedDrawDate.TargetDate = properDate


                Call DoCalendar(sDateAnticipateCertOcupany, calExpectedDrawDate, returnValues, actionHistoryRecordID, "Anticipated certificate date.")



            End If


            '---------------------------------------------------------------------sLeaseOrSales85Compl
            If Not sLeaseOrSales85Compl = String.Empty Then

                Dim calExpectedDrawDate As New CalendarParams
                Dim properDate As DateTime = DateTime.Parse(sLeaseOrSales85Compl)

                calExpectedDrawDate.yeardec = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateHeader']/table/tbody/tr/td[1]/div"
                calExpectedDrawDate.yearinc = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateHeader']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.monthdec = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateHeader']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.monthinc = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateHeader']/table/tbody/tr/td[4]/div"
                calExpectedDrawDate.clean = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateFooter']/table/tbody/tr/td[2]/div"
                calExpectedDrawDate.ctoday = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateFooter']/table/tbody/tr/td[5]/div"
                calExpectedDrawDate.CalButtonXPath = "//img[@id='pageTemplateForm:leaseUpSaleCompleteDatePopupButton']"
                calExpectedDrawDate.dayZeroXPath = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateDayCell0']"
                calExpectedDrawDate.dayXPathPart1 = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateDayCell"
                calExpectedDrawDate.dayXPathPart2 = "']"
                calExpectedDrawDate.CalHeader = "//td[@id='pageTemplateForm:leaseUpSaleCompleteDateHeader']/table/tbody/tr/td[3]/div"
                calExpectedDrawDate.CurrentDay = Now.Day
                calExpectedDrawDate.CurrentMonth = Now.Month
                calExpectedDrawDate.CurrentYear = Now.Year
                calExpectedDrawDate.TargetDay = properDate.Day
                calExpectedDrawDate.TargetMonth = properDate.Month
                calExpectedDrawDate.TargetYear = properDate.Year
                calExpectedDrawDate.CurrentDate = Today
                calExpectedDrawDate.TargetDate = properDate

                Call DoCalendar(sLeaseOrSales85Compl, calExpectedDrawDate, returnValues, actionHistoryRecordID, "Lease-up or sales 85% complete")


            End If







            'Attach the project time line template
            If Not String.IsNullOrEmpty(sProjectTimelineFile) Then

                Dim remove_XPath As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/div/div[2]/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                Dim oremove As Object = WaitForElement(driver, WaitForTime, By.XPath(remove_XPath))

                If Not oremove Is Nothing Then
                    Dim remove_element As IWebElement = DirectCast(oremove, IWebElement)
                    remove_element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Removed the file named:", myLogPath, , actionHistoryRecordID)
                End If

                If Not System.IO.File.Exists(sProjectTimelineFile) Then
                    'message
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "The file named: " & sProjectTimelineFile & " was not found."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sProjectTimelineFile & " was not found.", myLogPath, , actionHistoryRecordID)
                    GoTo NextStep
                End If
                Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:developmentSchedule']"))
                If Not oAttachFile Is Nothing Then
                    Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                    oAttachFileElement.Click()
                    oAttachFileElement.SendKeys(sProjectTimelineFile)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Attached the project timeline template: " & sProjectTimelineFile, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not attach the project time line template: " & sProjectTimelineFile
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach the project time template: " & sProjectTimelineFile, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextStep
                End If
            End If

            'does project have site control 
            Dim SiteAutoObject As New AutomationObject

            If sProjectHasSiteControl.ToUpper.Trim.ToString = "YES" Then
                SiteAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/table/tbody/tr/td[2]/table/tbody/tr/td[1]/label/input"))
                If Not SiteAutoObject.aObject Is Nothing Then
                    SiteAutoObject.aElement = DirectCast(SiteAutoObject.aObject, IWebElement)
                    SiteAutoObject.aElement.Click()
                End If

                If Not String.IsNullOrEmpty(sProjectSiteControlFile) Then
                    Dim remove_XPath As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[4]/td/div/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    Dim oremove As Object = WaitForElement(driver, WaitForTime, By.XPath(remove_XPath))

                    If Not oremove Is Nothing Then
                        Dim remove_element As IWebElement = DirectCast(oremove, IWebElement)
                        remove_element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Removed the file named:", myLogPath, , actionHistoryRecordID)
                    End If

                    If Not System.IO.File.Exists(sProjectSiteControlFile) Then
                        'message
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & "The file named: " & sProjectSiteControlFile & " was not found."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sProjectSiteControlFile & " was not found.", myLogPath, , actionHistoryRecordID)
                        GoTo NextStep
                    End If
                    Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:evidenceSiteControl']"))
                    If Not oAttachFile Is Nothing Then
                        Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                        oAttachFileElement.Click()
                        oAttachFileElement.SendKeys(sProjectSiteControlFile)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Attached the project site control file : " & sProjectSiteControlFile, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not attach file named: " & sProjectSiteControlFile
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sProjectSiteControlFile, myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo NextStep
                    End If
                End If
            Else
                'First click the site control no option
                SiteAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label/input"))
                If Not SiteAutoObject.aObject Is Nothing Then
                    SiteAutoObject.aElement = DirectCast(SiteAutoObject.aObject, IWebElement)
                    SiteAutoObject.aElement.Click()
                End If

                'Iplement Calendar for Site Control Expected Date

                'New up a calendar object
                Dim myCalendar As New CalendarParams

                Dim properDate As DateTime = DateTime.Parse(sDateExpectSiteControl)


                myCalendar.yeardec = "//td[@id='pageTemplateForm:siteControlExpectedDateHeader']/table/tbody/tr/td[1]/div"
                myCalendar.yearinc = "//td[@id='pageTemplateForm:siteControlExpectedDateHeader']/table/tbody/tr/td[5]/div"
                myCalendar.monthdec = "//td[@id='pageTemplateForm:siteControlExpectedDateHeader']/table/tbody/tr/td[2]/div"
                myCalendar.monthinc = "//td[@id='pageTemplateForm:siteControlExpectedDateHeader']/table/tbody/tr/td[4]/div"
                myCalendar.clean = "//td[@id='pageTemplateForm:siteControlExpectedDateFooter']/table/tbody/tr/td[2]/div"
                myCalendar.ctoday = "//td[@id='pageTemplateForm:siteControlExpectedDateFooter']/table/tbody/tr/td[5]/div"
                myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:siteControlExpectedDatePopupButton']"
                myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:siteControlExpectedDateDayCell0']"
                myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:siteControlExpectedDateDayCell"
                myCalendar.dayXPathPart2 = "']"
                myCalendar.CalHeader = "//td[@id='pageTemplateForm:siteControlExpectedDateHeader']/table/tbody/tr/td[3]/div"
                myCalendar.CurrentDay = Now.Day
                myCalendar.CurrentMonth = Now.Month
                myCalendar.CurrentYear = Now.Year
                myCalendar.TargetDay = properDate.Day
                myCalendar.TargetMonth = properDate.Month
                myCalendar.TargetYear = properDate.Year
                myCalendar.CurrentDate = Today
                myCalendar.TargetDate = properDate

                Call DoCalendar(sDateExpectSiteControl, myCalendar, returnValues, actionHistoryRecordID, "Date site control expected")

                'Enter site control explanation
                Dim oObject As Object

                If Not String.IsNullOrEmpty(sExplainNoSiteControl) Then
                    System.Windows.Forms.Clipboard.Clear()

                    Dim sRetVal As String = GetWordText(sExplainNoSiteControl)
                    If sRetVal.ToUpper = "FILE NOT FOUND" Then
                        oObject = WaitForElement(driver, WaitForTime, By.Id("explainNoSiteControl"))

                        If Not oObject Is Nothing Then
                            Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                            oTotunits_Element.SendKeys(Keys.Control + "a")
                            oTotunits_Element.SendKeys(sExplainNoSiteControl)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Entered the explanation ", myLogPath, , actionHistoryRecordID)
                        End If

                    ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                        oObject = WaitForElement(driver, WaitForTime, By.Id("explainNoSiteControl"))

                        If Not oObject Is Nothing Then
                            Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                            oTotunits_Element.SendKeys(Keys.Control + "a")
                            oTotunits_Element.SendKeys(Keys.Delete)

                            Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                            oTotunits_Element.SendKeys(Keys.Control + "v")

                            mosaicDll.Logger(senderMCPAction, "Actual Result| Explanation entered from file ", myLogPath, , actionHistoryRecordID)
                        End If
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & sRetVal
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result|No explanation entered ", myLogPath, , actionHistoryRecordID)
                End If

            End If

            '
            'Does project have zoning
            Dim ZonningAutoObject As New AutomationObject

            If ComplyWithZoning.ToUpper.Trim.ToString = "YES" Then
                ZonningAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[5]/td/table/tbody/tr/td[2]/table/tbody/tr/td[1]/label/input"))
                If Not ZonningAutoObject.aObject Is Nothing Then
                    ZonningAutoObject.aElement = DirectCast(ZonningAutoObject.aObject, IWebElement)
                    ZonningAutoObject.aElement.Click()
                End If

                If Not String.IsNullOrEmpty(sZoningFile) Then

                    Dim remove_XPath As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[6]/td/div/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    Dim oremove As Object = WaitForElement(driver, WaitForTime, By.XPath(remove_XPath))

                    If Not oremove Is Nothing Then
                        Dim remove_element As IWebElement = DirectCast(oremove, IWebElement)
                        remove_element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Removed the file named:", myLogPath, , actionHistoryRecordID)
                    End If

                    If Not System.IO.File.Exists(sZoningFile) Then
                        'message
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & "The file named: " & sZoningFile & " was not found."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sZoningFile & " was not found.", myLogPath, , actionHistoryRecordID)
                        GoTo NextStep
                    End If
                    Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:evidenceZoningCompliance']"))
                    If Not oAttachFile Is Nothing Then
                        Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                        oAttachFileElement.Click()
                        oAttachFileElement.SendKeys(sZoningFile)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Attached the zoning file : " & sZoningFile, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not attach file named: " & sZoningFile
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sZoningFile, myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                End If
            Else
                'First click the zoning no option
                ZonningAutoObject.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[5]/td/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label/input"))
                If Not ZonningAutoObject.aObject Is Nothing Then
                    ZonningAutoObject.aElement = DirectCast(ZonningAutoObject.aObject, IWebElement)
                    ZonningAutoObject.aElement.Click()
                End If

                'Iplement Calendar for Zonning Date

                'New up a calendar object
                Dim myCalendar As New CalendarParams

                'debug 
                'sDateZoningExpected = "1/15/2014"
                Dim properDate As DateTime = DateTime.Parse(sDateZoningExpected)


                myCalendar.yeardec = "//td[@id='pageTemplateForm:zoningApprovalDateHeader']/table/tbody/tr/td[1]/div"
                myCalendar.yearinc = "//td[@id='pageTemplateForm:zoningApprovalDateHeader']/table/tbody/tr/td[5]/div"
                myCalendar.monthdec = "//td[@id='pageTemplateForm:zoningApprovalDateHeader']/table/tbody/tr/td[2]/div"
                myCalendar.monthinc = "//td[@id='pageTemplateForm:zoningApprovalDateHeader']/table/tbody/tr/td[4]/div"
                myCalendar.clean = "//td[@id='pageTemplateForm:zoningApprovalDateFooter']/table/tbody/tr/td[2]/div"
                myCalendar.ctoday = "//td[@id='pageTemplateForm:zoningApprovalDateFooter']/table/tbody/tr/td[5]/div"
                myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:zoningApprovalDatePopupButton']"
                myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:zoningApprovalDateDayCell0']"
                myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:zoningApprovalDateDayCell"
                myCalendar.dayXPathPart2 = "']"
                myCalendar.CalHeader = "//td[@id='pageTemplateForm:zoningApprovalDateHeader']/table/tbody/tr/td[3]/div"
                myCalendar.CurrentDay = Now.Day
                myCalendar.CurrentMonth = Now.Month
                myCalendar.CurrentYear = Now.Year
                myCalendar.TargetDay = properDate.Day
                myCalendar.TargetMonth = properDate.Month
                myCalendar.TargetYear = properDate.Year
                myCalendar.CurrentDate = Today
                myCalendar.TargetDate = properDate

                Call DoCalendar(sDateZoningExpected, myCalendar, returnValues, actionHistoryRecordID, "Date zoning approval expected")

                'Enter site zonning explanation
                Dim oObject As Object

                If Not String.IsNullOrEmpty(sProcessObtainZoning) Then
                    System.Windows.Forms.Clipboard.Clear()

                    Dim sRetVal As String = GetWordText(sProcessObtainZoning)
                    If sRetVal.ToUpper = "FILE NOT FOUND" Then
                        oObject = WaitForElement(driver, WaitForTime, By.Id("zoningApprovalProcess"))

                        If Not oObject Is Nothing Then
                            Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                            oTotunits_Element.SendKeys(Keys.Control + "a")
                            oTotunits_Element.SendKeys(sExplainNoSiteControl)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Entered the explanation ", myLogPath, , actionHistoryRecordID)
                        End If

                    ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                        oObject = WaitForElement(driver, WaitForTime, By.Id("zoningApprovalProcess"))

                        If Not oObject Is Nothing Then
                            Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                            oTotunits_Element.SendKeys(Keys.Control + "a")
                            oTotunits_Element.SendKeys(Keys.Delete)

                            Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                            oTotunits_Element.SendKeys(Keys.Control + "v")

                            mosaicDll.Logger(senderMCPAction, "Actual Result| Explanation entered from file ", myLogPath, , actionHistoryRecordID)
                        End If
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & sRetVal
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result|No explanation entered ", myLogPath, , actionHistoryRecordID)
                End If

            End If



SaveButon:

            Dim oAuto As New AutomationObject

            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
            End If



NextStep:
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function


#End Region
#Region "Quick Application"



    Public Function Sc2HH_Enter_Housing_for_Homeless_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try


            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='unitsReserved']/tbody/tr/td[2]/label"
            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))

            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning qualifying for homeless points.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning qualifying homeless points.", myLogPath, , actionHistoryRecordID)

            End If

            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If



            returnValues(1) = "(* no score version  *)"
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Sc3_Emp_Enter_Promo_of_Empower_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sHaveEmpowerment As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Empow_Tech?")
            Dim sEmplServices As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Empl_Services")
            Dim sEmplServMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Empl_Serv_Mou")
            Dim sWelfareToWork As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Wel_Work")
            Dim sWelfareToWorkMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Wel_Work_MOU")
            Dim sFinLitCounsel As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Fin_Lit_Counsel")
            Dim sFinLitCounselMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Fin_Lit_Counsel_Mou")
            Dim sEducEconDev As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Educ_EconDev")
            Dim sEducEconDevMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Educ_EconDev_Mou")
            Dim sYouthEduc As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "YouthEd")
            Dim sYouthEducMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "YouthEd_Mou")
            Dim sAssistAccBen As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Assist_Access_Ben")
            Dim sAssistAccBenMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Assist_Access_Ben_Mou")
            Dim sIncomeTaxPrep As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "IncomeTax_Prep")
            Dim sIncomeTaxPrepMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "IncomeTax_Prep_Mou")
            Dim sMandPrePurCounsel As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Mand_PrePurCounsel")
            Dim sMandPrePurCounselMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Mand_Pre_Pur_Counsel_MOU")
            Dim sMandPostPurCounsel As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Mand_PostPurCounsel")
            Dim sMandPostPurCounselMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "Mand_PostPurCounsel_Mou")
            Dim sSweatEqPgm As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "SweatEq_Pgm")
            Dim sSweatEqPgmMOU As String = mosaicDll.dt(excelPath, iteration, "empow_empowerment_promotion", "SweatEq_Pgm_Mou")

            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = Nothing
            'click the no option button
            If CleanString(sHaveEmpowerment) = "NO" Then
                optionPath = " //table[@id='techniquesRadio']/tbody/tr/td[2]/label"
            ElseIf CleanString(sHaveEmpowerment) = "YES" Then
                optionPath = "//table[@id='techniquesRadio']/tbody/tr/td[1]/label"
            ElseIf Not String.IsNullOrEmpty(sHaveEmpowerment) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Invalid Value for Project Has Empowerment Tech Specified"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid Value for Project Has Empowerment Tech Specified:" & sHaveEmpowerment & "Expected Yes or No", myLogPath, , actionHistoryRecordID)
                GoTo ClickNext
            End If

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sHaveEmpowerment.ToString & " button for empowerment techniques", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not click the " & sHaveEmpowerment.ToString & " button for empowerment techniques"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the " & sHaveEmpowerment.ToString & " button for empowerment techniques", myLogPath, , actionHistoryRecordID)

            End If
            If CleanString(sHaveEmpowerment) = "YES" Then


                'Employment Services
                If Not String.IsNullOrEmpty(sEmplServices) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sEmplServices
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[1]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:0:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[1]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sEmplServMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Employment Services")
                End If

                'Welfare to Work programs
                If Not String.IsNullOrEmpty(sWelfareToWork) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sWelfareToWork
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[2]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:1:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[2]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sWelfareToWorkMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Welfare to Work programs")
                End If

                'Financial Literacy/Credit Counseling
                If Not String.IsNullOrEmpty(sFinLitCounsel) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sFinLitCounsel
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[3]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:2:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[3]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sFinLitCounselMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Financial Literacy/Credit Counseling")
                End If

                'Education Rel to Econ Empowerment
                If Not String.IsNullOrEmpty(sEducEconDev) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sEducEconDev
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[4]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:3:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[4]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sEducEconDevMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Education Rel to Econ Empowerment")
                End If

                'Youth Education Programs
                If Not String.IsNullOrEmpty(sYouthEduc) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sYouthEduc
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[5]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:4:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[5]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sYouthEducMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Youth Education Programs")
                End If

                'Assistance Accessing Benefits
                If Not String.IsNullOrEmpty(sAssistAccBen) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sAssistAccBen
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[6]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:5:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[6]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sAssistAccBenMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Assistance Accessing Benefits")
                End If

                'Income Tax Prep Assistance
                If Not String.IsNullOrEmpty(sIncomeTaxPrep) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sIncomeTaxPrep
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[7]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:6:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[7]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sIncomeTaxPrepMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Income Tax Prep Assistance")
                End If

                'Mandatory Pre-Purchase Buyer Counseling
                If Not String.IsNullOrEmpty(sMandPrePurCounsel) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sMandPrePurCounsel
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[8]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:7:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[8]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sMandPrePurCounselMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Mandatory Pre-Purchase Buyer Counseling")
                End If

                'Mandatory Post-Purchase Buyer Counseling
                If Not String.IsNullOrEmpty(sMandPostPurCounsel) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sMandPostPurCounsel
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[9]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:8:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[9]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sMandPostPurCounselMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Mandatory Post-Purchase Buyer Counseling")
                End If

                'Sweat-Equity Programs
                If Not String.IsNullOrEmpty(sSweatEqPgm) Then

                    Dim EmpowertoProcess As New EmpowermentParms
                    EmpowertoProcess.IfEmpowerment = sSweatEqPgm
                    EmpowertoProcess.SelXPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr[10]/td[1]/div/table/tbody/tr/td/input"
                    EmpowertoProcess.FileAttachPath = "//input[@id='pageTemplateForm:empowermentTable:9:empowerment']"
                    EmpowertoProcess.FileRemPath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr[10]/td[3]/div/span/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    EmpowertoProcess.MOU = sSweatEqPgmMOU

                    Call ProcessEmpowerment(EmpowertoProcess, returnValues, actionHistoryRecordID, "Sweat-Equity Programs")
                End If

            End If

            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If
ClickNext:
            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Sc4_Enter_1st_Distr_Prior_Sp_Needs_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='unitsReserved']/tbody/tr/td[2]/label"
            'click the no option button


            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button for reserving units for special needs.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button for reserving units for special needs.", myLogPath, , actionHistoryRecordID)

            End If

            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If



            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Sc5_Enter_1st_Distr_Prior_Rural_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim NoButton As String = "//table[@id='fiftyPercentRuralQuestion']/tbody/tr/td[2]/label"
            Dim YesButton As String = "//table[@id='fiftyPercentRuralQuestion']/tbody/tr/td[1]/label"
            Dim OptionPath As String = Nothing
            Dim sQualRural As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "FirstD_Rural_50%?")
            Dim sUnits As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "FirstD_Rural_NbrUnits")
            Dim sBrowseFileName As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "FirstD_Rural_File")
            Dim TargetYes As String = "//table[@id='ruralSiteNotYetIdentified']/tbody/tr/td[1]/label"
            Dim TargetNo As String = "//table[@id='ruralSiteNotYetIdentified']/tbody/tr/td[2]/label"
            Dim sTargetRural As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "FirstD_Rural_Unknown_NotRural?")
            Dim sNumberHouseholds As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "FirstD_Rural_NbrUnits_2yr>")
            Dim sPercentageHouseholds As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "FirstD_Rural_%HHServe_2yr")
            Dim a As New AutomationObject

            If CleanString(sQualRural) = "YES" Then
                OptionPath = YesButton
            Else
                If CleanString(sQualRural) = "NO" Then
                    OptionPath = NoButton
                Else
                    If Not sQualRural Is Nothing Then
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for if qualify for rural: " & sQualRural & " Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                        GoTo ClickSave
                    Else
                        GoTo ClickNext
                    End If

                End If
            End If

            'Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(OptionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sQualRural.ToString & " button within the rural area.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the " & sQualRural.ToString & " button within the rural area.", myLogPath, , actionHistoryRecordID)


            End If

            Dim u As New AutomationObject
            If Not sUnits = String.Empty Then
                u.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='numOfUnitsReservedForRuralArea']"))
                If Not u.aObject Is Nothing Then
                    u.aElement = DirectCast(u.aObject, IWebElement)
                    u.aElement.SendKeys(Keys.Control + "a")
                    u.aElement.SendKeys(sUnits)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Entered units: " & sUnits.ToString, myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter units."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sUnits.ToString & " units.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            Dim FileToUpload As New BrowseFileParms
            FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/div/div[1]/div/div/table/tbody/tr/td/table/tbody/tr[2]/td[1]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
            FileToUpload.AttachPath = "//input[@id='pageTemplateForm:usdaMapAttachment']"
            FileToUpload.FileToAttach = sBrowseFileName
            Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "FirstD_Rural_File")




            If CleanString(sTargetRural) = "YES" Then
                OptionPath = TargetYes
            Else
                If CleanString(sTargetRural) = "NO" Then
                    OptionPath = TargetNo
                Else
                    If Not sTargetRural Is Nothing Then
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for targeted area not located in a rural area: " & sTargetRural & " Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                        GoTo ClickNext
                    Else
                        GoTo ClickNext
                    End If

                End If
            End If

            'Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(OptionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sTargetRural.ToString & " button within the rural area.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the " & sTargetRural.ToString & " button within the rural area.", myLogPath, , actionHistoryRecordID)


                Dim v As New AutomationObject
                If Not sNumberHouseholds = String.Empty Then
                    v.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='numOfHouseHoldServed']"))
                    If Not v.aObject Is Nothing Then
                        v.aElement = DirectCast(v.aObject, IWebElement)
                        v.aElement.SendKeys(Keys.Control + "a")
                        v.aElement.SendKeys(sNumberHouseholds)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Entered number of housholds as: " & sNumberHouseholds.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter number of households."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sNumberHouseholds.ToString & " number of households.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If

                Dim w As New AutomationObject
                If Not sPercentageHouseholds = String.Empty Then
                    w.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='percentageOfHouseHold']"))
                    If Not w.aObject Is Nothing Then
                        w.aElement = DirectCast(w.aObject, IWebElement)
                        w.aElement.SendKeys(Keys.Control + "a")
                        w.aElement.SendKeys(sPercentageHouseholds)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Entered percentage of housholds served: " & sPercentageHouseholds.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter percentage of households served."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sPercentageHouseholds.ToString & " percentage of households served.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
            End If


ClickSave:
            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If
ClickNext:
            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If


            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function

    Public Function SC6_Enter_1st_Distr_Prior_In_Distr_Proj_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPathNo As String = "//table[@id='isInDistrictProjectQuestion']/tbody/tr/td[2]/label"
            Dim optionPathYes As String = "//table[@id='isInDistrictProjectQuestion']/tbody/tr/td[1]/label"


            Dim yesNo As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "FirstD_In_DistrPt_Qual?")


            Dim a As New AutomationObject
            If yesNo.ToUpper = "YES" Then
                a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPathYes))
                If Not a.aObject Is Nothing Then
                    a.aElement = DirectCast(a.aObject, IWebElement)
                    a.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the yes button for in-district points.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the yes button for in-district points.", myLogPath, , actionHistoryRecordID)
                End If

            ElseIf yesNo.ToUpper = "NO" Then
                a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPathNo))
                If Not a.aObject Is Nothing Then
                    a.aElement = DirectCast(a.aObject, IWebElement)
                    a.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button for in-district points.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button for in-district points.", myLogPath, , actionHistoryRecordID)
                End If

            Else
                GoTo NextButton
                mosaicDll.Logger(senderMCPAction, "Actual Result| Yes / No not provided:  Skipped clicking button.", myLogPath, , actionHistoryRecordID)
            End If


SaveButton:
            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

NextButton:
            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If
            returnValues(1) = "(* no score version  *)"
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Sc7_Enter_2nd_Distr_Prior_Readi_to_Proceed_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='considerPoints']/tbody/tr/td[2]/label"
            'click the no option button


            Dim a As New AutomationObject
            'a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            'If Not a.aObject Is Nothing Then
            '    a.aElement = DirectCast(a.aObject, IWebElement)
            '    a.aElement.Click()
            '    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button for readiness to proceed points.", myLogPath, , actionHistoryRecordID)
            'Else
            '    returnValues(0) = executionStatusFailed
            '    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button for readiness to proceed points.", myLogPath, , actionHistoryRecordID)

            'End If
            Dim sReadinessToProceedQual As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_ReadiPt?")
            Dim sSiteControl100Percent As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_SiteControl_100%?")
            Dim sComplyWZoning As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_Zone_Comply?")
            Dim sFundsCommitted50Percent As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_Fund_50%_Commit?")

            Dim this_Object As Object = Nothing
            Dim this_Element As IWebElement = Nothing
            Dim sXPath As String = String.Empty
            Dim Readiness_Object As Object = Nothing
            Dim Readiness_Element As IWebElement = Nothing

            If sReadinessToProceedQual.ToUpper = "NO" Then
                'select answer 'No' for sReadinessToProceedQual
                Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label/input"))
                If Not Readiness_Object Is Nothing Then
                    Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                    Readiness_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Qualified Readiness to Proceed NO button", myLogPath, , actionHistoryRecordID)
                    GoTo SaveButton
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not click Qualified Readiness to Proceed NO button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Qualified Readiness to Proceed NO button", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextButton
                End If
            ElseIf sReadinessToProceedQual.ToUpper = "YES" Then
                'select answer 'Yes' for sReadinessToProceedQual
                Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/table/tbody/tr/td[2]/table/tbody/tr/td[1]/label/input"))
                If Not Readiness_Object Is Nothing Then
                    Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                    Readiness_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Qualified Readiness to Proceed YES button", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not click Qualified Readiness to Proceed YES button"
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click Qualified Readiness to Proceed YES button", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo NextButton
                End If
            ElseIf Not sReadinessToProceedQual Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Value for Qualifed Readiness to Proceed Button Invalid: " & sReadinessToProceedQual.ToString()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Value specifed for Qualifed Readiness to Proceed Button Invalid: " & sReadinessToProceedQual.ToString(), myLogPath, actionHistoryRecordID)

                GoTo NextButton
            End If

            ' Check for Site Control

            Readiness_Object = Nothing
            Readiness_Element = Nothing

            If Not sSiteControl100Percent Is String.Empty Then
                If sSiteControl100Percent.ToUpper = "NO" Then
                    'select answer 'No' for sSiteControl100Percent 
                    Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/div/table/tbody/tr[4]/td/div/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label"))
                    If Not Readiness_Object Is Nothing Then
                        Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                        Readiness_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Site Control 100% NO button", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not click SiteControl100Percent NO button"
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click SiteControl100Percent NO button", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                ElseIf sSiteControl100Percent.ToUpper = "YES" Then
                    'select answer 'Yes' for sSiteControl100Percent
                    Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='haveSiteControl']/tbody/tr/td[1]/label"))
                    If Not Readiness_Object Is Nothing Then
                        Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                        Readiness_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked SiteControl100Percent YES button", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not click SiteControl100Percent YES button"
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click SiteControl100Percent YES button", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                ElseIf Not sSiteControl100Percent Is Nothing Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Value for SiteControl100Percent  Button Invalid: " & sSiteControl100Percent.ToString()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Value specifed for SiteControl100Percent Button Invalid: " & sSiteControl100Percent.ToString(), myLogPath, , actionHistoryRecordID)


                End If
            End If
            ' Check for Zoning 
            Readiness_Object = Nothing
            Readiness_Element = Nothing
            If Not sComplyWZoning Is String.Empty Then
                If sComplyWZoning.ToUpper = "NO" Then
                    'select answer 'No' for sComplyWZoning
                    Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='currentZoning']/tbody/tr/td[2]/label"))
                    If Not Readiness_Object Is Nothing Then
                        Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                        Readiness_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked ComplyWZoning NO button", myLogPath, , actionHistoryRecordID)

                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not click ComplyWZoning NO button"
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click ComplyWZoning NO button", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                ElseIf sComplyWZoning.ToUpper = "YES" Then
                    'select answer 'Yes' for sComplyWZoning
                    Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='currentZoning']/tbody/tr/td[1]/label"))
                    If Not Readiness_Object Is Nothing Then
                        Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                        Readiness_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked ComplyWZoning YES button", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not click ComplyWZoning  YES button"
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click ComplyWZoning YES button", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                ElseIf Not sComplyWZoning Is Nothing Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Value for ComplyWZoning Button Invalid: " & sComplyWZoning.ToString()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Value specifed for ComplyWZoning Button Invalid: " & sComplyWZoning.ToString(), myLogPath, , actionHistoryRecordID)


                End If
            End If
            ' Check for Funding Source at least 50% 
            Readiness_Object = Nothing
            Readiness_Element = Nothing

            If Not sFundsCommitted50Percent Is Nothing Then
                If sFundsCommitted50Percent.ToUpper = "NO" Then
                    'select answer 'No' for sFundsCommitted50Percent
                    Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/div/table/tbody/tr[6]/td/div/table/tbody/tr/td[2]/table/tbody/tr/td[2]/label/input"))
                    If Not Readiness_Object Is Nothing Then
                        Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                        Readiness_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked FundsCommitted50Percent NO button", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not FundsCommitted50Percent NO button"
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click FundsCommitted50Percent NO button", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                ElseIf sFundsCommitted50Percent.ToUpper = "YES" Then
                    'select answer 'Yes' for sFundsCommitted50Percent
                    Readiness_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/div/table/tbody/tr[6]/td/div/table/tbody/tr/td[2]/table/tbody/tr/td[1]/label/input"))
                    If Not Readiness_Object Is Nothing Then
                        Readiness_Element = DirectCast(Readiness_Object, IWebElement)
                        Readiness_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked FundsCommitted50Percent YES button", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not click FundsCommitted50Percent YES button"
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click FundsCommitted50Percent YES button", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)

                    End If
                ElseIf Not sFundsCommitted50Percent Is Nothing Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Value for FundsCommitted50Percent Invalid: " & sFundsCommitted50Percent.ToString()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Value specifed for FundsCommitted50Percent Invalid: " & sFundsCommitted50Percent.ToString(), myLogPath, , actionHistoryRecordID)

                End If
            End If
SaveButton:
            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If
NextButton:
            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try

    End Function
    Public Function Sc8_Enter_2nd_Distr_Prior_Mbr_Finan_Part_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "/html/body/div[4]/form/div[2]/div[2]/table/tbody/tr/td[2]/table/tbody/tr[2]/td[1]/div/input"
            Dim noXPath As String = "//table[@id='memberFinancialParticipationRadio']/tbody/tr/td[2]/label"
            Dim yesXpath As String = "//table[@id='memberFinancialParticipationRadio']/tbody/tr/td[1]/label"
            Dim yes2Xpath As String = "//table[@id='memberFinancialParticipationCostRadio']/tbody/tr/td[1]/label"
            Dim no2Xpath As String = "//table[@id='memberFinancialParticipationCostRadio']/tbody/tr/td[2]/label"
            Dim bIsSelected As Boolean = False
            Dim check1 As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/div/table[1]/tbody/tr[1]/td/table/tbody/tr/td[1]/div/table/tbody/tr/td/input"
            Dim check2 As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/div/table[1]/tbody/tr[2]/td/table/tbody/tr/td[1]/div/table/tbody/tr/td/input"
            Dim check3 As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div/div/table[1]/tbody/tr[3]/td/table/tbody/tr/td[1]/div/table/tbody/tr/td/input"
            Dim Save As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim browse As String = "//input[@id='pageTemplateForm:mfpAttachment']"
            Dim cdAutomate As New AutomationObject
            Dim IsNullOrEmpty As Boolean = False
            Dim sFile As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_Fin_Commit_File")
            Dim sCrossmark1 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_RE1_LTFIN_GT10%_or_HO1_GT75%")
            Dim sCrossmark2 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_RE2_LTFIN_GT_EQ_5%_LT_10%_or_HO2_GT25%_LT75%")
            Dim sCrossmark3 As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_RE3_STFIN_or_HO3_GT_EQ_10%_LT_25%")
            Dim sFHLBCmemPart As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_Mbr_FinRole?")
            Dim sProjType As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Project_Type")
            Dim sHOReduceCloseCosts As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "SecD_HO_Mbr_Red_Close_Costs?")


            ' Click  <<SecD_Mbr_FinRole?>> radial button by "Will the FHLBC member applicant(s) play a financial role in the development of the project ..."
            If CleanString(sFHLBCmemPart) = "NO" Then

                Dim a1 As New AutomationObject
                a1.aObject = WaitForElement(driver, WaitForTime, By.XPath(noXPath))
                If Not a1.aObject Is Nothing Then
                    a1.aElement = DirectCast(a1.aObject, IWebElement)
                    a1.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button for member playing a financial role.", myLogPath, , actionHistoryRecordID)
                    GoTo CheckHome
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not click the no button for member playing a financial role."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button for member playing a financial role.", myLogPath, , actionHistoryRecordID)
                    GoTo NextStep
                End If

            Else

                If CleanString(sFHLBCmemPart) = "YES" Then
                    Dim a2 As New AutomationObject
                    a2.aObject = WaitForElement(driver, WaitForTime, By.XPath(yesXpath))
                    If Not a2.aObject Is Nothing Then
                        a2.aElement = DirectCast(a2.aObject, IWebElement)
                        a2.aElement.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the yes Radio button for member playing a financial role.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not click the yes button for member playing a financial role."
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click  the yes Radio button for member playing a financial role.", myLogPath, , actionHistoryRecordID)
                        GoTo NextStep
                    End If
                ElseIf Not String.IsNullOrEmpty(sFHLBCmemPart) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Invalid value for if member is playing a financial role."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for if member is playing a financial role: " & sFHLBCmemPart & " Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                    GoTo NextStep
                End If

            End If

            ' project type findings

            'Implement the check logic for check 2 then check 1 then check 3 
            Dim Check1Done As Boolean = False
            If CleanString(sCrossmark2) = "X" And CleanString(sCrossmark1) = "R" Then
                Dim cbchk1 As New AutomationObject

                cbchk1.aObject = WaitForElement(driver, WaitForTime, By.XPath(check1))
                If Not cbchk1.aObject Is Nothing Then
                    cbchk1.aElement = DirectCast(cbchk1.aObject, IWebElement)
                    If cbchk1.aElement.Selected = False Then
                        'proper state
                    Else
                        cbchk1.aElement.Click()
                    End If
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Unchecked first Checkbox ", myLogPath, , actionHistoryRecordID)
                    Check1Done = True
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not Find first Checkbox for a financial role."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not Find first Checkbox for a financial role.", myLogPath, , actionHistoryRecordID)
                    GoTo ThirdCheck
                End If

            End If
            If Not String.IsNullOrEmpty(sCrossmark2) Then

                Dim cb As New AutomationObject

                cb.aObject = WaitForElement(driver, WaitForTime, By.XPath(check2))
                If Not cb.aObject Is Nothing Then
                    cb.aElement = DirectCast(cb.aObject, IWebElement)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not Find second Checkbox for a financial role."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not Find second Checkbox for a financial role.", myLogPath, , actionHistoryRecordID)
                    GoTo SecondCheck
                End If

                If CleanString(sCrossmark2) = "X" Then
                    If cb.aElement.Selected = True Then
                        'proper state
                    Else
                        cb.aElement.Click()
                    End If
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the second Checkbox ", myLogPath, , actionHistoryRecordID)
                ElseIf CleanString(sCrossmark2) = "R" Then
                    If cb.aElement.Selected = False Then
                        'proper state
                    Else
                        cb.aElement.Click()
                    End If
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Unclicked the second Checkbox ", myLogPath, , actionHistoryRecordID)
                End If

            End If
SecondCheck:
            If Not String.IsNullOrEmpty(sCrossmark1) Then

                If Check1Done = False Then
                    Dim cb1 As New AutomationObject

                    cb1.aObject = WaitForElement(driver, WaitForTime, By.XPath(check1))
                    If Not cb1.aObject Is Nothing Then
                        cb1.aElement = DirectCast(cb1.aObject, IWebElement)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not Find first Checkbox for a financial role."
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not Find first Checkbox for a financial role.", myLogPath, , actionHistoryRecordID)
                        GoTo ThirdCheck
                    End If

                    If CleanString(sCrossmark1) = "X" Then
                        If cb1.aElement.Selected = True Then
                            'proper state
                        Else
                            cb1.aElement.Click()
                        End If
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the first Checkbox", myLogPath, , actionHistoryRecordID)
                    ElseIf CleanString(sCrossmark1) = "R" Then
                        If cb1.aElement.Selected = False Then
                            'proper state
                        Else
                            cb1.aElement.Click()
                        End If
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Unchecked first Checkbox ", myLogPath, , actionHistoryRecordID)
                    End If
                End If
            End If
ThirdCheck:
            If Not String.IsNullOrEmpty(sCrossmark3) Then
                Dim cb2 As New AutomationObject

                cb2.aObject = WaitForElement(driver, WaitForTime, By.XPath(check3))
                If Not cb2.aObject Is Nothing Then
                    cb2.aElement = DirectCast(cb2.aObject, IWebElement)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not Find third Checkbox for a financial role."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not Find third Checkbox for a financial role.", myLogPath, , actionHistoryRecordID)
                    GoTo BrowseFile
                End If

                If CleanString(sCrossmark3) = "X" Then
                    If cb2.aElement.Selected = True Then
                        'proper state
                    Else
                        cb2.aElement.Click()
                    End If
                    mosaicDll.Logger(senderMCPAction, "Actual Result|| Clicked the third Checkbox", myLogPath, , actionHistoryRecordID)
                ElseIf CleanString(sCrossmark3) = "R" Then
                    If cb2.aElement.Selected = False Then
                        'proper state
                    Else
                        cb2.aElement.Click()
                    End If
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Unchecked third Checkbox ", myLogPath, , actionHistoryRecordID)
                End If


            End If

BrowseFile:
            'Browse

            If Not String.IsNullOrEmpty(sFile) Then

                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[2]/td/div[1]/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:mfpAttachment']"
                FileToUpload.FileToAttach = sFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Commitment of Financial Involvement")

            End If
CheckHome:
            If sProjType.ToUpper.Trim = "HOME OWNERSHIP" Then
                ' Set xpath to click yes or no for extra Home Owner question on Whether member will reduce closing costs
                Dim ReduceClCostXPATH As String = Nothing
                If Not String.IsNullOrEmpty(sHOReduceCloseCosts) Then
                    If CleanString(sHOReduceCloseCosts) = "YES" Then
                        ReduceClCostXPATH = yes2Xpath
                    Else
                        If CleanString(sHOReduceCloseCosts) = "NO" Then
                            ReduceClCostXPATH = no2Xpath
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Invalid Value for Reduced Closing Costs Specified: " & sHOReduceCloseCosts
                            mosaicDll.Logger(senderMCPAction, "Actual Result|  Invalid Value for Reduced Closing Costs Specified: " & sHOReduceCloseCosts & " Expected Yes or No", myLogPath, , actionHistoryRecordID)
                            GoTo Save
                        End If
                    End If
                End If

                'Click the option'

                Dim a4 As New AutomationObject
                a4.aObject = WaitForElement(driver, WaitForTime, By.XPath(ReduceClCostXPATH))
                If Not a4.aObject Is Nothing Then
                    a4.aElement = DirectCast(a4.aObject, IWebElement)
                    a4.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sHOReduceCloseCosts & " Radio button for member providing reduced closing costs.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click  Clicked the " & sHOReduceCloseCosts & " Radio button for member providing reduced closing costs.", myLogPath, , actionHistoryRecordID)

                End If
            End If

Save:
            'click save button
            Dim savebutton As New AutomationObject
            savebutton.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not savebutton.aObject Is Nothing Then
                savebutton.aElement = DirectCast(savebutton.aObject, IWebElement)
                savebutton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If
NextStep:
            'click next button
            Dim nextbutton As New AutomationObject
            nextbutton.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not nextbutton.aObject Is Nothing Then
                nextbutton.aElement = DirectCast(nextbutton.aObject, IWebElement)
                nextbutton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function SC9_Enter_Community_Stability_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='communityStabilityRadio']/tbody/tr/td[2]/label"
            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button for community stability points.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button for community stability points.", myLogPath, , actionHistoryRecordID)

            End If

            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            returnValues(1) = "(* no score version  *)"
            Return returnValues

        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function ScNPH1_Enter_IF_NonProfit_Enter_Roles_Save_or_Next_on_No(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='orgInvolved']/tbody/tr/td[2]/label"
            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button that sponsor is not a non-profit organization.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button that sponsor is not a non-profit organization.", myLogPath, , actionHistoryRecordID)

            End If

            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            returnValues(1) = "(* no score version  *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function SCNPR1_Enter_Own_Struct_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sOwnershipDescription As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "OwnStruct_Describe")
            Dim sOwnerStructureChartFile As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "OwnStruct_File")
            Dim sOwnershipStructure As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "OwnStruct-LP_or_WO?")
            Dim sLP_LLCName As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "LP/LLC_Name")
            Dim sLP_Percent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Lim_Partner_%")
            Dim sGP_Percent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Gen_Partner_%")

            Dim sPartner1Name As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner1_Name")
            Dim sPartner1OwnershipPercent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner1_Own_%")
            Dim sPartner1LPorGP As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner1_LP_or_GP?")
            Dim sNbrofPartners As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Nbr_Of_Partners")

            Dim sPartner2Name As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner2_Name")
            Dim sPartner2OwnershipPercent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner2_Own_%")
            Dim sPartner2LPorGP As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner2_LP_or_GP?")

            Dim sPartner3Name As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner3_Name")
            Dim sPartner3OwnershipPercent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner3_Own_%")
            Dim sPartner3LPorGP As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner3_LP_or_GP?")

            Dim sPartner4Name As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner4_Name")
            Dim sPartner4OwnershipPercent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner4_Own_%")
            Dim sPartner4LPorGP As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner4_LP_or_GP?")

            Dim sPartner5Name As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner5_Name")
            Dim sPartner5OwnershipPercent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner5_Own_%")
            Dim sPartner5LPorGP As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner5_LP_or_GP?")

            Dim sPartner6Name As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner6_Name")
            Dim sPartner6OwnershipPercent As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner6_Own_%")
            Dim sPartner6LPorGP As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Partner6_LP_or_GP?")

            'Select Determine Ownership Structure and set variables

            Dim sOwnstructOption As String = Nothing
            Dim sTypeofOwnership As String = Nothing

            If CleanString(sOwnershipStructure) = "LP" Then
                sOwnstructOption = "//table[@id='ownershipType']/tbody/tr[1]/td/label"
                sTypeofOwnership = "Limited Partnership (LP)/Limited Liability Company (LLC)/General Partner (GP)"
            ElseIf CleanString(sOwnershipStructure) = "WO" Then
                sOwnstructOption = "//table[@id='ownershipType']/tbody/tr[2]/td/label"
                sTypeofOwnership = "Wholly owned or multiple partners (not LP, LLC or GP)"
            ElseIf Not String.IsNullOrEmpty(sOwnershipStructure) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Invalid value for Ownership structure specified; expected WO or LP: " & sOwnershipStructure.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Ownership structure specified; expected WO or LP: " & sOwnershipStructure.ToString, myLogPath, , actionHistoryRecordID)
                GoTo ClickNext
            End If
            ' Click appropriate radial button for ownership structure
            If Not sOwnstructOption Is Nothing Then
                Dim owns As New AutomationObject
                owns.aObject = WaitForElement(driver, WaitForTime, By.XPath(sOwnstructOption))
                If Not owns.aObject Is Nothing Then
                    owns.aElement = DirectCast(owns.aObject, IWebElement)
                    owns.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sTypeofOwnership & " radio button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the " & sTypeofOwnership & " radio button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            If Not sOwnerStructureChartFile = String.Empty Then
                'try to remove existing file

                Dim sOWChartPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[8]/td/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"

                Dim oOwnershipChartDoc As Object = WaitForElement(driver, WaitForTime, By.XPath(sOWChartPath))

                If Not oOwnershipChartDoc Is Nothing Then
                    Dim oOWChartElement As IWebElement = DirectCast(oOwnershipChartDoc, IWebElement)
                    oOWChartElement.Click()
                    Dim oTrysave As New AutomationObject

                    oTrysave.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
                    If Not oTrysave.aObject Is Nothing Then
                        oTrysave.aElement = DirectCast(oTrysave.aObject, IWebElement)
                        oTrysave.aElement.Click()
                    End If

                    mosaicDll.Logger(senderMCPAction, "Actual Result|Removed the previous OWnership Chart document.", myLogPath, , actionHistoryRecordID)
                End If

            End If

            If Not String.IsNullOrEmpty(sOwnershipDescription) Then
                System.Windows.Forms.Clipboard.Clear()
                Dim sRetVal As String = GetWordText(sOwnershipDescription)
                If sRetVal.ToUpper = "FILE NOT FOUND" Then
                    Dim sXpath As String = "//textarea[@id='uniqueFeaturesDescription']"
                    Dim owdesc As New AutomationObject
                    owdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not owdesc.aObject Is Nothing Then
                        owdesc.aElement = DirectCast(owdesc.aObject, IWebElement)
                        owdesc.aElement.SendKeys(Keys.Control + "a")
                        owdesc.aElement.SendKeys(sOwnershipDescription)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Ownership structure features description was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                    End If
                ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                    Dim sXpath As String = "//textarea[@id='uniqueFeaturesDescription']"
                    Dim owdesc As New AutomationObject
                    owdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not owdesc.aObject Is Nothing Then
                        owdesc.aElement = DirectCast(owdesc.aObject, IWebElement)
                        owdesc.aElement.SendKeys(Keys.Control + "a")
                        owdesc.aElement.SendKeys(Keys.Delete)

                        Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                        owdesc.aElement.SendKeys(Keys.Control + "v")

                        mosaicDll.Logger(senderMCPAction, "Actual Result|Ownership structure features description was entered from Word document.", myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No Ownership structure features description was entered: Processing Continued. ", myLogPath, , actionHistoryRecordID)
            End If

            Dim bSetFile As Boolean = False

            'if there is a file location set select it
            If Not sOwnerStructureChartFile = String.Empty Then
                If Not System.IO.File.Exists(sOwnerStructureChartFile) Then
                    'message
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & "The file named: " & sOwnerStructureChartFile & " was not found."
                    mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sOwnerStructureChartFile & " was not found.", myLogPath, , actionHistoryRecordID)
                    GoTo ClickNext
                End If
                Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:ownershipStructureAttachment']"))
                If Not oAttachFile Is Nothing Then
                    Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                    oAttachFileElement.Click()
                    oAttachFileElement.SendKeys(sOwnerStructureChartFile)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Attached Ownership Chart document.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not attach file named: " & sOwnerStructureChartFile
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sOwnerStructureChartFile, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo ClickNext
                End If
            End If

            'If LP enter LP/LLC name and ownership percentages

            If CleanString(sOwnershipStructure) = "LP" Then
                If Not String.IsNullOrEmpty(sLP_LLCName) Then
                    Dim owns As New AutomationObject
                    owns.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='lpllcName']"))
                    If Not owns.aObject Is Nothing Then
                        owns.aElement = DirectCast(owns.aObject, IWebElement)
                        owns.aElement.SendKeys(Keys.Control + "a")
                        owns.aElement.SendKeys(sLP_LLCName)
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & sLP_LLCName & " as LP/LLC Name.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter the " & sLP_LLCName & " LP/LLC Name.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
                If Not String.IsNullOrEmpty(sLP_Percent) Then
                    Dim owns As New AutomationObject
                    owns.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='lpPercent']"))
                    If Not owns.aObject Is Nothing Then
                        owns.aElement = DirectCast(owns.aObject, IWebElement)
                        owns.aElement.SendKeys(Keys.Control + "a")
                        owns.aElement.SendKeys(sLP_Percent)
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & sLP_Percent & " as Limited Partner(%).", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter the " & sLP_Percent & " as Limited Partner(%).", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If

                If Not String.IsNullOrEmpty(sGP_Percent) Then
                    Dim owns As New AutomationObject
                    owns.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='gpPercent']"))
                    If Not owns.aObject Is Nothing Then
                        owns.aElement = DirectCast(owns.aObject, IWebElement)
                        owns.aElement.SendKeys(Keys.Control + "a")
                        owns.aElement.SendKeys(sGP_Percent)
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & sGP_Percent & " as Limited Partner(%).", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter the " & sGP_Percent & " as Limited Partner(%).", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
            End If

            ' ****************************  Process Wholly Owned (WO) Case ************************************************************

            If CleanString(sOwnershipStructure) = "WO" Then
                ' Click Add Wholly Owned Partner Button
                Dim owns As New AutomationObject
                owns.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[4]/td/div/div/div/input"))
                If Not owns.aObject Is Nothing Then
                    owns.aElement = DirectCast(owns.aObject, IWebElement)
                    owns.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo ClickNext
                End If
                ' Add Add Wholly Owned Partner1
                Dim Partref As New PartnerDetailParams
                Partref.PartnerName = sPartner1Name
                Partref.NameXpath = "//input[@id='WOownerName']"
                Partref.PartnerOwnIntPercent = sPartner1OwnershipPercent
                Partref.InterestXpath = "//input[@id='WOownershipPercent']"
                Partref.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[7]/td/div/div/div[2]/div/div/input[2]"

                Dim sREsult As Boolean = AddOwnershipPartner(Partref, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                If sREsult = False Then
                    GoTo ClickNext
                End If
                If CleanString(sNbrofPartners) <= "1" Then
                    GoTo ClickSave
                Else
                    ' Click Add Wholly Owned Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[4]/td/div/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    ' Add Wholly Owned Partner 2
                    Dim Partref2 As New PartnerDetailParams
                    Partref2.PartnerName = sPartner2Name
                    Partref2.NameXpath = "//input[@id='WOownerName']"
                    Partref2.PartnerOwnIntPercent = sPartner2OwnershipPercent
                    Partref2.InterestXpath = "//input[@id='WOownershipPercent']"
                    Partref2.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[7]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult2 As Boolean = AddOwnershipPartner(Partref2, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult2 = False Then
                        GoTo ClickNext
                    End If
                End If
                If CleanString(sNbrofPartners) <= "2" Then
                    GoTo ClickSave
                Else
                    ' Click Add Wholly Owned Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[4]/td/div/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If

                    ' Add Wholly Owned Partner 3
                    Dim Partref3 As New PartnerDetailParams
                    Partref3.PartnerName = sPartner3Name
                    Partref3.NameXpath = "//input[@id='WOownerName']"
                    Partref3.PartnerOwnIntPercent = sPartner3OwnershipPercent
                    Partref3.InterestXpath = "//input[@id='WOownershipPercent']"
                    Partref3.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[7]/td/div/div/div[2]/div/div/input[2]"

                    Dim sResult3 As Boolean = AddOwnershipPartner(Partref3, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sResult3 = False Then
                        GoTo ClickNext
                    End If
                End If
                If CleanString(sNbrofPartners) <= "3" Then
                    GoTo ClickSave
                Else
                    ' Click Add Wholly Owned Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[4]/td/div/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If

                    ' Add Wholly Owned Partner 4
                    Dim Partref4 As New PartnerDetailParams
                    Partref4.PartnerName = sPartner4Name
                    Partref4.NameXpath = "//input[@id='WOownerName']"
                    Partref4.PartnerOwnIntPercent = sPartner4OwnershipPercent
                    Partref4.InterestXpath = "//input[@id='WOownershipPercent']"
                    Partref4.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[7]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult4 As Boolean = AddOwnershipPartner(Partref4, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult4 = False Then
                        GoTo ClickNext
                    End If
                End If
                If CleanString(sNbrofPartners) <= "4" Then
                    GoTo ClickSave
                Else
                    ' Click Add Wholly Owned Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[4]/td/div/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If

                    ' Add Wholly Owned Partner 5
                    Dim Partref5 As New PartnerDetailParams
                    Partref5.PartnerName = sPartner5Name
                    Partref5.NameXpath = "//input[@id='WOownerName']"
                    Partref5.PartnerOwnIntPercent = sPartner5OwnershipPercent
                    Partref5.InterestXpath = "//input[@id='WOownershipPercent']"
                    Partref5.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[7]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult5 As Boolean = AddOwnershipPartner(Partref5, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult5 = False Then
                        GoTo ClickNext
                    End If
                End If
                If CleanString(sNbrofPartners) <= "5" Then
                    GoTo ClickSave
                Else
                    ' Click Add Wholly Owned Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[4]/td/div/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Wholly Owned Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If

                    ' Add Wholly Owned Partner 6
                    Dim Partref6 As New PartnerDetailParams
                    Partref6.PartnerName = sPartner6Name
                    Partref6.NameXpath = "//input[@id='WOownerName']"
                    Partref6.PartnerOwnIntPercent = sPartner6OwnershipPercent
                    Partref6.InterestXpath = "//input[@id='WOownershipPercent']"
                    Partref6.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[7]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult6 As Boolean = AddOwnershipPartner(Partref6, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult6 = False Then
                        GoTo ClickNext
                    End If
                End If
                GoTo ClickSave
            End If

            ' ************************* Process Limited Partner (LP) Case *******************************************************************************

            If CleanString(sPartner1LPorGP) = "LP" Then
                ' Click Limited Partner Button
                Dim this_Object As Object = Nothing
                Dim this_Element As IWebElement = Nothing
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[1]/div/div/input"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo ClickNext
                End If

                ' Add Limited Partner 
                Dim LPRef As New PartnerDetailParams
                LPRef.PartnerName = sPartner1Name
                LPRef.NameXpath = "//input[@id='LPownerName']"
                LPRef.PartnerOwnIntPercent = sPartner1OwnershipPercent
                LPRef.InterestXpath = "//input[@id='LPownershipPercent']"
                LPRef.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[5]/td/div/div/div[2]/div/div/input[2]"

                Dim sREsult As Boolean = AddOwnershipPartner(LPRef, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                If sREsult = False Then
                    GoTo ClickNext
                End If
            ElseIf CleanString(sPartner1LPorGP) = "GP" Then
                ' Click General Partner Button
                Dim this_Object As Object = Nothing
                Dim this_Element As IWebElement = Nothing
                this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[2]/div/div/input"))
                If Not this_Object Is Nothing Then
                    this_Element = DirectCast(this_Object, IWebElement)
                    this_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo ClickNext
                End If

                ' Add General Partner 
                Dim GPRef As New PartnerDetailParams
                GPRef.PartnerName = sPartner1Name
                GPRef.NameXpath = "//input[@id='GPownerName']"
                GPRef.PartnerOwnIntPercent = sPartner1OwnershipPercent
                GPRef.InterestXpath = "//input[@id='GPownershipPercent']"
                GPRef.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/div/div/div[2]/div/div/input[2]"

                Dim sREsult As Boolean = AddOwnershipPartner(GPRef, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                If sREsult = False Then
                    GoTo ClickNext
                End If
            ElseIf Not String.IsNullOrEmpty(sPartner1LPorGP) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Invalid value for Partner Type specified; expected GP or LP: " & sPartner1LPorGP
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Partner Type specified; expected GP or LP: " & sPartner1LPorGP.ToString, myLogPath, , actionHistoryRecordID)

            End If

            If CleanString(sNbrofPartners) <= "1" Then
                GoTo ClickSave
            Else
                If CleanString(sPartner2LPorGP) = "LP" Then
                    ' Click Limited Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[1]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If

                    ' Add Limited Partner 
                    Dim LPRef As New PartnerDetailParams
                    LPRef.PartnerName = sPartner2Name
                    LPRef.NameXpath = "//input[@id='LPownerName']"
                    LPRef.PartnerOwnIntPercent = sPartner2OwnershipPercent
                    LPRef.InterestXpath = "//input[@id='LPownershipPercent']"
                    LPRef.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[5]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult1 As Boolean = AddOwnershipPartner(LPRef, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult1 = False Then
                        GoTo ClickNext
                    End If
                ElseIf CleanString(sPartner2LPorGP) = "GP" Then
                    ' Click General Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[2]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If

                    ' Add Limited Partner 
                    Dim GPRef2 As New PartnerDetailParams
                    GPRef2.PartnerName = sPartner2Name
                    GPRef2.NameXpath = "//input[@id='GPownerName']"
                    GPRef2.PartnerOwnIntPercent = sPartner2OwnershipPercent
                    GPRef2.InterestXpath = "//input[@id='GPownershipPercent']"
                    GPRef2.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult2 As Boolean = AddOwnershipPartner(GPRef2, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult2 = False Then
                        GoTo ClickNext
                    End If
                ElseIf Not String.IsNullOrEmpty(sPartner2LPorGP) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Invalid value for Partner Type specified; expected GP or LP: " & sPartner2LPorGP
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Partner Type specified; expected GP or LP: " & sPartner2LPorGP.ToString, myLogPath, , actionHistoryRecordID)

                End If
            End If

            If CleanString(sNbrofPartners) <= "2" Then
                GoTo ClickSave
            Else
                If CleanString(sPartner3LPorGP) = "LP" Then
                    ' Click Limited Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[1]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    'Add Limited Partner 
                    Dim LPRef As New PartnerDetailParams
                    LPRef.PartnerName = sPartner3Name
                    LPRef.NameXpath = "//input[@id='LPownerName']"
                    LPRef.PartnerOwnIntPercent = sPartner3OwnershipPercent
                    LPRef.InterestXpath = "//input[@id='LPownershipPercent']"
                    LPRef.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[5]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult1 As Boolean = AddOwnershipPartner(LPRef, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult1 = False Then
                        GoTo ClickNext
                    End If
                ElseIf CleanString(sPartner3LPorGP) = "GP" Then
                    ' Click General Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[2]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    'Add General Partner Button
                    Dim GPRef2 As New PartnerDetailParams
                    GPRef2.PartnerName = sPartner3Name
                    GPRef2.NameXpath = "//input[@id='GPownerName']"
                    GPRef2.PartnerOwnIntPercent = sPartner3OwnershipPercent
                    GPRef2.InterestXpath = "//input[@id='GPownershipPercent']"
                    GPRef2.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult2 As Boolean = AddOwnershipPartner(GPRef2, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult2 = False Then
                        GoTo ClickNext
                    End If
                ElseIf Not String.IsNullOrEmpty(sPartner3LPorGP) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Invalid value for Partner Type specified; expected GP or LP: " & sPartner3LPorGP
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Partner Type specified; expected GP or LP: " & sPartner3LPorGP.ToString, myLogPath, , actionHistoryRecordID)

                End If
            End If
            If CleanString(sNbrofPartners) <= "3" Then
                GoTo ClickSave
            Else
                If CleanString(sPartner4LPorGP) = "LP" Then
                    ' Click Limited Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[1]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    'Add Limited Partner 
                    Dim LPRef As New PartnerDetailParams
                    LPRef.PartnerName = sPartner4Name
                    LPRef.NameXpath = "//input[@id='LPownerName']"
                    LPRef.PartnerOwnIntPercent = sPartner4OwnershipPercent
                    LPRef.InterestXpath = "//input[@id='LPownershipPercent']"
                    LPRef.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[5]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult1 As Boolean = AddOwnershipPartner(LPRef, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult1 = False Then
                        GoTo ClickNext
                    End If
                ElseIf CleanString(sPartner4LPorGP) = "GP" Then
                    ' Click General Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[2]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    ' Add General Partner 
                    Dim GPRef2 As New PartnerDetailParams
                    GPRef2.PartnerName = sPartner4Name
                    GPRef2.NameXpath = "//input[@id='GPownerName']"
                    GPRef2.PartnerOwnIntPercent = sPartner4OwnershipPercent
                    GPRef2.InterestXpath = "//input[@id='GPownershipPercent']"
                    GPRef2.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult2 As Boolean = AddOwnershipPartner(GPRef2, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult2 = False Then
                        GoTo ClickNext
                    End If
                ElseIf Not String.IsNullOrEmpty(sPartner4LPorGP) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Invalid value for Partner Type specified; expected GP or LP: " & sPartner4LPorGP
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Partner Type specified; expected GP or LP: " & sPartner4LPorGP.ToString, myLogPath, , actionHistoryRecordID)
                End If
            End If
            If CleanString(sNbrofPartners) <= "4" Then
                GoTo ClickSave
            Else
                If CleanString(sPartner5LPorGP) = "LP" Then
                    ' Click Limited Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[1]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    ' Add Limited Partner 
                    Dim LPRef As New PartnerDetailParams
                    LPRef.PartnerName = sPartner5Name
                    LPRef.NameXpath = "//input[@id='LPownerName']"
                    LPRef.PartnerOwnIntPercent = sPartner5OwnershipPercent
                    LPRef.InterestXpath = "//input[@id='LPownershipPercent']"
                    LPRef.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[5]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult1 As Boolean = AddOwnershipPartner(LPRef, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult1 = False Then
                        GoTo ClickNext
                    End If
                ElseIf CleanString(sPartner5LPorGP) = "GP" Then
                    ' Click General Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[2]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    ' Add General Partner 
                    Dim GPRef2 As New PartnerDetailParams
                    GPRef2.PartnerName = sPartner5Name
                    GPRef2.NameXpath = "//input[@id='GPownerName']"
                    GPRef2.PartnerOwnIntPercent = sPartner5OwnershipPercent
                    GPRef2.InterestXpath = "//input[@id='GPownershipPercent']"
                    GPRef2.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult2 As Boolean = AddOwnershipPartner(GPRef2, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult2 = False Then
                        GoTo ClickNext
                    End If
                ElseIf Not String.IsNullOrEmpty(sPartner5LPorGP) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Invalid value for Partner Type specified; expected GP or LP: " & sPartner5LPorGP
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Partner Type specified; expected GP or LP: " & sPartner5LPorGP.ToString, myLogPath, , actionHistoryRecordID)

                End If
            End If

            If CleanString(sNbrofPartners) <= "5" Then
                GoTo ClickSave
            Else
                If CleanString(sPartner6LPorGP) = "LP" Then
                    ' Click Limited Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[1]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add Limited Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    ' Add Limited Partner 
                    Dim LPRef As New PartnerDetailParams
                    LPRef.PartnerName = sPartner6Name
                    LPRef.NameXpath = "//input[@id='LPownerName']"
                    LPRef.PartnerOwnIntPercent = sPartner6OwnershipPercent
                    LPRef.InterestXpath = "//input[@id='LPownershipPercent']"
                    LPRef.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[5]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult1 As Boolean = AddOwnershipPartner(LPRef, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult1 = False Then
                        GoTo ClickNext
                    End If
                ElseIf CleanString(sPartner6LPorGP) = "GP" Then
                    ' Click General Partner Button
                    Dim this_Object As Object = Nothing
                    Dim this_Element As IWebElement = Nothing
                    this_Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/table[3]/tbody/tr/td[2]/div/div/input"))
                    If Not this_Object Is Nothing Then
                        this_Element = DirectCast(this_Object, IWebElement)
                        this_Element.Click()
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Add General Partner Button.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    ' Add General Partner 
                    Dim GPRef2 As New PartnerDetailParams
                    GPRef2.PartnerName = sPartner6Name
                    GPRef2.NameXpath = "//input[@id='GPownerName']"
                    GPRef2.PartnerOwnIntPercent = sPartner6OwnershipPercent
                    GPRef2.InterestXpath = "//input[@id='GPownershipPercent']"
                    GPRef2.ButtonXpath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[6]/td/div/div/div[2]/div/div/input[2]"

                    Dim sREsult2 As Boolean = AddOwnershipPartner(GPRef2, returnValues, actionHistoryRecordID, "Wholly Owned Partner")
                    If sREsult2 = False Then
                        GoTo ClickNext
                    End If
                ElseIf Not String.IsNullOrEmpty(sPartner6LPorGP) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Invalid value for Partner Type specified; expected GP or LP: " & sPartner6LPorGP
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Partner Type specified; expected GP or LP: " & sPartner6LPorGP.ToString, myLogPath, , actionHistoryRecordID)

                End If
            End If

ClickSave:
            Dim oAuto As New AutomationObject

            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
                Dim sErrorMsg As String = mosaicDll.dt(excelPath, iteration, "owstruc_rental_owner_struct", "Error_Message")
                If Not String.IsNullOrEmpty(sErrorMsg) Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result |Check Error Message on Window. ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If



ClickNext:
            Dim oNext As New AutomationObject

            oNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext.aObject Is Nothing Then
                oNext.aElement = DirectCast(oNext.aObject, IWebElement)
                oNext.aElement.Click()
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the next button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues

        End Try
    End Function
    Public Function AddOwnershipPartner(ByVal PartnerRef As PartnerDetailParams, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sPartnerType As String = "") As Boolean

        Dim Did_it_work As Boolean = True
        If Not String.IsNullOrEmpty(PartnerRef.PartnerName) Then
            Dim owns As New AutomationObject
            owns.aObject = WaitForElement(driver, WaitForTime, By.XPath(PartnerRef.NameXpath))
            If Not owns.aObject Is Nothing Then
                owns.aElement = DirectCast(owns.aObject, IWebElement)
                owns.aElement.SendKeys(PartnerRef.PartnerName)
                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & PartnerRef.PartnerName & " as " & sPartnerType & "Name.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter " & PartnerRef.PartnerName & " as " & sPartnerType & "Name."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter the " & PartnerRef.PartnerName & " as " & sPartnerType & "Name.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False
            End If

        End If
        If Not String.IsNullOrEmpty(PartnerRef.PartnerOwnIntPercent) Then
            Dim owns As New AutomationObject
            owns.aObject = WaitForElement(driver, WaitForTime, By.XPath(PartnerRef.InterestXpath))
            If Not owns.aObject Is Nothing Then
                owns.aElement = DirectCast(owns.aObject, IWebElement)
                owns.aElement.SendKeys(PartnerRef.PartnerOwnIntPercent)
                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & PartnerRef.PartnerOwnIntPercent & " as " & sPartnerType & "Ownership Interest(%).", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter " & PartnerRef.PartnerOwnIntPercent & " as " & sPartnerType & "Ownership Interest(%)."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter " & PartnerRef.PartnerOwnIntPercent & " as " & sPartnerType & "Ownership Interest(%).", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False
            End If
        End If
        ' Click Update Button

        Dim obut As New AutomationObject
        obut.aObject = WaitForElement(driver, WaitForTime, By.XPath(PartnerRef.ButtonXpath))
        If Not obut.aObject Is Nothing Then
            obut.aElement = DirectCast(obut.aObject, IWebElement)
            obut.aElement.Click()
            mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Update Button for " & sPartnerType & ".", myLogPath, , actionHistoryRecordID)
        Else
            returnValues(0) = executionStatusFailed
            mosaicDll.Logger(senderMCPAction, "Actual Result| Could click Update Button for " & sPartnerType & ".", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Did_it_work = False
        End If

        AddOwnershipPartner = Did_it_work

    End Function
    Public Function SCNPR2_Enter_NonProfit_Org_Info_Save_Next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            'click the no option button
            Dim nextPath As String = "//div[@id='tab']/table[4]/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='isPrjSponsorQualifySponsorshipPointsId']/tbody/tr/td[2]/label"
            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button that sponsor is not a non-profit organization.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button that sponsor is not a non-profit organization.", myLogPath, , actionHistoryRecordID)

            End If

            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            returnValues(1) = "(* no score version  *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas2_Val_Enter_Feas_Analysis(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//div[@id='tab']/table[4]/tbody/tr/td[2]/a"

            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim feastablePath As String = "//table[@id='pageTemplateForm:issuesTable']/thead/tr[1]/th"
            Dim NoIssuesMsgPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/span/table/tbody/tr/td/table/tbody/tr/td/ul/li/span"
            Dim feascheck As New AutomationObject
            feascheck.aObject = WaitForElement(driver, WaitForTime, By.XPath(NoIssuesMsgPath))
            If Not feascheck.aObject Is Nothing Then
                feascheck.aElement = DirectCast(feascheck.aObject, IWebElement)
                Dim sElementValue As String = feascheck.aElement.Text
                If sElementValue.ToUpper = "No Feasibility issues were found. No action is required on this tab.".ToUpper Then
                    returnValues(1) = returnValues(1) & " No feasibility exceptions"
                    mosaicDll.Logger(senderMCPAction, "Actual Result| No Feasibility Issues Reported - Continuing to Click Next", myLogPath, , actionHistoryRecordID)
                    GoTo ClickNext
                Else
                    returnValues(1) = returnValues(1) & " Message found but not Reporting No Issues"
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Message Found but not No Feasibility Issues.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
            feascheck.aObject = WaitForElement(driver, WaitForTime, By.XPath(feastablePath))
            If feascheck.aObject Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Feasibility Issue Table Not Found and No Message indicating No Issues"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Feasibility Issue Table Not Found and No Message indicating No Issues", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo ClickNext
            End If
            Dim LinkBaseXpath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table[2]/tbody/tr["
            Dim LinkEndXpath As String = "]/td[1]/div/a"
            Dim FeasIndex As Integer = 1
            Dim ValueBaseXpath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table[2]/tbody/tr["
            Dim ValueEndXpath As String = "]/td[2]/span"
            Dim ActualBaseXpath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table[2]/tbody/tr["
            Dim ActualEndXpath As String = "]/td[5]/div/span"
            Dim MaxTable As Integer = 24
            Dim CompleteXPath As String
            Dim ComplXPATHValue As String
            Dim ComplXPATHActual As String
            Dim sValue As String
            Dim sActual As String
            Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table"))

            '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td


            Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table[2]/tbody/tr"))
            Dim Counter As Integer = 0
            'Dim tableElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//td[@id='pageTemplateForm:issuesTable'"))
            For Each row As IWebElement In rowCollection
                Counter = Counter + 1
                FeasIndex = Counter
                Dim Pathadd As String = FeasIndex
                ComplXPATHValue = ValueBaseXpath & Pathadd & ValueEndXpath
                Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
                wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))
                Dim Val As New AutomationObject
                Val.aObject = WaitForElement(driver, WaitForTime, By.XPath(ComplXPATHValue))
                If Not Val.aObject Is Nothing Then
                    Val.aElement = DirectCast(Val.aObject, IWebElement)
                    sValue = Val.aElement.Text
                Else
                    sValue = Nothing
                End If
                ' Get Actual Value Associated with Exception
                ComplXPATHActual = ActualBaseXpath & Pathadd & ActualEndXpath
                Dim ActText As New AutomationObject
                ActText.aObject = WaitForElement(driver, WaitForTime, By.XPath(ComplXPATHActual))
                If Not ActText.aObject Is Nothing Then
                    ActText.aElement = DirectCast(ActText.aObject, IWebElement)
                    sActual = ActText.aElement.Text
                Else
                    sActual = Nothing
                End If
                ' Click Explain

                Dim a As New AutomationObject
                CompleteXPath = LinkBaseXpath & Pathadd & LinkEndXpath
                a.aObject = WaitForElement(driver, WaitForTime, By.XPath(CompleteXPath))
                If Not a.aObject Is Nothing Then
                    a.aElement = DirectCast(a.aObject, IWebElement)
                    a.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Info| Clicked the Explain Link in Position " & FeasIndex, myLogPath, , actionHistoryRecordID)
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Finished Processing " & FeasIndex & " Issues", myLogPath, , actionHistoryRecordID)
                    Exit For
                End If
                'Dim Explain As New AutomationObject
                a.aObject = WaitForElement(driver, WaitForTime, By.XPath("//textarea[@id='explanation']"))
                If Not a.aObject Is Nothing Then
                    a.aElement = DirectCast(a.aObject, IWebElement)
                    a.aElement.SendKeys(Keys.Control + "a")
                    a.aElement.SendKeys("Explanation for Issue " & sValue & " with Actual Value " & sActual)
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Entered 'Explanation for Issue: " & sValue & " with Actual Value " & sActual & " for Issue in Position " & FeasIndex, myLogPath, , actionHistoryRecordID)
                    'Dim Update As New AutomationObject
                    a.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div/div/div[2]/table[1]/tbody/tr/td[2]/input"))
                    If Not a.aObject Is Nothing Then
                        a.aElement = DirectCast(a.aObject, IWebElement)
                        a.aElement.Click()
                        mosaicDll.Logger(senderMCPAction, "Info| Clicked to Update Explanation for Issue in Position " & FeasIndex, myLogPath, , actionHistoryRecordID)

                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could click Update for explanation for Issue " & FeasIndex
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter click update for Issue " & FeasIndex, myLogPath, , actionHistoryRecordID)
                        Exit For
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not enter explanation for Issue " & FeasIndex
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter explanation for Issue " & FeasIndex, myLogPath, , actionHistoryRecordID)
                    Exit For
                End If

            Next


            mosaicDll.Logger(senderMCPAction, "Actual Result| Finished Processing " & Counter.ToString & "Issues", myLogPath, , actionHistoryRecordID)

            'click save button.
            Dim save As New AutomationObject
            save.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not save.aObject Is Nothing Then
                save.aElement = DirectCast(save.aObject, IWebElement)
                save.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

ClickNext:  'click next button
            Dim nextbutton As New AutomationObject

            nextbutton.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not nextbutton.aObject Is Nothing Then
                nextbutton.aElement = DirectCast(nextbutton.aObject, IWebElement)
                nextbutton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function

    Public Function Feas2b_Enter_Commitment_Letter(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sNbrCommitmentLetters As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Nbr_of_Commitment_Letters")
            Dim sSrceofFunds1 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds1")
            Dim sSrceDescr1 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc1")
            Dim sCommitAmt1 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt1")
            Dim sCLetter1 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter1")

            Dim sSrceofFunds2 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds2")
            Dim sSrceDescr2 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc2")
            Dim sCommitAmt2 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt2")
            Dim sCLetter2 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter2")

            Dim sSrceofFunds3 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds3")
            Dim sSrceDescr3 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc3")
            Dim sCommitAmt3 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt3")
            Dim sCLetter3 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter3")

            Dim sSrceofFunds4 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds4")
            Dim sSrceDescr4 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc4")
            Dim sCommitAmt4 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt4")
            Dim sCLetter4 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter4")

            Dim sSrceofFunds5 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds5")
            Dim sSrceDescr5 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc5")
            Dim sCommitAmt5 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt5")
            Dim sCLetter5 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter5")

            Dim sSrceofFunds6 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds6")
            Dim sSrceDescr6 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc6")
            Dim sCommitAmt6 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt6")
            Dim sCLetter6 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter6")

            Dim sSrceofFunds7 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds7")
            Dim sSrceDescr7 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc7")
            Dim sCommitAmt7 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt7")
            Dim sCLetter7 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter7")

            Dim sSrceofFunds8 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Srce_of_Funds8")
            Dim sSrceDescr8 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Src_Desc8")
            Dim sCommitAmt8 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Auto_Amt8")
            Dim sCLetter8 As String = mosaicDll.dt(excelPath, iteration, "appcom_commitment_letters", "Commitment_Letter8")

            Dim sProjInclOperSubsidies As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "CL_Proj_Inc_Oper_Subsidies?")
            Dim sTypeOperSubsidy As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "CL_Type_Oper_Subsidy")
            Dim sLengthSubsidy As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "CL_Lgth_Subsidy")
            Dim sFileEvidenceSubsidy As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "CL_File_Evidence_Subsidy")
            Dim nextPath As String = "//div[@id='tab']/table[4]/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = Nothing


            'changes to this will result in not finding the proper element
            'this is how I find the option element to select once the text is located
            Dim prefixAttachXPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr["
            Dim suffixAttachPath As String = "]/td[1]/div/a"
            Dim prefixSourceXPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr["
            Dim suffixSourcePath As String = "]/td[2]"
            Dim prefixDescXPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr["
            Dim suffixDescPath As String = "1]/td[3]/span"
            Dim prefixAmtXPath As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr["
            Dim suffixAmtPath As String = "]/td[4]/span"

            If sNbrCommitmentLetters > 0 Then
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                ' First Letter
                For Each row As IWebElement In rowCollection
                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds1) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt1 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter1
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds1)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds1.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds1.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If

            ElseIf sNbrCommitmentLetters = 0 Or String.IsNullOrEmpty(sNbrCommitmentLetters) Then
                Dim oTable As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='pageTemplateForm:commitmentLettersTable']/thead/tr[1]/th"))
                If Not oTable Is Nothing Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Commitment Letter Table Exists But Nbr Commitment Letters Specified 0 or Null "
                    mosaicDll.Logger(senderMCPAction, "Actual Result| ommitment Letter Table Exists But Nbr Commitment Letters Specified 0 or Null: Expected 1 - 8.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                Else
                    GoTo OperSubsidy
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Invalid Number Specified for Nbr of Commitment Letters " & sNbrCommitmentLetters.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid Number Specified for Nbr of Commitment Letters: " & sNbrCommitmentLetters.ToString & "Expected 1 - 8.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            'Second Letter
            If sNbrCommitmentLetters > 1 Then
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))
                For Each row As IWebElement In rowCollection
                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds2) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt2 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter2
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds2)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds2.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds2.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                GoTo OperSubsidy
            End If
            'Third Letter
            If sNbrCommitmentLetters > 2 Then
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))

                For Each row As IWebElement In rowCollection

                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds3) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt3 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter3
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds3)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds3.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds3.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                GoTo OperSubsidy
            End If
            'Fourth Letter
            If sNbrCommitmentLetters > 3 Then
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))

                For Each row As IWebElement In rowCollection

                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds4) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt4 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter4
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds4)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds4.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds4.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                GoTo OperSubsidy
            End If
            'Fifth Letter
            If sNbrCommitmentLetters > 4 Then
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))

                For Each row As IWebElement In rowCollection

                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds5) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt5 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter5
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds5)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds5.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds5.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                GoTo OperSubsidy
            End If
            'Sixth Letter
            If sNbrCommitmentLetters > 5 Then
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))

                For Each row As IWebElement In rowCollection

                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds6) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt6 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter6
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds6)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds6.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds6.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                GoTo OperSubsidy
            End If
            'Seventh Letter
            If sNbrCommitmentLetters > 6 Then
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))

                For Each row As IWebElement In rowCollection

                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds7) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt7 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter7
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds7)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds7.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds7.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                GoTo OperSubsidy
            End If
            'Eighth Letter
            If sNbrCommitmentLetters > 7 Then
                Dim Counter As Integer = 0
                Dim FoundLetter As Boolean = False
                Dim tableElement As IWebElement = driver.FindElement(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table"))
                '/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr[1]/td[3]/span
                Dim rowCollection As IEnumerable(Of IWebElement) = tableElement.FindElements(By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/div/table[2]/tbody/tr"))

                For Each row As IWebElement In rowCollection

                    Counter = Counter + 1
                    Dim sSrceXPath As String = prefixSourceXPath & Counter & suffixSourcePath
                    Dim iSrceElement As IWebElement = driver.FindElement(By.XPath(sSrceXPath))
                    If CleanString(iSrceElement.Text) = CleanString(sSrceofFunds8) Then
                        'If row.Text.ToUpper.ToString() = sSrceofFunds1.Trim.ToUpper.ToString() Then
                        Dim sOptionXPath As String = prefixAmtXPath & Counter.ToString() & suffixAmtPath
                        Dim iOptionElement As IWebElement = driver.FindElement(By.XPath(sOptionXPath))
                        Dim CleanedMoney As String = CleanMonetaryString(iOptionElement.Text)
                        If CleanedMoney = sCommitAmt8 Then
                            Dim LetterToUpload As New CommitLetterParms
                            LetterToUpload.AttachXPATH = prefixAttachXPath & Counter & suffixAttachPath
                            LetterToUpload.LetterToAttach = sCLetter8
                            Call AttachCommitmentLetter(LetterToUpload, returnValues, actionHistoryRecordID, sSrceofFunds8)
                            FoundLetter = True
                            Exit For
                        End If
                    End If
                Next

                If FoundLetter = True Then
                    'success
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could attach commitment letter for " & sSrceofFunds8.ToString
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could attach commitment letter for " & sSrceofFunds8.ToString, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
            Else
                GoTo OperSubsidy
            End If
OperSubsidy:
            If Not String.IsNullOrEmpty(sProjInclOperSubsidies) Then
                If CleanString(sProjInclOperSubsidies) = "YES" Then
                    optionPath = "//table[@id='completedQuestion']/tbody/tr/td[1]/label"
                ElseIf CleanString(sProjInclOperSubsidies) = "NO" Then
                    optionPath = "//table[@id='completedQuestion']/tbody/tr/td[2]/label"
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Invalid Value Specified for Does Project Incl Subsidies"
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid Value Specified for Does Project Incl Subsidies: " & sProjInclOperSubsidies & " Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                End If
            End If
            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sProjInclOperSubsidies & "  button concerning subsidizing on-going operations.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the " & sProjInclOperSubsidies & " button concerning subsidizing on-going operations.", myLogPath, , actionHistoryRecordID)

            End If
            If CleanString(sProjInclOperSubsidies) = "YES" Then
                If Not String.IsNullOrEmpty(sTypeOperSubsidy) Then
                    Dim TextAreaInfo As New TextAreaParms
                    TextAreaInfo.TextToEnter = sProjInclOperSubsidies
                    TextAreaInfo.TextAreaXpath = "//textarea[@id='subsidyType']"
                    Call EnterTextArea(TextAreaInfo, returnValues, actionHistoryRecordID, "Type of Operating Subsidy")
                End If
                If Not String.IsNullOrEmpty(sLengthSubsidy) Then
                    a.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='subsidyYears']"))
                    If Not a.aObject Is Nothing Then
                        a.aElement = DirectCast(a.aObject, IWebElement)
                        a.aElement.SendKeys(Keys.Control + "a")
                        a.aElement.SendKeys(sLengthSubsidy)
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Entered Length of Subsidy:" & sLengthSubsidy, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not enter Length of Subsidy:" & sLengthSubsidy
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter Length of Subsidy:" & sLengthSubsidy, myLogPath, , actionHistoryRecordID)
                    End If
                End If
                If Not String.IsNullOrEmpty(sFileEvidenceSubsidy) Then
                    Dim FileToUpload As New BrowseFileParms
                    FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/div/div/div[2]/div/table/tbody/tr[2]/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                    FileToUpload.AttachPath = "//input[@id='pageTemplateForm:subsidyFile']"
                    FileToUpload.FileToAttach = sFileEvidenceSubsidy
                    Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Evidence of Operating Subsidy")
                End If
            End If

            'click save button
            Dim savebutton As New AutomationObject
            savebutton.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not savebutton.aObject Is Nothing Then
                savebutton.aElement = DirectCast(savebutton.aObject, IWebElement)
                savebutton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If
ClickNext:
            'click next button
            Dim nextbutton As New AutomationObject
            nextbutton.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not nextbutton.aObject Is Nothing Then
                nextbutton.aElement = DirectCast(nextbutton.aObject, IWebElement)
                nextbutton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas3_Enter_Displacement(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='permanent']/tbody/tr/td[2]/label"
            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning permanent displacement of residents.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning permanent displacement of residents.", myLogPath, , actionHistoryRecordID)

            End If

            optionPath = "//table[@id='temporary']/tbody/tr/td[2]/label"
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning temporary relocation of residents.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning temporary relocation of residents.", myLogPath, , actionHistoryRecordID)

            End If



            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If

            returnValues(1) = "(* No Displ  *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas4_Enter_Sponsor_Role(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sOwnerRole As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SPRole_Owner")
            Dim sQualBorrowArrFinanceRole As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SPRole_Qual_Borrow_Arr_Finance")
            Dim sDeveloperRole As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SPRole_Developer")
            Dim sPropMgrRole As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SPRole_PropMgr")
            Dim sEmpowerSupportRole As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SPRole_Empow_or_Supportive")
            Dim sConstrMgrRole As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SPRole_Constr_Mgr")
            Dim sOtherRole As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SPRole_Other")
            Dim sOtherDescr As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "SpRole_Other_Descr")
            Dim sSponsorExperFile As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "File_Sponsor_Exper")



            If Not String.IsNullOrEmpty(sOwnerRole) Then
                Dim RoletoCheck As New SponsorRoles
                'RoletoCheck.srXPATH = "//table[@id='selectedRoleTypes']/tbody/tr[1]/td[1]/label"
                RoletoCheck.srXPATH = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr[1]/td[1]/label/input"
                RoletoCheck.SrRole = CleanString(sOwnerRole)
                Call ClickSponsorRole(RoletoCheck, returnValues, actionHistoryRecordID, "Owner")
            End If

            If Not String.IsNullOrEmpty(sQualBorrowArrFinanceRole) Then
                Dim RoletoCheck As New SponsorRoles
                'RoletoCheck.srXPATH = "//table[@id='selectedRoleTypes']/tbody/tr[2]/td[1]/label"
                RoletoCheck.srXPATH = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr[2]/td[1]/label/input"
                RoletoCheck.SrRole = CleanString(sQualBorrowArrFinanceRole)
                Call ClickSponsorRole(RoletoCheck, returnValues, actionHistoryRecordID, "Qualify Borrowers and Arrange Financing for HO")
            End If

            If Not String.IsNullOrEmpty(sDeveloperRole) Then
                Dim RoletoCheck As New SponsorRoles
                'RoletoCheck.srXPATH = 
                RoletoCheck.srXPATH = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr[3]/td[1]/label/input"
                RoletoCheck.SrRole = CleanString(sDeveloperRole)
                Call ClickSponsorRole(RoletoCheck, returnValues, actionHistoryRecordID, "Developer")
            End If

            If Not String.IsNullOrEmpty(sPropMgrRole) Then
                Dim RoletoCheck As New SponsorRoles
                'RoletoCheck.srXPATH = "//table[@id='selectedRoleTypes']/tbody/tr[1]/td[2]/label"
                RoletoCheck.srXPATH = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr[1]/td[2]/label/input"
                RoletoCheck.SrRole = CleanString(sPropMgrRole)
                Call ClickSponsorRole(RoletoCheck, returnValues, actionHistoryRecordID, "Property Manager")
            End If

            If Not String.IsNullOrEmpty(sEmpowerSupportRole) Then
                Dim RoletoCheck As New SponsorRoles
                'RoletoCheck.srXPATH = "//table[@id='selectedRoleTypes']/tbody/tr[2]/td[2]/label"
                RoletoCheck.srXPATH = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr[2]/td[2]/label/input"
                RoletoCheck.SrRole = CleanString(sEmpowerSupportRole)
                Call ClickSponsorRole(RoletoCheck, returnValues, actionHistoryRecordID, "Empowerment or Supportive Services Provider")
            End If

            If Not String.IsNullOrEmpty(sConstrMgrRole) Then
                Dim RoletoCheck As New SponsorRoles
                'RoletoCheck.srXPATH = "//table[@id='selectedRoleTypes']/tbody/tr[3]/td[2]/label"
                RoletoCheck.srXPATH = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr[3]/td[2]/label/input"
                RoletoCheck.SrRole = CleanString(sConstrMgrRole)
                Call ClickSponsorRole(RoletoCheck, returnValues, actionHistoryRecordID, "Construction or Rehab Manager")
            End If

            If Not String.IsNullOrEmpty(sOtherRole) Then
                Dim RoletoCheck As New SponsorRoles
                'RoletoCheck.srXPATH = "//table[@id='selectedRoleTypes']/tbody/tr[1]/td[3]"
                RoletoCheck.srXPATH = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr[1]/td[3]/label/input"
                RoletoCheck.SrRole = CleanString(sOtherRole)
                If ClickSponsorRole(RoletoCheck, returnValues, actionHistoryRecordID, "Other") = True Then
                    If CleanString(sOtherRole) = "X" Then
                        If Not String.IsNullOrEmpty(sOtherDescr) Then
                            Dim odescr As New AutomationObject
                            odescr.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='otherSponsorRoleText']"))
                            If Not odescr.aObject Is Nothing Then
                                odescr.aElement = DirectCast(odescr.aObject, IWebElement)
                                odescr.aElement.SendKeys(Keys.Control + "a")
                                odescr.aElement.SendKeys(Keys.Delete)
                                odescr.aElement.SendKeys(sOtherDescr)
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered Other Role Description: " & sOtherDescr.ToString, myLogPath, , actionHistoryRecordID)
                            Else
                                returnValues(0) = executionStatusFailed
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter Other Role Description.", myLogPath, , actionHistoryRecordID)
                                CaptureScreenshot(actionHistoryRecordID)
                            End If
                        End If

                    End If
                End If
            End If

            If Not String.IsNullOrEmpty(sSponsorExperFile) Then
                Dim FileToUpload As New BrowseFileParms
                FileToUpload.RemovePath = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"
                FileToUpload.AttachPath = "//input[@id='pageTemplateForm:expAttachment']"
                FileToUpload.FileToAttach = sSponsorExperFile
                Call AttachFile(FileToUpload, returnValues, actionHistoryRecordID, "Completed Sponsor Experience Form")
            End If
ClickSave:
            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            Dim oAuto As New AutomationObject

            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


            Dim waits As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))
ClickNext:
            Dim oNext As New AutomationObject

            oNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"))
            If Not oNext.aObject Is Nothing Then
                oNext.aElement = DirectCast(oNext.aObject, IWebElement)
                oNext.aElement.Click()
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the next button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas5_Specify_Primary_developer(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='sponsorQuestion']/tbody/tr/td[1]/label"
            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the yes button indicating sponsor is primary developer.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click yes button indicating sponsor is primary developer.", myLogPath, , actionHistoryRecordID)

            End If

            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If


            returnValues(1) = "(* Spon Primary Dev *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas6_Select_Dev_Roles(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sCoDeveloper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Co-Developer")
            Dim sConsultant As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Consultant")
            Dim sGenContractor As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "General_Contractor")
            Dim sBuilder As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Builder")
            Dim sMgmtComp As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Mgmt_Comp")
            Dim sArchitect As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Architect")
            Dim sEngineer As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Engineer")
            Dim sAttorney As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Attorney")
            Dim sOther As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Other")
            Dim sSelectionProcess As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Selection_Process")

            Dim sRoleOption As String = Nothing

            If CleanString(sCoDeveloper) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[0]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sCoDeveloper) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[0]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sCoDeveloper) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Co-Developer Specified Value Invalid: " & sCoDeveloper.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Co-Developer specified; expected Yes or No: " & sCoDeveloper.ToString, myLogPath, , actionHistoryRecordID)
                GoTo Consultant
            End If
            ' Click appropriate radial button for CoDeveloper
            If Not String.IsNullOrEmpty(sCoDeveloper) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the Co-Developer " & sCoDeveloper.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Co-Developer " & sCoDeveloper.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

Consultant:
            If CleanString(sConsultant) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[1]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sConsultant) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[1]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sConsultant) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Consultant Specified Value Invalid: " & sConsultant.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Consultant specified; expected Yes or No: " & sConsultant.ToString, myLogPath, , actionHistoryRecordID)
                GoTo GenContractor
            End If
            ' Click appropriate radial button for Consultant
            If Not String.IsNullOrEmpty(sConsultant) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the Consultant " & sConsultant.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Consultant " & sConsultant.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

GenContractor:

            If CleanString(sGenContractor) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[2]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sGenContractor) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[2]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sGenContractor) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " General Contractor Specified Value Invalid: " & sGenContractor.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for General Contractor specified; expected Yes or No: " & sGenContractor.ToString, myLogPath, , actionHistoryRecordID)
                GoTo Builder
            End If
            ' Click appropriate radial button for General Contractor
            If Not String.IsNullOrEmpty(sGenContractor) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the General Contractor " & sGenContractor.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the General Contractor " & sGenContractor.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

Builder:
            If CleanString(sBuilder) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[3]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sBuilder) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[3]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sBuilder) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Builder Specified Value Invalid: " & sBuilder.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Builder specified; expected Yes or No: " & sBuilder.ToString, myLogPath, , actionHistoryRecordID)
                GoTo MgmtCo
            End If
            ' Click appropriate radial button for Builder
            If Not String.IsNullOrEmpty(sBuilder) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the Builder " & sBuilder.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Builder " & sBuilder.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

MgmtCo:
            If CleanString(sMgmtComp) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[4]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sMgmtComp) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[4]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sMgmtComp) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Management Company Specified Value Invalid: " & sMgmtComp.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Management Company specified; expected Yes or No: " & sMgmtComp.ToString, myLogPath, , actionHistoryRecordID)
                GoTo Architect
            End If
            ' Click appropriate radial button for Management Company
            If Not String.IsNullOrEmpty(sMgmtComp) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the Management Company " & sMgmtComp.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Management Company " & sMgmtComp.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
Architect:
            If CleanString(sArchitect) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[5]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sArchitect) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[5]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sArchitect) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Architect Specified Value Invalid: " & sArchitect.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Architect specified; expected Yes or No: " & sArchitect.ToString, myLogPath, , actionHistoryRecordID)
                GoTo Engineer
            End If
            ' Click appropriate radial button for Architect
            If Not String.IsNullOrEmpty(sArchitect) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the Architect " & sArchitect.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Architect " & sArchitect.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

Engineer:
            If CleanString(sEngineer) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[6]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sEngineer) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[6]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sEngineer) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Engineer Specified Value Invalid: " & sEngineer.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Engineer specified; expected Yes or No: " & sEngineer.ToString, myLogPath, , actionHistoryRecordID)
                GoTo Attorney
            End If
            ' Click appropriate radial button for Engineer
            If Not String.IsNullOrEmpty(sEngineer) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the Engineer " & sEngineer.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Engineer " & sEngineer.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
Attorney:
            If CleanString(sAttorney) = "YES" Then
                sRoleOption = "//table[@id='selectedRadio[7]']/tbody/tr/td[1]/label"
            ElseIf CleanString(sAttorney) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[7]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sAttorney) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Attorney Specified Value Invalid: " & sAttorney.ToString & " Expected YES or NO"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Attorney specified; expected Yes or No: " & sAttorney.ToString, myLogPath, , actionHistoryRecordID)
                GoTo Other
            End If
            ' Click appropriate radial button for Attorney
            If Not String.IsNullOrEmpty(sAttorney) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the Attorney " & sAttorney.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Attorney " & sAttorney.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

Other:
            If CleanString(sOther) = "NO" Then
                sRoleOption = "//table[@id='selectedRadio[8]']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sOther) Then
                ' If No is not specified and Other is not empty set radial for Other to Yes
                sRoleOption = "//table[@id='selectedRadio[8]']/tbody/tr/td[1]/label"
            End If
            ' Click appropriate radial button for Other
            If Not String.IsNullOrEmpty(sOther) Then
                Dim roles As New AutomationObject
                roles.aObject = WaitForElement(driver, WaitForTime, By.XPath(sRoleOption))
                If Not roles.aObject Is Nothing Then
                    roles.aElement = DirectCast(roles.aObject, IWebElement)
                    roles.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the specified Other button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the Attorney button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If
            If CleanString(sOther) <> "NO" Then
                If Not String.IsNullOrEmpty(sOther) Then
                    Dim otherdescr As New AutomationObject
                    otherdescr.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='otherRoleText[8]']"))
                    If Not otherdescr.aObject Is Nothing Then
                        otherdescr.aElement = DirectCast(otherdescr.aObject, IWebElement)
                        otherdescr.aElement.SendKeys(Keys.Control + "a")
                        otherdescr.aElement.SendKeys(Keys.Delete)
                        otherdescr.aElement.SendKeys(sOther)
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Entered Other Description: " & sOther.ToString, myLogPath, , actionHistoryRecordID)
                        Dim wait1 As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
                        wait1.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))
                    Else
                        returnValues(0) = executionStatusFailed
                        mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter Other Description: " & sOther.ToString, myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
            End If
            ' Enter Selection Process

            If Not String.IsNullOrEmpty(sSelectionProcess) Then
                System.Windows.Forms.Clipboard.Clear()
                Dim sRetVal As String = GetWordText(sSelectionProcess)
                If sRetVal.ToUpper = "FILE NOT FOUND" Then
                    Dim sXpath As String = "//textarea[@id='teamSelectionProcess']"
                    Dim selproc As New AutomationObject
                    selproc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not selproc.aObject Is Nothing Then
                        selproc.aElement = DirectCast(selproc.aObject, IWebElement)
                        selproc.aElement.SendKeys(Keys.Control + "a")
                        selproc.aElement.SendKeys(Keys.Delete)
                        selproc.aElement.SendKeys(sSelectionProcess)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Selection Process was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                    End If
                ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                    Dim sXpath As String = "//textarea[@id='teamSelectionProcess']"
                    Dim selproc As New AutomationObject
                    selproc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                    If Not selproc.aObject Is Nothing Then
                        selproc.aElement = DirectCast(selproc.aObject, IWebElement)
                        selproc.aElement.SendKeys(Keys.Control + "a")
                        selproc.aElement.SendKeys(Keys.Delete)

                        Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                        selproc.aElement.SendKeys(Keys.Control + "v")

                        mosaicDll.Logger(senderMCPAction, "Actual Result|Selection Process was entered from Word document.", myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No Selection Process was entered: Processing Continued. ", myLogPath, , actionHistoryRecordID)
            End If

ClickSave:

            Dim oAuto As New AutomationObject

            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))
ClickNext:
            Dim oNext As New AutomationObject

            oNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext.aObject Is Nothing Then
                oNext.aElement = DirectCast(oNext.aObject, IWebElement)
                oNext.aElement.Click()
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the next button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function AddDevMbr(ByVal TeamMbr As DevTeamParams, ByRef returnValues() As Object, ByVal actionHistoryRecordID As Integer, Optional ByVal sRole As String = "") As Boolean

        Dim Did_it_work As Boolean = True

        If Not String.IsNullOrEmpty(TeamMbr.CompanyName) Then
            Dim teams As New AutomationObject
            teams.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='organizationName']"))
            If Not teams.aObject Is Nothing Then
                teams.aElement = DirectCast(teams.aObject, IWebElement)
                teams.aElement.SendKeys(Keys.Control + "a")
                teams.aElement.SendKeys(Keys.Delete)
                teams.aElement.SendKeys(TeamMbr.CompanyName)
                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & TeamMbr.CompanyName & " as " & sRole & "Company Name.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter " & TeamMbr.CompanyName & " as " & sRole & "Company Name."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter the " & TeamMbr.CompanyName & " as " & sRole & "Company Name.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False
            End If

        End If

        If Not String.IsNullOrEmpty(TeamMbr.TelephoneNbr) Then
            Dim teams As New AutomationObject
            teams.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='telephoneNumber']"))
            If Not teams.aObject Is Nothing Then
                teams.aElement = DirectCast(teams.aObject, IWebElement)
                teams.aElement.SendKeys(Keys.Control + "a")
                teams.aElement.SendKeys(Keys.Delete)
                teams.aElement.SendKeys(TeamMbr.TelephoneNbr)
                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & TeamMbr.TelephoneNbr & " as " & sRole & "Telephone Number.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter " & TeamMbr.TelephoneNbr & " as " & sRole & "Telephone Number."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter " & TeamMbr.TelephoneNbr & " as " & sRole & "Telephone Number.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False
            End If

        End If

        If Not String.IsNullOrEmpty(TeamMbr.PersonName) Then
            Dim teams As New AutomationObject
            teams.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='personName']"))
            If Not teams.aObject Is Nothing Then
                teams.aElement = DirectCast(teams.aObject, IWebElement)
                teams.aElement.SendKeys(Keys.Control + "a")
                teams.aElement.SendKeys(Keys.Delete)
                teams.aElement.SendKeys(TeamMbr.PersonName)
                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & TeamMbr.PersonName & " as " & sRole & "Person Name.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not enter " & TeamMbr.PersonName & " as " & sRole & "Person Name."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter " & TeamMbr.PersonName & " as " & sRole & "Person Name.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False
            End If

        End If
        Dim ContractXPath As String = Nothing
        If CleanString(TeamMbr.ContractExec) = "YES" Then
            ContractXPath = "//table[@id='isContractExecuted']/tbody/tr/td[1]/label"
        ElseIf CleanString(TeamMbr.ContractExec) = "NO" Then
            ContractXPath = "//table[@id='isContractExecuted']/tbody/tr/td[2]/label"
        ElseIf Not String.IsNullOrEmpty(TeamMbr.ContractExec) Then
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & "Invalid Value Specified for Contract Executed for " & sRole & "Expected Yes or No."
            mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid Value Specified for Contract Executed for " & sRole & "Expected Yes or No.", myLogPath, , actionHistoryRecordID)
            Did_it_work = False
        End If

        If Not String.IsNullOrEmpty(TeamMbr.ContractExec) Then
            Dim teams As New AutomationObject
            teams.aObject = WaitForElement(driver, WaitForTime, By.XPath(ContractXPath))
            If Not teams.aObject Is Nothing Then
                teams.aElement = DirectCast(teams.aObject, IWebElement)
                teams.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked " & TeamMbr.ContractExec & " Radio button", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not click " & TeamMbr.ContractExec & " Radio button."
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click " & TeamMbr.ContractExec & " Radio button.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                Did_it_work = False
            End If

        End If


        If Not String.IsNullOrEmpty(TeamMbr.DescrAHPExper) Then
            System.Windows.Forms.Clipboard.Clear()
            Dim sRetVal As String = GetWordText(TeamMbr.DescrAHPExper)
            If sRetVal.ToUpper = "FILE NOT FOUND" Then
                Dim sXpath As String = "//textarea[@id='experience']"
                Dim mktdesc As New AutomationObject
                mktdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not mktdesc.aObject Is Nothing Then
                    mktdesc.aElement = DirectCast(mktdesc.aObject, IWebElement)
                    mktdesc.aElement.SendKeys(Keys.Control + "a")
                    mktdesc.aElement.SendKeys(Keys.Delete)
                    mktdesc.aElement.SendKeys(TeamMbr.DescrAHPExper)
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Affordable Housing Experience for " & sRole & " was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                End If
            ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                Dim sXpath As String = "//textarea[@id='experience']"
                Dim mktdesc As New AutomationObject
                mktdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                If Not mktdesc.aObject Is Nothing Then
                    mktdesc.aElement = DirectCast(mktdesc.aObject, IWebElement)
                    mktdesc.aElement.SendKeys(Keys.Control + "a")
                    mktdesc.aElement.SendKeys(Keys.Delete)

                    Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                    mktdesc.aElement.SendKeys(Keys.Control + "v")

                    mosaicDll.Logger(senderMCPAction, "Actual Result|Affordable Housing Experience for " & sRole & " was entered from Word document.", myLogPath, , actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " " & sRetVal
                mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
            End If
        Else
            mosaicDll.Logger(senderMCPAction, "Actual Result|No Market Study Demand description was entered: Processing Continued. ", myLogPath, , actionHistoryRecordID)
        End If

        Dim updatembrs As New AutomationObject
        updatembrs.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/div/div/div[2]/table[1]/tbody/tr/td[2]/input"))
        If Not updatembrs.aObject Is Nothing Then
            updatembrs.aElement = DirectCast(updatembrs.aObject, IWebElement)
            updatembrs.aElement.Click()
            mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Update Team Member Radio button", myLogPath, , actionHistoryRecordID)
        Else
            returnValues(0) = executionStatusFailed
            returnValues(1) = returnValues(1) & "Could not click Update Team Member Radio button."
            mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click Update Team Member Radio button.", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)
            Did_it_work = False
        End If

        AddDevMbr = Did_it_work

    End Function
    Public Function Feas7_Enter_Team_Mbrs(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            Dim sCoDeveloper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Co-Developer")
            Dim sCoDevCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "CoDev_Company_Name")
            Dim sCoDevTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "CoDev_Tele_Nbr")
            Dim sCoDevPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "CoDev_PersonName")
            Dim sCoDevContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "CoDev_Contract")
            Dim sCoDevExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "CoDev_Exper")

            Dim sConsultant As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Consultant")
            Dim sConsCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Cons_Company_Name")
            Dim sConsTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Cons_Tele_Nbr")
            Dim sConsPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Cons_PersonName")
            Dim sConsContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Cons_Contract")
            Dim sConsExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Cons_Exper")

            Dim sGenContractor As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "General_Contractor")
            Dim sGenCCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "GenC_Company_Name")
            Dim sGenCTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "GenC_Tele_Nbr")
            Dim sGenCPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "GenC_PersonName")
            Dim sGenCContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "GenC_Contract")
            Dim sGenCExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "GenC_Exper")

            Dim sBuilder As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Builder")
            Dim sBldCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Bld_Company_Name")
            Dim sBldTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Bld_Tele_Nbr")
            Dim sBldPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Bld_PersonName")
            Dim sBldContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Bld_Contract")
            Dim sBldExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Bld_Exper")

            Dim sMgmtComp As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Mgmt_Comp")
            Dim sMgmCCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "MgmC_Company_Name")
            Dim sMgmCTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "MgmC_Tele_Nbr")
            Dim sMgmCPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "MgmC_PersonName")
            Dim sMgmCContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "MgmC_Contract")
            Dim sMgmCExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "MgmC_Exper")

            Dim sArchitect As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Architect")
            Dim sArchCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Arch_Company_Name")
            Dim sArchTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Arch_Tele_Nbr")
            Dim sArchPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Arch_PersonName")
            Dim sArchContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Arch_Contract")
            Dim sArchExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Arch_Exper")

            Dim sEngineer As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Engineer")
            Dim sEngCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Eng_Company_Name")
            Dim sEngTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Eng_Tele_Nbr")
            Dim sEngPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Eng_PersonName")
            Dim sEngContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Eng_Contract")
            Dim sEngExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Eng_Exper")

            Dim sAttorney As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Attorney")
            Dim sAttCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Att_Company_Name")
            Dim sAttTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Att_Tele_Nbr")
            Dim sAttPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Att_PersonName")
            Dim sAttContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Att_Contract")
            Dim sAttExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Att_Exper")

            Dim sOther As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Other")
            Dim sOthCompanyName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Oth_Company_Name")
            Dim sOthTelephone As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Oth_Tele_Nbr")
            Dim sOthPersonName As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Oth_PersonName")
            Dim sOthContract As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Oth_Contract")
            Dim sOthExper As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Oth_Exper")

            Dim sNbrTeamMbrs As String = mosaicDll.dt(excelPath, iteration, "devrole_feas_team_roles", "Nbr_of_Team_Mbrs")

            Dim sBegeditXPATH As String = "/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr"
            Dim EndeditXPATH As String = "/div/a"
            Dim MidoneroleXPAth As String = "/td[1]"
            Dim FirstMidmultroleXPATH As String = "["
            Dim EndMidMultRoleXPATH As String = "]/td[1]"


            Dim RoleCount As Integer = 1
            Dim sxpath As String = Nothing
            'Check CoDeveloper

            If CleanString(sCoDeveloper) = "YES" Then
                If sNbrTeamMbrs > 1 Then
                    sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                Else
                    sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                End If
                Dim button As New AutomationObject
                button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                If Not button.aObject Is Nothing Then
                    button.aElement = DirectCast(button.aObject, IWebElement)
                    button.aElement.Click()
                    RoleCount = RoleCount + 1
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo ClickNext
                End If

                Dim Teamref As New DevTeamParams
                Teamref.CompanyName = sCoDevCompanyName
                Teamref.TelephoneNbr = sCoDevTelephone
                Teamref.PersonName = sCoDevPersonName
                Teamref.ContractExec = sCoDevContract
                Teamref.DescrAHPExper = sCoDevExper

                Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Co-Developer")
            End If

            'Check Consultant
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sConsultant) = "YES" Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sConsCompanyName
                    Teamref.TelephoneNbr = sConsTelephone
                    Teamref.PersonName = sConsPersonName
                    Teamref.ContractExec = sConsContract
                    Teamref.DescrAHPExper = sConsExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Consultant")
                End If
            Else
                GoTo ClickSave
            End If

            'Check General Contractor
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sGenContractor) = "YES" Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sGenCCompanyName
                    Teamref.TelephoneNbr = sGenCTelephone
                    Teamref.PersonName = sGenCPersonName
                    Teamref.ContractExec = sGenCContract
                    Teamref.DescrAHPExper = sGenCExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "General Contractor")
                End If
            Else
                GoTo ClickSave
            End If

            'Check Builder
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sBuilder) = "YES" Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sBldCompanyName
                    Teamref.TelephoneNbr = sBldTelephone
                    Teamref.PersonName = sBldPersonName
                    Teamref.ContractExec = sBldContract
                    Teamref.DescrAHPExper = sBldExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Builder")
                End If
            Else
                GoTo ClickSave
            End If

            'Check Management Company
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sMgmtComp) = "YES" Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sMgmCCompanyName
                    Teamref.TelephoneNbr = sMgmCTelephone
                    Teamref.PersonName = sMgmCPersonName
                    Teamref.ContractExec = sMgmCContract
                    Teamref.DescrAHPExper = sMgmCExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Management Company")
                End If
            Else
                GoTo ClickSave
            End If

            'Check Architect
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sArchitect) = "YES" Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sArchCompanyName
                    Teamref.TelephoneNbr = sArchTelephone
                    Teamref.PersonName = sArchPersonName
                    Teamref.ContractExec = sArchContract
                    Teamref.DescrAHPExper = sArchExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Architect")
                End If
            Else
                GoTo ClickSave
            End If

            'Check Engineer
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sEngineer) = "YES" Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sEngCompanyName
                    Teamref.TelephoneNbr = sEngTelephone
                    Teamref.PersonName = sEngPersonName
                    Teamref.ContractExec = sEngContract
                    Teamref.DescrAHPExper = sEngExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Engineer")
                End If
            Else
                GoTo ClickSave
            End If

            'Check Attorney
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sAttorney) = "YES" Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sAttCompanyName
                    Teamref.TelephoneNbr = sAttTelephone
                    Teamref.PersonName = sAttPersonName
                    Teamref.ContractExec = sAttContract
                    Teamref.DescrAHPExper = sAttExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Attorney")
                End If
            Else
                GoTo ClickSave
            End If

            'Check Other
            If RoleCount <= sNbrTeamMbrs Then
                If CleanString(sOther) <> "NO" And Not String.IsNullOrEmpty(sOther) Then
                    If sNbrTeamMbrs > 1 Then
                        sxpath = sBegeditXPATH & FirstMidmultroleXPATH & RoleCount.ToString & EndMidMultRoleXPATH & EndeditXPATH
                    Else
                        sxpath = sBegeditXPATH & MidoneroleXPAth & EndeditXPATH
                    End If
                    Dim button As New AutomationObject
                    button.aObject = WaitForElement(driver, WaitForTime, By.XPath(sxpath))


                    'button.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr/td/div/table/tbody/tr[1]/td[1]/div/a"))

                    If Not button.aObject Is Nothing Then
                        button.aElement = DirectCast(button.aObject, IWebElement)
                        button.aElement.Click()
                        RoleCount = RoleCount + 1
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = CStr(returnValues(1)) & " Could not click the edit button. "
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the edit button. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo ClickNext
                    End If

                    Dim Teamref As New DevTeamParams
                    Teamref.CompanyName = sOthCompanyName
                    Teamref.TelephoneNbr = sOthTelephone
                    Teamref.PersonName = sOthPersonName
                    Teamref.ContractExec = sOthContract
                    Teamref.DescrAHPExper = sOthExper

                    Call AddDevMbr(Teamref, returnValues, actionHistoryRecordID, "Other")
                End If
            Else
                GoTo ClickSave
            End If
ClickSave:
            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            Dim oAuto As New AutomationObject

            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If


            Dim waits As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))
ClickNext:
            Dim oNext As New AutomationObject

            oNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext.aObject Is Nothing Then
                oNext.aElement = DirectCast(oNext.aObject, IWebElement)
                oNext.aElement.Click()
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the next button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas8_Complete_Disclosure(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim nextPath As String = "//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = "//table[@id='complianceIssuesQuestion']/tbody/tr/td[2]/label"
            'click the no option button

            Dim a As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning barred from participation.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning barred from participation.", myLogPath, , actionHistoryRecordID)

            End If

            optionPath = "//table[@id='fairHousingIssuesQuestion']/tbody/tr/td[2]/label"
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning involvement with housing issues.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning involvement with housing issues.", myLogPath, , actionHistoryRecordID)

            End If


            optionPath = "//table[@id='conflictOfInterestQuestion']/tbody/tr/td[2]/label"
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning relationships that could cause a conflict.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning relationships that could cause a conflict.", myLogPath, , actionHistoryRecordID)

            End If

            optionPath = "//table[@id='sellerConflictOfInterestQuestion']/tbody/tr/td[2]/label"
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning seller relationships that could cause a conflict.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning relationships that could cause a conflict.", myLogPath, , actionHistoryRecordID)

            End If
            'click save button
            Dim savebutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If



            returnValues(1) = "(* No Disclosure  *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Feas9_Complete_Market_Study(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try
            Dim sIsMarketStudyCompl As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_Indep_Study_Compl?")
            Dim sLocalMktDescr As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_Descr_Loc_Mrkt_Cond")
            Dim sFileDocSuppMktDemand As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_File_Supp_Mkt_Demand")

            Dim sMktStudyOrg As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_Org")
            Dim sMktStudyComplDate As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_Date_Compl")
            Dim sAbsorbRate As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "Mkt_Absorb_Rate_Mnths")
            Dim sCaptureRatePercent As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_Capture_Rte%")
            Dim sMktStudyFile As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_Study_File")
            Dim sHistoricalDescr As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "MktStud_Descr_Historical_Occup")

            Dim sMktStudyOption As String = Nothing

            ' Click if market study done

            If CleanString(sIsMarketStudyCompl) = "YES" Then
                sMktStudyOption = "//table[@id='completedQuestion']/tbody/tr/td[1]/label"
            ElseIf CleanString(sIsMarketStudyCompl) = "NO" Then
                sMktStudyOption = "//table[@id='completedQuestion']/tbody/tr/td[2]/label"
            ElseIf Not String.IsNullOrEmpty(sIsMarketStudyCompl) Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Invalid value for whether Market Study is done specified; expected Yes or No: " & sIsMarketStudyCompl.ToString
                mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value for Ownership structure specified; expected Yes or No: " & sIsMarketStudyCompl.ToString, myLogPath, , actionHistoryRecordID)
                GoTo ClickNext
            End If
            ' Click appropriate radial button for ownership structure
            If Not String.IsNullOrEmpty(sIsMarketStudyCompl) Then
                Dim mkts As New AutomationObject
                mkts.aObject = WaitForElement(driver, WaitForTime, By.XPath(sMktStudyOption))
                If Not mkts.aObject Is Nothing Then
                    mkts.aElement = DirectCast(mkts.aObject, IWebElement)
                    mkts.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the " & sIsMarketStudyCompl.ToString & " button.", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailed
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the " & sIsMarketStudyCompl.ToString & " button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            End If

            If CleanString(sIsMarketStudyCompl) = "NO" Then
                If Not String.IsNullOrEmpty(sFileDocSuppMktDemand) Then
                    'try to remove existing file

                    Dim sRemovePath As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/div/div[1]/table/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"

                    Dim oRemoveDoc As Object = WaitForElement(driver, WaitForTime, By.XPath(sRemovePath))

                    If Not oRemoveDoc Is Nothing Then
                        Dim oRemoveElement As IWebElement = DirectCast(oRemoveDoc, IWebElement)
                        oRemoveElement.Click()
                        'Dim oTrysave As New AutomationObject

                        'oTrysave.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
                        'If Not oTrysave.aObject Is Nothing Then
                        '    oTrysave.aElement = DirectCast(oTrysave.aObject, IWebElement)
                        '    oTrysave.aElement.Click()
                        'End If

                        mosaicDll.Logger(senderMCPAction, "Actual Result|Removed the previous Market Study Demand document.", myLogPath, , actionHistoryRecordID)
                    End If

                End If

                If Not String.IsNullOrEmpty(sLocalMktDescr) Then
                    System.Windows.Forms.Clipboard.Clear()
                    Dim sRetVal As String = GetWordText(sLocalMktDescr)
                    If sRetVal.ToUpper = "FILE NOT FOUND" Then
                        Dim sXpath As String = "//textarea[@id='marketNeedAndDemand']"
                        Dim mktdesc As New AutomationObject
                        mktdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                        If Not mktdesc.aObject Is Nothing Then
                            mktdesc.aElement = DirectCast(mktdesc.aObject, IWebElement)
                            mktdesc.aElement.SendKeys(Keys.Control + "a")
                            mktdesc.aElement.SendKeys(Keys.Delete)
                            mktdesc.aElement.SendKeys(sLocalMktDescr)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Market Study Demand description was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                        End If
                    ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                        Dim sXpath As String = "//textarea[@id='marketNeedAndDemand']"
                        Dim mktdesc As New AutomationObject
                        mktdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                        If Not mktdesc.aObject Is Nothing Then
                            mktdesc.aElement = DirectCast(mktdesc.aObject, IWebElement)
                            mktdesc.aElement.SendKeys(Keys.Control + "a")
                            mktdesc.aElement.SendKeys(Keys.Delete)

                            Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                            mktdesc.aElement.SendKeys(Keys.Control + "v")

                            mosaicDll.Logger(senderMCPAction, "Actual Result|Market Study Demand description was entered from Word document.", myLogPath, , actionHistoryRecordID)
                        End If
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & sRetVal
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result|No Market Study Demand description was entered: Processing Continued. ", myLogPath, , actionHistoryRecordID)
                End If

                Dim bSetFile As Boolean = False

                'if there is a file location set select it
                If Not String.IsNullOrEmpty(sFileDocSuppMktDemand) Then
                    If Not System.IO.File.Exists(sFileDocSuppMktDemand) Then
                        'message
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & "The file named: " & sFileDocSuppMktDemand & " was not found."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sFileDocSuppMktDemand & " was not found.", myLogPath, , actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:marketStudyAttachment']"))
                    If Not oAttachFile Is Nothing Then
                        Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                        oAttachFileElement.Click()
                        oAttachFileElement.SendKeys(sFileDocSuppMktDemand)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Attached Market Demand Support document.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not attach file named: " & sFileDocSuppMktDemand
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sFileDocSuppMktDemand, myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
            ElseIf CleanString(sIsMarketStudyCompl) = "YES" Then

                If Not String.IsNullOrEmpty(sMktStudyOrg) Then
                    Dim this_Object As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='organizationName']"))
                    If Not this_Object Is Nothing Then
                        Dim this_Element As IWebElement = DirectCast(this_Object, IWebElement)
                        this_Element.SendKeys(Keys.Control + "a")
                        this_Element.SendKeys(Keys.Delete)
                        this_Element.SendKeys(sMktStudyOrg)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Market Study Organization then Entered: " & sMktStudyOrg.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter Market Study Organization."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sMktStudyOrg.ToString & " in Market Study Organization.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
                '********* routine for dates *********************************************************************************
                'Implement Calendar for Market Study Date
                If Not sMktStudyComplDate = String.Empty Then
                    'New up a calendar object
                    Dim myCalendar As New CalendarParams

                    'change text date to real date
                    Dim properDate As DateTime = DateTime.Parse(sMktStudyComplDate)

                    'set parameters 
                    myCalendar.monthdec = "//td[@id='pageTemplateForm:dateCompletedHeader']/table/tbody/tr/td[2]/div"
                    myCalendar.monthinc = "//td[@id='pageTemplateForm:dateCompletedHeader']/table/tbody/tr/td[4]/div"
                    myCalendar.yeardec = "//td[@id='pageTemplateForm:dateCompletedHeader']/table/tbody/tr/td[1]/div"
                    myCalendar.yearinc = "//td[@id='pageTemplateForm:dateCompletedHeader']/table/tbody/tr/td[5]/div"
                    myCalendar.clean = "//td[@id='pageTemplateForm:dateCompletedFooter']/table/tbody/tr/td[2]/div"
                    myCalendar.ctoday = "//td[@id='pageTemplateForm:dateCompletedFooter']/table/tbody/tr/td[5]/div"
                    myCalendar.CalButtonXPath = "//img[@id='pageTemplateForm:dateCompletedPopupButton']"
                    myCalendar.dayZeroXPath = "//td[@id='pageTemplateForm:dateCompletedDayCell0']"
                    myCalendar.dayXPathPart1 = "//td[@id='pageTemplateForm:dateCompletedDayCell"
                    myCalendar.dayXPathPart2 = "']"
                    myCalendar.CalHeader = "//td[@id='pageTemplateForm:dateCompletedHeader']/table/tbody/tr/td[3]/div"
                    myCalendar.CurrentDay = Now.Day
                    myCalendar.CurrentMonth = Now.Month
                    myCalendar.CurrentYear = Now.Year
                    myCalendar.TargetDay = properDate.Day
                    myCalendar.TargetMonth = properDate.Month
                    myCalendar.TargetYear = properDate.Year
                    myCalendar.CurrentDate = Today
                    myCalendar.TargetDate = properDate

                    'call calendar method WELLA

                    Call DoCalendar(sMktStudyComplDate, myCalendar, returnValues, actionHistoryRecordID)

                End If

                '************************ End of Date Routine ************************************
                If Not String.IsNullOrEmpty(sAbsorbRate) Then
                    Dim this_Object As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='absorptionRate']"))
                    If Not this_Object Is Nothing Then
                        Dim this_Element As IWebElement = DirectCast(this_Object, IWebElement)
                        this_Element.SendKeys(Keys.Control + "a")
                        this_Element.SendKeys(Keys.Delete)
                        this_Element.SendKeys(sAbsorbRate)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Aborption Rate then Entered: " & sAbsorbRate.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter Aborption Rate."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sAbsorbRate.ToString & " in Aborption Rate.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If

                If Not String.IsNullOrEmpty(sCaptureRatePercent) Then
                    Dim this_Object As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='captureRate']"))
                    If Not this_Object Is Nothing Then
                        Dim this_Element As IWebElement = DirectCast(this_Object, IWebElement)
                        this_Element.SendKeys(Keys.Control + "a")
                        this_Element.SendKeys(Keys.Delete)
                        this_Element.SendKeys(sCaptureRatePercent)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Capture Rate then Entered: " & sCaptureRatePercent.ToString, myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & "Could not enter Capture Rate."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not enter " & sCaptureRatePercent.ToString & " in Capture Rate.", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If
                If Not String.IsNullOrEmpty(sMktStudyFile) Then
                    'try to remove existing file

                    Dim sRemovePath As String = "/html/body/div[4]/form/div[2]/div[2]/div/table/tbody/tr[3]/td/div/div[1]/table[3]/tbody/tr/td[2]/div/div/div/div[2]/table/tbody/tr/td[2]/input"

                    Dim oRemoveDoc As Object = WaitForElement(driver, WaitForTime, By.XPath(sRemovePath))

                    If Not oRemoveDoc Is Nothing Then
                        Dim oRemoveElement As IWebElement = DirectCast(oRemoveDoc, IWebElement)
                        oRemoveElement.Click()
                        'Dim oTrysave As New AutomationObject

                        'oTrysave.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
                        'If Not oTrysave.aObject Is Nothing Then
                        '    oTrysave.aElement = DirectCast(oTrysave.aObject, IWebElement)
                        '    oTrysave.aElement.Click()
                        'End If

                        mosaicDll.Logger(senderMCPAction, "Actual Result|Removed the previous Market Study document.", myLogPath, , actionHistoryRecordID)
                    End If

                End If

                Dim bSetFile As Boolean = False

                'if there is a file location set select it
                If Not String.IsNullOrEmpty(sMktStudyFile) Then
                    If Not System.IO.File.Exists(sMktStudyFile) Then
                        'message
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & "The file named: " & sMktStudyFile & " was not found."
                        mosaicDll.Logger(senderMCPAction, "Actual Result | The file named: " & sMktStudyFile & " was not found.", myLogPath, , actionHistoryRecordID)
                        GoTo ClickSave
                    End If
                    Dim oAttachFile As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:marketStudyThirdPartyAttachment']"))
                    If Not oAttachFile Is Nothing Then
                        Dim oAttachFileElement As IWebElement = DirectCast(oAttachFile, IWebElement)
                        oAttachFileElement.Click()
                        oAttachFileElement.SendKeys(sMktStudyFile)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Attached Market Study document.", myLogPath, , actionHistoryRecordID)
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not attach file named: " & sMktStudyFile
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Could not attach file named: " & sMktStudyFile, myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                    End If
                End If

                If Not String.IsNullOrEmpty(sHistoricalDescr) Then
                    System.Windows.Forms.Clipboard.Clear()
                    Dim sRetVal As String = GetWordText(sHistoricalDescr)
                    If sRetVal.ToUpper = "FILE NOT FOUND" Then
                        Dim sXpath As String = "//textarea[@id='majorFindings']"
                        Dim mktdesc As New AutomationObject
                        mktdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                        If Not mktdesc.aObject Is Nothing Then
                            mktdesc.aElement = DirectCast(mktdesc.aObject, IWebElement)
                            mktdesc.aElement.SendKeys(Keys.Control + "a")
                            mktdesc.aElement.SendKeys(Keys.Delete)
                            mktdesc.aElement.SendKeys(sHistoricalDescr)
                            mosaicDll.Logger(senderMCPAction, "Actual Result|Historical Occupancy description was entered from RStar template.", myLogPath, , actionHistoryRecordID)
                        End If
                    ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                        Dim sXpath As String = "//textarea[@id='majorFindings']"
                        Dim mktdesc As New AutomationObject
                        mktdesc.aObject = WaitForElement(driver, WaitForTime, By.XPath(sXpath))
                        If Not mktdesc.aObject Is Nothing Then
                            mktdesc.aElement = DirectCast(mktdesc.aObject, IWebElement)
                            mktdesc.aElement.SendKeys(Keys.Control + "a")
                            mktdesc.aElement.SendKeys(Keys.Delete)

                            Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                            mktdesc.aElement.SendKeys(Keys.Control + "v")

                            mosaicDll.Logger(senderMCPAction, "Actual Result|Historical Occupancy description description was entered from Word document.", myLogPath, , actionHistoryRecordID)
                        End If
                    Else
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " " & sRetVal
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    mosaicDll.Logger(senderMCPAction, "Actual Result|No Historical Occupancy description description was entered: Processing Continued. ", myLogPath, , actionHistoryRecordID)
                End If


            End If



ClickSave:
            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))
            Dim oAuto As New AutomationObject

            oAuto.aObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            If Not oAuto.aObject Is Nothing Then
                oAuto.aElement = DirectCast(oAuto.aObject, IWebElement)
                oAuto.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the save button. ", myLogPath, , actionHistoryRecordID)
                Dim sErrorMsg As String = mosaicDll.dt(excelPath, iteration, "appfeas_appl_feas_main_data", "Error_Message")
                If Not String.IsNullOrEmpty(sErrorMsg) Then
                    mosaicDll.Logger(senderMCPAction, "Actual Result |Check Error Message on Window. ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the save button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the save button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If



ClickNext:
            Dim oNext As New AutomationObject

            oNext.aObject = WaitForElement(driver, WaitForTime, By.XPath("//form[@id='pageTemplateForm']/div[2]/table/tbody/tr/td[2]/a"))
            If Not oNext.aObject Is Nothing Then
                oNext.aElement = DirectCast(oNext.aObject, IWebElement)
                oNext.aElement.Click()
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = CStr(returnValues(1)) & " Could not click the next button. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the next button. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function ScD1_Clk_Enter_Don_Disc_Fields_Save_next(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            'Donated property variables'
            Dim sScoringDonatedProp As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Donated_Prop_PerFHLBC?")
            Dim sScoringDonatedPropTotUnit As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Donated_TotalUnits")
            Dim sScoringdonatedPropTotSqtUnit As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Donated_TotalSqFt")

            'Discounted Property Variables '

            Dim sScoringDiscountedProp As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Disc_Prop_PerFHLBC?")
            Dim sScoringFairMarketValue As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Disc_AllFairMarket_NotDonated")
            Dim sScoringTotAmtConveyance As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Disc_TotalConveyance")

            'Donated /Discounted Properties Variables'
            Dim sScoringTotSqtFtland As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "DonDisc_TotalSqFtLand")
            Dim sScoringTotPropAcq As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "DonDisc_TotalNbrProp")
            Dim sDonDisc_All_identified As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "DonDisc_All_identified?")
            Dim sDonDisc_nbrNotKnown As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "DonDisc_nbrNotKnown")
            Dim sDonDiscExplainNotKnown As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "DonDiscExplainNotKnown")

            Dim SDonDisExpectedErrorMessage As String = mosaicDll.dt(excelPath, iteration, "applsco_scoring_main_data", "Error_Message")

            Dim oObject As New Object
            Dim sField_Element As IWebElement = Nothing
            Dim bDonated_No As Boolean = False



            'Clear the fields 

            Dim oclearunits_Element As IWebElement = Nothing
            Dim oclearland_Element As IWebElement = Nothing

            If sScoringDonatedProp.ToUpper = "YES" Then
                'user has clicked yes set the value fields
                Dim oYes As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/table/tbody/tr/td[1]/table/tbody/tr/td[3]/table/tbody/tr/td[1]/label/input"))
                If Not oYes Is Nothing Then
                    Dim oYes_Element As IWebElement = DirectCast(oYes, IWebElement)
                    oYes.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | System Clicked on Yes radio button for Donated Properties. ", myLogPath, , actionHistoryRecordID)
                    'Clear Enable Fields to Prepare for Entry if prior values

                    Dim oObjectUnit As New Object
                    Dim oObjectLand As New Object
                    oObjectUnit = WaitForElement(driver, WaitForTime, By.Id("totalNumOfDonatedUnits"))
                    oObjectLand = WaitForElement(driver, WaitForTime, By.Id("totalSquareFeetOfDonatedLand"))
                    If Not oObjectUnit Is Nothing Then
                        oclearunits_Element = DirectCast(oObjectUnit, IWebElement)
                    End If
                    If Not oObjectLand Is Nothing Then
                        oclearland_Element = DirectCast(oObjectLand, IWebElement)
                    End If
                    If oclearunits_Element Is Nothing Or oclearland_Element Is Nothing Then
                        returnValues(0) = executionStatusFailed
                        returnValues(1) = returnValues(1) & " Could not Access Donated Units and/or Land"
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Donated Units and/or Donated Property Fields Not Accessible. ", myLogPath, , actionHistoryRecordID)
                        CaptureScreenshot(actionHistoryRecordID)
                        GoTo NextDiscounted

                    End If
                    If oclearunits_Element.Enabled Then
                        oclearunits_Element.SendKeys(Keys.Control + "a")
                        oclearunits_Element.SendKeys(Keys.Delete)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Number of Donated Units. ", myLogPath, , actionHistoryRecordID)
                        oclearland_Element.Click()

                    ElseIf oclearland_Element.Enabled Then
                        oclearland_Element.SendKeys(Keys.Control + "a")
                        oclearland_Element.SendKeys(Keys.Delete)
                        mosaicDll.Logger(senderMCPAction, "Actual Result | Cleared Donated Square Feet. ", myLogPath, , actionHistoryRecordID)
                        oclearunits_Element.Click()

                    End If


                    ' Enter the total number of Donated units 
                    If Not sScoringDonatedPropTotUnit = String.Empty Then
                        oObject = WaitForElement(driver, WaitForTime, By.Id("totalNumOfDonatedUnits"))
                        If Not oObject Is Nothing Then
                            Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                            oTotunits_Element.Click()
                            oTotunits_Element.SendKeys(Keys.Control + "a")
                            oTotunits_Element.SendKeys(sScoringDonatedPropTotUnit)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Total No of Donated units", myLogPath, , actionHistoryRecordID)
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & " Could not locate the Donated Units "
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not locate the Donated Units.", myLogPath, , actionHistoryRecordID)
                            CaptureScreenshot(actionHistoryRecordID)

                        End If
                    Else

                        GoTo sScoringdonatedPropTotSqtUnit
                    End If

sScoringdonatedPropTotSqtUnit:

                    'Enter the Donated Square feet

                    If Not sScoringdonatedPropTotSqtUnit = String.Empty Then
                        oObject = WaitForElement(driver, WaitForTime, By.Id("totalSquareFeetOfDonatedLand"))
                        If Not oObject Is Nothing Then
                            Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                            oTotunits_Element.SendKeys(Keys.Control + "a")
                            oTotunits_Element.SendKeys(sScoringdonatedPropTotSqtUnit)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Entered total sqt feet donated ", myLogPath, , actionHistoryRecordID)

                        Else

                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & " Could not locate the Donated square feet"
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not locate donated total square feet. ", myLogPath, , actionHistoryRecordID)
                            CaptureScreenshot(actionHistoryRecordID)

                        End If
                    Else
                        mosaicDll.Logger(senderMCPAction, "Actual Result | No values entered for neither total no of  Donated units and total square feet ", myLogPath, , actionHistoryRecordID)
                        GoTo NextDiscounted
                    End If

                End If
sDonated_Prop_PerFHLBC:

            ElseIf sScoringDonatedProp.ToUpper = "NO" Then
                oObject = Nothing
                sField_Element = Nothing
                oObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[1]/td/table/tbody/tr/td[1]/table/tbody/tr/td[3]/table/tbody/tr/td[2]/label/input"))
                If Not oObject Is Nothing Then
                    Dim sFieldElement As IWebElement = DirectCast(oObject, IWebElement)
                    sFieldElement.Click()
                    'setting a flag here '
                    bDonated_No = True
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked on No radio button for donated property", myLogPath, , actionHistoryRecordID)
                    GoTo NextDiscounted

                Else

                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "could not locate no radio button for donated property "
                    mosaicDll.Logger(senderMCPAction, "Actual Result |  Could not click no radio button for Donated properties ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If

            ElseIf Not sScoringDonatedProp.ToUpper = String.Empty Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Invalid value for Scoring Donated? in Data Template"
                mosaicDll.Logger(senderMCPAction, "Actual Result |  Invalid value specified for Donated Property? Expected Yes or No: " & sScoringDonatedProp.ToString, myLogPath, , actionHistoryRecordID)

            End If




NextDiscounted:


            If sScoringDiscountedProp.ToUpper = "NO" Then
                oObject = Nothing
                sField_Element = Nothing
                oObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/table/tbody/tr/td[1]/table/tbody/tr/td[3]/table/tbody/tr/td[2]/label/input"))
                If Not oObject Is Nothing Then
                    Dim sFieldElement As IWebElement = DirectCast(oObject, IWebElement)
                    sFieldElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the No radio Button for Discounted properties", myLogPath, , actionHistoryRecordID)
                    'If is no radio button  donated peropty go to save and next '
                    If bDonated_No = True Then
                        GoTo Save
                    Else
                        GoTo CommonFields
                    End If
                    'GoTo NextStep
                Else

                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Could not locate the no option. "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked on No radio button.", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If
                'If bDonated_No = True Then
                '    GoTo Save
                'Else
                '    GoTo NextStep3
                'End If




            ElseIf sScoringDiscountedProp.ToUpper = "YES" Then

                'User has clicked yes set the value fields
                Dim oObject1 As New Object
                Dim sField_Element1 As IWebElement = Nothing
                Dim oYes As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td/div/table/tbody/tr[3]/td/table/tbody/tr/td[1]/table/tbody/tr/td[3]/table/tbody/tr/td[1]/label/input"))
                If Not oYes Is Nothing Then
                    Dim oYes_Element As IWebElement = DirectCast(oYes, IWebElement)
                    oYes_Element.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Yes radio button for Discounted property per fhlbc ", myLogPath, , actionHistoryRecordID)

                    'Enter Fair Market Value If the DataTemplate is not null 
                    If Not sScoringFairMarketValue = String.Empty Then
                        oObject = WaitForElement(driver, WaitForTime, By.Id("fairMarketValue"))
                        If Not oObject Is Nothing Then
                            Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                            oTotunits_Element.SendKeys(Keys.Control + "a")
                            oTotunits_Element.SendKeys(sScoringFairMarketValue)
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Entered Fair Market Value", myLogPath, , actionHistoryRecordID)
                        Else

                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & " Could not locate FMV for discounted property"
                            mosaicDll.Logger(senderMCPAction, "Actual Result | Could not locate fair market value for discounted Properties", myLogPath, , actionHistoryRecordID)
                            CaptureScreenshot(actionHistoryRecordID)
                            GoTo FairMkt
                        End If
                    End If
                End If
            ElseIf Not sScoringDiscountedProp.ToUpper Is Nothing Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Invalid value for Scoring Discounted? in Data Template"
                mosaicDll.Logger(senderMCPAction, "Actual Result |  Invalid value specified for Discounted? Expected Yes or No: " & sScoringDiscountedProp.ToString, myLogPath, , actionHistoryRecordID)
            End If



            'Enter Total Conveyance Amount If the data template is not null
FairMkt:    If Not sScoringFairMarketValue = String.Empty Then
                oObject = Nothing
                oObject = WaitForElement(driver, WaitForTime, By.Id("totalConveyanceAmount"))
                If Not oObject Is Nothing Then
                    Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                    oTotunits_Element.SendKeys(Keys.Control + "a")
                    oTotunits_Element.SendKeys(sScoringTotAmtConveyance)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Entered the Total Conveyance  for discounted Properties", myLogPath, , actionHistoryRecordID)
                Else

                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not locate the total amt of conveyance for discounted properties "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | could not locate the total conveyance Amt for discounted properties ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If

CommonFields:
                'Enter Total square feet of land in the project for don/disc
                'oObject = Nothing
                oObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='totalSquareFeetOfLand']"))
                If Not oObject Is Nothing Then
                    Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                    oTotunits_Element.SendKeys(Keys.Control + "a")
                    oTotunits_Element.SendKeys(sScoringTotSqtFtland)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Entered the Total Square Feet of land in project.", myLogPath, , actionHistoryRecordID)
                Else

                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not locate the Total Square Feet of land in project "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not locate tot sqt feet of land in project  for don/disc ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If

                ' Total number of properties to be acquired in the project

                oObject = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='numOfPropertiesToBeAcquired']"))
                If Not oObject Is Nothing Then
                    Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                    oTotunits_Element.SendKeys(Keys.Control + "a")
                    oTotunits_Element.SendKeys(sScoringTotPropAcq)
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Entered the Total No of Properties to be acquired for Don/Disc", myLogPath, , actionHistoryRecordID)
                Else

                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " Could not locate the Donated Units or land "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Could not total number of properties to be acquired in the project for Don/Disc  ", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)

                End If

            End If

            'Yes for Don/Disc Prop

            oObject = Nothing
            sField_Element = Nothing

            If sDonDisc_All_identified.ToUpper = "YES" Then

                'user has clicked yes set the value fields

                Dim oYes As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='donatedDiscountedPropertyRadioId']/tbody/tr/td[1]/label"))

                If Not oYes Is Nothing Then
                End If
                Dim oYes_Element As IWebElement = DirectCast(oYes, IWebElement)
                oYes_Element.Click()
                GoTo Save



            End If
            oObject = Nothing
            sField_Element = Nothing

            If sDonDisc_All_identified.ToUpper = "NO" Then

                'user has clicked No set the value fields

                Dim oNo As Object = WaitForElement(driver, WaitForTime, By.XPath("//table[@id='donatedDiscountedPropertyRadioId']/tbody/tr/td[2]/label"))

                If Not oNo Is Nothing Then
                End If
                Dim oNo_Element As IWebElement = DirectCast(oNo, IWebElement)
                oNo_Element.Click()

            End If

            ' Entering The number of donated/discounted properties for which addresses are not known

            Dim oProp As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='numOfPropertiesForWhichAddressNotKnown']"))
            If Not oProp Is Nothing Then
                Dim oTotunits_Element As IWebElement = DirectCast(oProp, IWebElement)
                oTotunits_Element.SendKeys(Keys.Control + "a")
                oTotunits_Element.SendKeys(sDonDisc_nbrNotKnown)

            Else

                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not locate the Donated Units or land "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Entered The number of donated/discounted properties for which addresses are not known ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)

            End If

            ' Entering the comment "Please provide an explanation of why the addresses are not known and when they will be known.

            If Not String.IsNullOrEmpty(sDonDiscExplainNotKnown) Then
                System.Windows.Forms.Clipboard.Clear()

                Dim sRetVal As String = GetWordText(sDonDiscExplainNotKnown)
                If sRetVal.ToUpper = "FILE NOT FOUND" Then
                    oObject = WaitForElement(driver, WaitForTime, By.Id("debtDescription"))

                    If Not oObject Is Nothing Then
                        Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                        oTotunits_Element.SendKeys(Keys.Control + "a")
                        oTotunits_Element.SendKeys(sDonDiscExplainNotKnown)
                        mosaicDll.Logger(senderMCPAction, "Actual Result|Entered the explanation ", myLogPath, , actionHistoryRecordID)
                    End If

                ElseIf sRetVal.ToUpper = "FILE FOUND" Then
                    oObject = WaitForElement(driver, WaitForTime, By.Id("debtDescription"))

                    If Not oObject Is Nothing Then
                        Dim oTotunits_Element As IWebElement = DirectCast(oObject, IWebElement)
                        oTotunits_Element.SendKeys(Keys.Control + "a")
                        oTotunits_Element.SendKeys(Keys.Delete)

                        Dim myClipboardTest As String = System.Windows.Forms.Clipboard.GetText()
                        oTotunits_Element.SendKeys(Keys.Control + "v")

                        mosaicDll.Logger(senderMCPAction, "Actual Result| Explanation entered from file ", myLogPath, , actionHistoryRecordID)
                    End If
                Else
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result|No explanation entered ", myLogPath, , actionHistoryRecordID)
            End If


Save:

            ' Clicking on Save button
            ' Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("//input[@id='pageTemplateForm:saveButton']"))
            Dim oSave As Object = WaitForElement(driver, WaitForTime, By.XPath("/html/body/div[4]/form/div[2]/div[2]/table[3]/tbody/tr/td[2]/table/tbody/tr[2]/td[1]/div/input"))
            If Not oSave Is Nothing Then
                Dim oSave_Element As IWebElement = DirectCast(oSave, IWebElement)
                oSave_Element.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result |Clicked Save Button", myLogPath, , actionHistoryRecordID)
                If Not SDonDisExpectedErrorMessage = "" Then
                    returnValues(1) = returnValues(1) & " Screen Shot Provided to Validate Error Message "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Screen Shot Provided to Validate Error Message", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                End If
            Else

                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not locate Save Button "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Not able to locate Save button", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)

            End If

Nextbutton:

            ' Clicking on Next button
            Dim oNext As Object = WaitForElement(driver, WaitForTime, By.XPath("//div[@id='tab']/table[4]/tbody/tr/td[2]/a"))
            If Not oNext Is Nothing Then
                Dim oNext_Element As IWebElement = DirectCast(oNext, IWebElement)
                oNext_Element.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Next button ", myLogPath, , actionHistoryRecordID)
            Else

                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not locate Next Button"
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not locate Next Button", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)

            End If

        Catch ex As Exception


            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            CaptureScreenshot(actionHistoryRecordID)

        End Try
        ScD1_Clk_Enter_Don_Disc_Fields_Save_next = returnValues
    End Function
    Public Function Gen2d_Multi_Clk_Add_Site(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try

            Dim inputElements As IList(Of IWebElement) = driver.FindElements(By.XPath("//input"))

            Dim Foundlookup As Boolean = False
            For y As Integer = 1 To inputElements.Count - 1
                If inputElements(y).GetAttribute("value").ToUpper.ToString() = "ADD SITE" Then
                    'Or inputElements(y).GetAttribute("value").ToUpper.ToString() = "ADD KNOWN SITES" Then
                    Dim inputElement As IWebElement = inputElements(y)
                    inputElement.Click()
                    returnValues(1) = returnValues(1) & " Clicked Add Site Button. "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Add Site Button. ", myLogPath, , actionHistoryRecordID)
                    Foundlookup = True
                    Exit For
                ElseIf inputElements(y).GetAttribute("value").ToUpper.ToString() = "ADD KNOWN SITES" Then
                    Dim inputElement As IWebElement = inputElements(y)
                    inputElement.Click()
                    returnValues(1) = returnValues(1) & " Clicked Add Known Site Button. "
                    mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked Add Known Site Button. ", myLogPath, , actionHistoryRecordID)
                    Foundlookup = True
                    Exit For
                End If
            Next
            'Click and Validate Zip Lookup
            If Foundlookup = False Then
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & " Could not Click Add Site or Add Known Site. "
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not Click Add Site or Add Known Site. ", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function ScD2_Enter_Donated_Disc_Evid_Save_Next(ByVal mcpParameters() As Object) As Object()

        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)


        Try
            Dim nextPath As String = "//div[@id='tab']/table[4]/tbody/tr/td[2]/a"
            Dim savePath As String = "//input[@id='pageTemplateForm:saveButton']"
            Dim optionPath As String = ""
            'click the no option button

            Dim a As New AutomationObject
            'a.aObject = WaitForElement(driver, WaitForTime, By.XPath(optionPath))
            'If Not a.aObject Is Nothing Then
            '    a.aElement = DirectCast(a.aObject, IWebElement)
            '    a.aElement.Click()
            '    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the no button concerning homeless points.", myLogPath, , actionHistoryRecordID)
            'Else
            '    returnValues(0) = executionStatusFailed
            '    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the no button concerning homeless points.", myLogPath, , actionHistoryRecordID)

            'End If

            'click save button0.
            'Dim savebutton As New AutomationObject
            'a.aObject = WaitForElement(driver, WaitForTime, By.XPath(savePath))
            'If Not a.aObject Is Nothing Then
            '    a.aElement = DirectCast(a.aObject, IWebElement)
            '    a.aElement.Click()
            '    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked the save button.", myLogPath, , actionHistoryRecordID)
            'Else
            '    returnValues(0) = executionStatusFailed
            '    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the save button", myLogPath, , actionHistoryRecordID)
            'End If

            'click next button
            Dim nextbutton As New AutomationObject
            a.aObject = WaitForElement(driver, WaitForTime, By.XPath(nextPath))
            If Not a.aObject Is Nothing Then
                a.aElement = DirectCast(a.aObject, IWebElement)
                a.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result|Clicked the next button.", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not the next button.", myLogPath, , actionHistoryRecordID)

            End If


            returnValues(1) = "(* no score version  *)"
            mosaicDll.Logger(senderMCPAction, "Actual Result|", myLogPath, , actionHistoryRecordID)
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function



#End Region
#Region "CID"
    Public Function Login_Navigate_Menu(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try


            Dim sFairHousingDesc As String = mosaicDll.dt(excelPath, iteration, "appl_application_main_data", "Fair_Housing_Desc")



            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function Nav_Login_CID_or_APEX(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try




            Dim sCIDUserName As String = mosaicDll.dt(excelPath, iteration, "cidusr_cid_users", "CID_Username")
            Dim sCIDPasswordFile As String = mosaicDll.dt(excelPath, iteration, "cidusr_cid_users", "Password_File")
            Dim sUnameXpath As String = "//input[@id='P101_USERNAME']"
            Dim sPwdXPath As String = "/html/body/form/table[1]/tbody/tr/td/table[1]/tbody/tr[2]/td[2]/input[2]"
            Dim sLoginButtonXPath As String = "//a[@id='P101_LOGIN']"


            'enter the user name
            Dim aoUserName As New AutomationObject
            aoUserName.aObject = WaitForElement(driver, WaitForTime, By.XPath(sUnameXpath))
            If Not aoUserName.aObject Is Nothing Then
                aoUserName.aElement = DirectCast(aoUserName.aObject, IWebElement)
                aoUserName.aElement.SendKeys(Keys.Control + "a")
                aoUserName.aElement.SendKeys(sCIDUserName)
                mosaicDll.Logger(senderMCPAction, "Entered the user name ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not enter the user name or no name was supplied.", myLogPath, , actionHistoryRecordID)
            End If



            'get ready to  insert the password
            Dim aoPassword As New AutomationObject
            aoPassword.aObject = WaitForElement(driver, WaitForTime, By.XPath(sPwdXPath))
            If Not aoPassword.aObject Is Nothing Then
                aoPassword.aElement = DirectCast(aoPassword.aObject, IWebElement)
                aoPassword.aElement.Click()
            End If




            'password
            'get the password from the password file referenced by the template

            If Not String.IsNullOrEmpty(sCIDPasswordFile) Then
                System.Windows.Forms.Clipboard.Clear()
                Dim sRetVal As String = GetWordText(sCIDPasswordFile)
                If sRetVal.ToUpper = "FILE FOUND" Then
                    aoPassword.aElement.SendKeys(System.Windows.Forms.Clipboard.GetText())
                ElseIf sRetVal.ToUpper = "FILE NOT FOUND" Then
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Couid not find the file contaiining user crendentials", myLogPath, , actionHistoryRecordID)
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & " " & sRetVal
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Error from GetWordText Function:" & sRetVal, myLogPath, , actionHistoryRecordID)
                End If
            Else
                mosaicDll.Logger(senderMCPAction, "Actual Result| No password file was found.", myLogPath, , actionHistoryRecordID)
            End If

            Dim aoLoginButton As New AutomationObject
            aoLoginButton.aObject = WaitForElement(driver, WaitForTime, By.XPath(sLoginButtonXPath))
            If Not aoLoginButton.aObject Is Nothing Then
                aoLoginButton.aElement = DirectCast(aoLoginButton.aObject, IWebElement)
                aoLoginButton.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result | Clicked the login button", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result | Could not click the login button.", myLogPath, , actionHistoryRecordID)
            End If




            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function RevApp1_Access_App_For_Rev(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try



            Dim sActionButtonXPath As String = "//button[@id='apexir_ACTIONSMENUROOT']/span"
            Dim sResetButtonXPath As String = "//ul[@id='apexir_ACTIONSMENU']/li[10]/a"
            Dim sApplyButtonXPath As String = "//button[@id='apexir_btn_APPLY']/span"

            'Dim sPwdXPath As String = "/html/body/form/table[1]/tbody/tr/td/table[1]/tbody/tr[2]/td[2]/input[2]"
            'Dim sLoginButtonXPath As String = "//a[@id='P101_LOGIN']"


            'Clearing previous searches

            'Click the action button
            Dim aoAction As New AutomationObject
            aoAction.aObject = WaitForElement(driver, WaitForTime, By.XPath(sActionButtonXPath))
            If Not aoAction.aObject Is Nothing Then
                aoAction.aElement = DirectCast(aoAction.aObject, IWebElement)
                aoAction.aElement.Click()

                ' mosaicDll.Logger(senderMCPAction, "Entered the user name ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the action button.", myLogPath, , actionHistoryRecordID)
            End If

            'Click the reset menu item
            Dim aoReset As New AutomationObject
            aoReset.aObject = WaitForElement(driver, WaitForTime, By.XPath(sResetButtonXPath))
            If Not aoReset.aObject Is Nothing Then
                aoReset.aElement = DirectCast(aoReset.aObject, IWebElement)
                aoReset.aElement.Click()
                'aoReset.aElement.SendKeys(sCIDUserName)
                ' mosaicDll.Logger(senderMCPAction, "Entered the user name ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the reset button.", myLogPath, , actionHistoryRecordID)
            End If

            'Click the apply button to confirm
            Dim aoApply As New AutomationObject
            aoApply.aObject = WaitForElement(driver, WaitForTime, By.XPath(sApplyButtonXPath))
            If Not aoApply.aObject Is Nothing Then
                aoApply.aElement = DirectCast(aoApply.aObject, IWebElement)
                aoApply.aElement.Click()
                ' mosaicDll.Logger(senderMCPAction, "Entered the user name ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the apply button.", myLogPath, , actionHistoryRecordID)
            End If

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            'Enter the application number
            Dim sAppNbrFieldXPath As String = "//input[@id='apexir_SEARCH']"
            Dim sAppNbr As String = mosaicDll.dt(excelPath, iteration, "revassgn_appl_rev_assignments", "Appl_Nbr")
            Dim aoAppNbr As New AutomationObject
            aoAppNbr.aObject = WaitForElement(driver, WaitForTime, By.XPath(sAppNbrFieldXPath))
            If Not aoAppNbr.aObject Is Nothing Then
                aoAppNbr.aElement = DirectCast(aoAppNbr.aObject, IWebElement)
                aoAppNbr.aElement.SendKeys(sAppNbr)
                ' mosaicDll.Logger(senderMCPAction, "Entered the user name ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the apply button.", myLogPath, , actionHistoryRecordID)
            End If

            'Click the go button
            Dim aoGoButton As New AutomationObject
            Dim sGoButtonXPath As String = "//button[@id='apexir_btn_SEARCH']/span"
            aoGoButton.aObject = WaitForElement(driver, WaitForTime, By.XPath(sGoButtonXPath))
            If Not aoGoButton.aObject Is Nothing Then
                aoGoButton.aElement = DirectCast(aoGoButton.aObject, IWebElement)
                aoGoButton.aElement.Click()
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the apply button.", myLogPath, , actionHistoryRecordID)
            End If

            Dim wait2 As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait2.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            'click the flashlight 
            Dim aoSelectButton As New AutomationObject
            Dim sSelectButtonXPath As String = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[2]/table[2]/tbody/tr[2]/td/div[1]/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[1]/td/table/tbody/tr[3]/td[1]/a/img"
            aoSelectButton.aObject = WaitForElement(driver, WaitForTime, By.XPath(sSelectButtonXPath))
            If Not aoSelectButton.aObject Is Nothing Then
                aoSelectButton.aElement = DirectCast(aoSelectButton.aObject, IWebElement)
                aoSelectButton.aElement.Click()
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the apply button.", myLogPath, , actionHistoryRecordID)
            End If



            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function RevApp2_Sel_Type_Cat_For_Rev(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try


            Dim sType_Category_or_Guideline As String = mosaicDll.dt(excelPath, iteration, "typcatguid_thresh_score_feas", "Type_Category_or_Guideline")
            Dim sTypeofReview As String = mosaicDll.dt(excelPath, iteration, "typcatguid_thresh_score_feas", "Threshold_Scoring_or_Feasibility")

            Dim sTypeCatXPath As String = "//input[@id='apexir_SEARCH']"
            Dim sGoButtonXPath As String = "//button[@id='apexir_btn_SEARCH']/span"
            Dim sCancelpath As String = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td[1]/a/font"
            Dim sActionButtonXPath As String = "//button[@id='apexir_ACTIONSMENUROOT']/span"
            Dim sResetButtonXPath As String = "//ul[@id='apexir_ACTIONSMENU']/li[9]/a"
            Dim sApplyButtonXPath As String = "//button[@id='apexir_btn_APPLY']/span"
            Dim bIsType As Boolean = True
            Dim NotonSCorThresholdpage As Boolean = False

            sType_Category_or_Guideline = sType_Category_or_Guideline
            'Check to see if we are on the correct page on the correct type
            Dim ochkType As New AutomationObject

            'ThreshHold and Scoring have the same xpath for the check field

            'look for th threshold type description field
            'check other fields here as well this could be seperate actions /html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[3]/table[4]/tbody/tr/td/div[1]/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[1]/td/table/tbody/tr[2]/td[1]/a/img
            If CleanString(sTypeofReview) = "SCORING" Then
                ochkType.aObject = WaitForElement(driver, 10, By.Id("P7023_SCORING_TYPE_DESC"))
            Else
                ochkType.aObject = WaitForElement(driver, 10, By.Id("P7019_THRESHOLD_TYPE_DESC"))
            End If

            'ochkType.aObject = WaitForElement(driver, WaitForTime, By.XPath("//span[@id='P7019_THRESHOLD_TYPE_DESC']"))
            'ochkType.aObject = WaitForElement(driver, WaitForTime, By.XPath("/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[2]/table[3]/tbody/tr/td/table/tbody/tr[3]/td[2]/span"))
            If Not ochkType.aObject Is Nothing Then
                ochkType.aElement = DirectCast(ochkType.aObject, IWebElement)
                'if we really want we check the precise threshold type.
                If ochkType.aElement.Text = sType_Category_or_Guideline Then
                    GoTo Done
                Else
                    bIsType = False
                End If
            Else
                NotonSCorThresholdpage = True
                'returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Not on " & sTypeofReview & " Page.", myLogPath, , actionHistoryRecordID)
            End If

            'Click the action button
            If bIsType = False Then
                'click Cancel to return to previous page
                Dim aoThreshType As New AutomationObject
                'aoThreshType.aObject = WaitForElement(driver, WaitForTime, By.XPath(sTypeCatXPath))
                aoThreshType.aObject = WaitForElement(driver, WaitForTime, By.XPath(sCancelpath))
                If Not aoThreshType.aObject Is Nothing Then
                    aoThreshType.aElement = DirectCast(aoThreshType.aObject, IWebElement)
                    aoThreshType.aElement.Click()
                    Dim wait3 As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
                    wait3.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Could not click cancel to return to category selection"
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click cancel to return to category selection", myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo Done
                End If
            End If

            'Click the action button
            Dim aoAction As New AutomationObject
            aoAction.aObject = WaitForElement(driver, WaitForTime, By.XPath(sActionButtonXPath))
            If Not aoAction.aObject Is Nothing Then
                aoAction.aElement = DirectCast(aoAction.aObject, IWebElement)
                aoAction.aElement.Click()

                ' mosaicDll.Logger(senderMCPAction, "Entered the user name ", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the action button.", myLogPath, , actionHistoryRecordID)
            End If

            'Click the reset menu item
            Dim aoReset As New AutomationObject
            aoReset.aObject = WaitForElement(driver, WaitForTime, By.XPath(sResetButtonXPath))
            If Not aoReset.aObject Is Nothing Then
                aoReset.aElement = DirectCast(aoReset.aObject, IWebElement)
                aoReset.aElement.Click()

            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the reset button.", myLogPath, , actionHistoryRecordID)
            End If

            'Click the apply button to confirm
            Dim aoApply As New AutomationObject
            aoApply.aObject = WaitForElement(driver, WaitForTime, By.XPath(sApplyButtonXPath))
            If Not aoApply.aObject Is Nothing Then
                aoApply.aElement = DirectCast(aoApply.aObject, IWebElement)
                aoApply.aElement.Click()

            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click the apply button.", myLogPath, , actionHistoryRecordID)
            End If

            Dim wait As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            Threading.Thread.Sleep(30)

            'Search for Category
            Dim boThreshType As New AutomationObject
            boThreshType.aObject = WaitForElement(driver, WaitForTime, By.XPath(sTypeCatXPath))
            If Not boThreshType.aObject Is Nothing Then
                boThreshType.aElement = DirectCast(boThreshType.aObject, IWebElement)
                boThreshType.aElement.SendKeys(sType_Category_or_Guideline)

            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & "Could not search for category selection"
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not search for category selection: " & sType_Category_or_Guideline, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            'Click the go button
            Dim aoGoButton As New AutomationObject
            aoGoButton.aObject = WaitForElement(driver, WaitForTime, By.XPath(sGoButtonXPath))
            If Not aoGoButton.aObject Is Nothing Then
                aoGoButton.aElement = DirectCast(aoGoButton.aObject, IWebElement)
                aoGoButton.aElement.Click()

            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & "Could not  click Go search for category selection"
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not click go to search for category selection.", myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
            End If

            Dim wait2 As IWait(Of IWebDriver) = New OpenQA.Selenium.Support.UI.WebDriverWait(driver, TimeSpan.FromSeconds(60.0))
            wait2.Until(Function(driver1) DirectCast(driver, IJavaScriptExecutor).ExecuteScript("return document.readyState").Equals("complete"))

            Dim sPathToFoundSCorThresholdXPath As String = Nothing
            Dim SCheckValueXPath As String = Nothing
            If CleanString(sTypeofReview) = "SCORING" Then
                sPathToFoundSCorThresholdXPath = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[3]/table[3]/tbody/tr/td/div[1]/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[1]/td/table/tbody/tr[2]/td[1]/a/img"
                SCheckValueXPath = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[3]/table[3]/tbody/tr/td/div[1]/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[1]/td/table/tbody/tr[2]/td[2]"
            Else
                sPathToFoundSCorThresholdXPath = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[3]/table[4]/tbody/tr/td/div[1]/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[1]/td/table/tbody/tr[2]/td[1]/a/img"
                'Dim sCheckValueXPath As String = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[3]/table[4]/tbody/tr/td/div[1]/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[1]/td/table/tbody/tr[2]/td[2]"
                SCheckValueXPath = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[3]/table[4]/tbody/tr/td/div[1]/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[1]/td/table/tbody/tr[2]/td[2]"
            End If
            Dim aoCheckValue As New AutomationObject
            aoCheckValue.aObject = WaitForElement(driver, WaitForTime, By.XPath(SCheckValueXPath))
            If Not aoCheckValue.aObject Is Nothing Then
                aoCheckValue.aElement = DirectCast(aoCheckValue.aObject, IWebElement)
                If aoCheckValue.aElement.Text = sType_Category_or_Guideline Then
                    'success
                Else
                    returnValues(0) = executionStatusFailedAbort
                    returnValues(1) = returnValues(1) & "Could not find the threshold or category:" & sType_Category_or_Guideline
                    mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the threshold or category:" & sType_Category_or_Guideline, myLogPath, , actionHistoryRecordID)
                    CaptureScreenshot(actionHistoryRecordID)
                    GoTo Done
                End If

            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & "Could not find the threshold or category:" & sType_Category_or_Guideline
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find the threshold or category:" & sType_Category_or_Guideline, myLogPath, , actionHistoryRecordID)
                CaptureScreenshot(actionHistoryRecordID)
                GoTo Done
            End If


            Dim aoThreshholdFound As New AutomationObject
            aoThreshholdFound.aObject = WaitForElement(driver, WaitForTime, By.XPath(sPathToFoundSCorThresholdXPath))
            If Not aoThreshholdFound.aObject Is Nothing Then
                aoThreshholdFound.aElement = DirectCast(aoThreshholdFound.aObject, IWebElement)
                aoThreshholdFound.aElement.Click()

            Else
                returnValues(0) = executionStatusFailedAbort
                mosaicDll.Logger(senderMCPAction, "Actual Result|Could not find our click on Category: " & sType_Category_or_Guideline, myLogPath, , actionHistoryRecordID)
            End If


Done:
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function
    Public Function RevApp3_Resp_to_Suppl_Quest_Rev1(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try


            Dim sQuestion As String = mosaicDll.dt(excelPath, iteration, "supquest_supplemental_questions", "Question")
            Dim sQuestionID As String = mosaicDll.dt(excelPath, iteration, "supquest_supplemental_questions", "Question_ID")
            Dim sAnswerType As String = mosaicDll.dt(excelPath, iteration, "supquest_supplemental_questions", "Answer_Type")
            Dim sAnswer_Action As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "Answer_Action")
            Dim sFirst_Review_Answer As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "First_Review_Answer")
            Dim sFirst_Review_Answer_ID As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "First_Review_Ans_ID")
            Dim sFirst_Review_Comment As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "First_Review_Comment")
            Dim sReview_Complete As String = mosaicDll.dt(excelPath, iteration, "revconfig_rev_type_role_status", "Review_Complete?")
            Dim sReview_Phase As String = mosaicDll.dt(excelPath, iteration, "revconfig_rev_type_role_status", "Review_Phase")
            Dim sFulFill_Guidelines As String = mosaicDll.dt(excelPath, iteration, "revconfig_rev_type_role_status", "FulFill_Guidelines?")




            Select Case sAnswerType.ToUpper

                Case Is = "CHECKBOX"


                    If Not sFirst_Review_Answer_ID = String.Empty Then

                        Dim oCheckBox As New AutomationObject
                        oCheckBox.aObject = driver.FindElement(By.XPath("//Input[@value='" & sFirst_Review_Answer_ID & "']"))

                        If Not oCheckBox.aObject Is Nothing Then
                            oCheckBox.aElement = DirectCast(oCheckBox.aObject, IWebElement)
                            If oCheckBox.aElement.Selected = True Then
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Checkbox: " & sFirst_Review_Answer & " already checked as requested.", myLogPath, , actionHistoryRecordID)
                                'proper state
                            Else
                                oCheckBox.aElement.Click()
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked checkbox: " & sFirst_Review_Answer, myLogPath, , actionHistoryRecordID)
                            End If
                            If Not sFirst_Review_Comment = String.Empty Then
                                Dim sTextAreaXPath As String = "//Input [@name='f06' and @value='"
                                sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::textarea[1]"
                                'Dim FindTextArea_Object As Object = driver.FindElement(By.XPath("//Input [@name='f06' and @value='209']/following::textarea[1]"))
                                Dim FindTextArea_Object As Object = driver.FindElement(By.XPath(sTextAreaXPath))
                                If Not FindTextArea_Object Is Nothing Then
                                    Dim FindTextArea_Element As IWebElement = DirectCast(FindTextArea_Object, IWebElement)
                                    FindTextArea_Object.SendKeys(Keys.Control + "a")
                                    FindTextArea_Object.SendKeys(sFirst_Review_Comment)
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Entered Comment for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                Else
                                    returnValues(0) = executionStatusFailed
                                    returnValues(1) = returnValues(1) & "Could not enter comment for question: " & sQuestion
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter comment for checkbox question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                End If
                            End If


                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Could not click the check box: " & sFirst_Review_Answer & " for question: " & sQuestion
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the check box for: " & sFirst_Review_Answer & "for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                        End If
                    End If


                Case Is = "RADIOBUTTON"
                    If Not sFirst_Review_Answer_ID = String.Empty Then
                        Dim oRadioButton As New AutomationObject
                        oRadioButton.aObject = driver.FindElement(By.XPath("//Input[@value='" & sFirst_Review_Answer_ID & "']"))

                        If Not oRadioButton.aObject Is Nothing Then
                            oRadioButton.aElement = DirectCast(oRadioButton.aObject, IWebElement)
                            oRadioButton.aElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked radio button: " & sFirst_Review_Answer & " for " & sQuestion, myLogPath, , actionHistoryRecordID)

                            If Not sFirst_Review_Comment = String.Empty Then
                                Dim sTextAreaXPath As String = "//Input [@name='f06' and @value='"
                                sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::textarea[1]"
                                'Dim FindTextArea_Object As Object = driver.FindElement(By.XPath("//Input [@name='f06' and @value='209']/following::textarea[1]"))
                                Dim FindTextArea_Object As Object = driver.FindElement(By.XPath(sTextAreaXPath))
                                If Not FindTextArea_Object Is Nothing Then
                                    Dim FindTextArea_Element As IWebElement = DirectCast(FindTextArea_Object, IWebElement)
                                    FindTextArea_Object.SendKeys(Keys.Control + "a")
                                    FindTextArea_Object.SendKeys(sFirst_Review_Comment)
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Entered comment for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                Else
                                    returnValues(0) = executionStatusFailed
                                    returnValues(1) = returnValues(1) & ""
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter comment for checkbox question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                End If
                            End If
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Could not click radio button " & sFirst_Review_Answer & "for question: " & sQuestion
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click radio button " & sFirst_Review_Answer & "for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                        End If
                    Else

                    End If
                    '<input type'="hidden" name="f07" value="265"  /><input type="text" name="f04" size="20" maxlength="2000" value=""  />
                    'input type="hidden" name="f06" value="44"  /><textarea name="f03" rows="4" cols="80" wrap="VIRTUAL" >Of course</textarea>
                Case Is = "TEXTBOX"

                    If Not sQuestionID = String.Empty Then
                        If Not sFirst_Review_Answer = String.Empty Then
                            Dim FindTextArea As New AutomationObject
                            Dim sTextAreaXPath As String = "//Input [@name='f07' and @value='"
                            sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::input[1]"
                            FindTextArea.aObject = driver.FindElement(By.XPath(sTextAreaXPath))

                            If Not FindTextArea.aObject Is Nothing Then
                                FindTextArea.aElement = DirectCast(FindTextArea.aObject, IWebElement)
                                FindTextArea.aElement.SendKeys(Keys.Control + "a")
                                FindTextArea.aElement.SendKeys(sFirst_Review_Answer)
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & sFirst_Review_Answer & " in text box for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            Else
                                returnValues(0) = executionStatusFailed
                                returnValues(1) = returnValues(1) & "Could not enter enter " & sFirst_Review_Answer & " in text box for question: " & sQuestion
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter enter " & sFirst_Review_Answer & " in text box for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            End If
                        End If
                    End If

                Case Is = "TEXTAREA"

                    If Not sQuestionID = String.Empty Then
                        If Not sFirst_Review_Answer = String.Empty Then
                            Dim FindTextArea As New AutomationObject
                            Dim sTextAreaXPath As String = "//Input [@name='f06' and @value='"
                            sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::textarea[1]"
                            FindTextArea.aObject = driver.FindElement(By.XPath(sTextAreaXPath))
                            If Not FindTextArea.aObject Is Nothing Then
                                FindTextArea.aElement = DirectCast(FindTextArea.aObject, IWebElement)
                                FindTextArea.aElement.SendKeys(Keys.Control + "a")
                                FindTextArea.aElement.SendKeys(sFirst_Review_Answer)
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered answer in text area for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            Else
                                returnValues(0) = executionStatusFailed
                                returnValues(1) = returnValues(1) & "Could not enter answer in text area for question: " & sQuestion
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter answer in text area for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            End If
                        End If
                    End If


            End Select




ThresholdFinalQuestion:
            Dim SCompleteXPath As String = Nothing
            Dim SFullFilledXPath As String = Nothing
            If CleanString(sReview_Phase) = "THRESHOLD" Then
                If CleanString(sReview_Complete) = "YES" Then

                    SCompleteXPath = "//input[@id='P7019_IS_COMPLETE_0']"
                Else
                    If CleanString(sReview_Complete) = "NO" Then
                        SCompleteXPath = "//input[@id='P7019_IS_COMPLETE_1']"
                    Else
                        If Not String.IsNullOrEmpty(sReview_Complete) Then
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No."
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                        Else
                            GoTo IsFulfilled
                        End If
                    End If
                End If
            Else
                GoTo ClickScoringComplete
            End If

            'Dim sFullFilledXPath As String = "//input[@id='P7019_IS_COMPLETE_0']"
            'Click the action button
            Dim aoThreshTypeComplete As New AutomationObject
            aoThreshTypeComplete.aObject = WaitForElement(driver, WaitForTime, By.XPath(SCompleteXPath))
            If Not aoThreshTypeComplete.aObject Is Nothing Then
                aoThreshTypeComplete.aElement = DirectCast(aoThreshTypeComplete.aObject, IWebElement)
                If aoThreshTypeComplete.aElement.Selected = True Then
                    'Okay as is
                Else
                    aoThreshTypeComplete.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked " & sReview_Complete & " radio button for Is the Review Complete?", myLogPath, , actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & "Could not click " & sReview_Complete & " for Is the Review Complete?: "
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click " & sReview_Complete & " for Is the Review Complete?: ", myLogPath, , actionHistoryRecordID)
            End If

IsFulfilled:
            If CleanString(sFulFill_Guidelines) = "YES" Then

                SFullFilledXPath = "//input[@id='P7019_IS_FULFILLED_0']"
            Else
                If CleanString(sFulFill_Guidelines) = "NO" Then
                    SFullFilledXPath = "//input[@id='P7019_IS_FULFILLED_1']"
                ElseIf Not String.IsNullOrEmpty(sFulFill_Guidelines) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Invalid value specified for if threshold fulfilled: " & sFulFill_Guidelines & ". Expected Yes or No."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for if threshold fulfilled: " & sFulFill_Guidelines & ". Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                Else
                    GoTo ClickApplyChanges
                End If
            End If
            Dim aoThreshTypeFulFilled As New AutomationObject
            aoThreshTypeFulFilled.aObject = WaitForElement(driver, WaitForTime, By.XPath(SFullFilledXPath))
            If Not aoThreshTypeFulFilled.aObject Is Nothing Then
                aoThreshTypeFulFilled.aElement = DirectCast(aoThreshTypeFulFilled.aObject, IWebElement)
                If aoThreshTypeFulFilled.aElement.Selected = True Then
                    'Okay as is
                Else
                    aoThreshTypeFulFilled.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked " & sFulFill_Guidelines & " radio button for Is the Threshold Fulfilled?", myLogPath, , actionHistoryRecordID)

                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not find click " & sFulFill_Guidelines & " radio button for Is the Threshold Fulfilled?"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not find click " & sFulFill_Guidelines & " radio button for Is the Threshold Fulfilled?", myLogPath, , actionHistoryRecordID)
            End If
            GoTo ClickApplyChanges

ClickScoringComplete:
            Dim SScoreCompleteXPath As String = Nothing
            If CleanString(sReview_Phase) = "SCORING" Then
                If CleanString(sReview_Complete) = "YES" Then

                    SCompleteXPath = "//input[@id='P7023_IS_COMPLETE_0']"
                Else
                    If CleanString(sReview_Complete) = "NO" Then
                        SCompleteXPath = "//input[@id='P7023_IS_COMPLETE_1']"
                    Else
                        If Not String.IsNullOrEmpty(sReview_Complete) Then
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No."
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                        Else
                            GoTo ClickApplyChanges
                        End If
                    End If
                End If
            End If


ClickApplyChanges:
            Dim sApplChangesXpath As String = Nothing

            If CleanString(sReview_Phase) = "SCORING" Then
                sApplChangesXpath = "//a[@id='P7023_APPLY_CHANGES']/font/span"
            Else
                sApplChangesXpath = "//a[@id='P7019_APPLY_CHANGES']/font/span"
            End If

            'Dim sApplChangesXpath As String = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td[2]/a/font/span"
            Dim aApplyChanges As New AutomationObject
            aApplyChanges.aObject = WaitForElement(driver, WaitForTime, By.XPath(sApplChangesXpath))
            If Not aApplyChanges.aObject Is Nothing Then
                aApplyChanges.aElement = DirectCast(aApplyChanges.aObject, IWebElement)
                aApplyChanges.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Apply Changes", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not find click Apply Changes "
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not find click Apply Changes ", myLogPath, , actionHistoryRecordID)
            End If
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function

    Public Function RevApp3b_Resp_to_Suppl_Quest_Rev2(ByVal mcpParameters() As Object) As Object()
        Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
        Dim excelPath As String = CType(mcpParameters(0), String)
        Dim iteration As Integer = CType(mcpParameters(1), Integer)
        Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
        Try


            Dim sQuestion As String = mosaicDll.dt(excelPath, iteration, "supquest_supplemental_questions", "Question")
            Dim sQuestionID As String = mosaicDll.dt(excelPath, iteration, "supquest_supplemental_questions", "Question_ID")
            Dim sAnswerType As String = mosaicDll.dt(excelPath, iteration, "supquest_supplemental_questions", "Answer_Type")
            Dim sAnswer_Action As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "Answer_Action")
            Dim sSecond_Review_Answer As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "Second_Review_Answer")
            Dim sSecond_Review_Answer_ID As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "Second_Review_Ans_ID")
            Dim sSecond_Review_Comment As String = mosaicDll.dt(excelPath, iteration, "revansw_reviewanswers_comments", "Second_Review_Comment")
            Dim sReview_Complete As String = mosaicDll.dt(excelPath, iteration, "revconfig_rev_type_role_status", "Review_Complete?")
            Dim sReview_Phase As String = mosaicDll.dt(excelPath, iteration, "revconfig_rev_type_role_status", "Review_Phase")
            Dim sFulFill_Guidelines As String = mosaicDll.dt(excelPath, iteration, "revconfig_rev_type_role_status", "FulFill_Guidelines?")




            Select Case sAnswerType.ToUpper

                Case Is = "CHECKBOX"


                    If Not sSecond_Review_Answer_ID = String.Empty Then

                        Dim oCheckBox As New AutomationObject
                        oCheckBox.aObject = driver.FindElement(By.XPath("//Input[@value='" & sSecond_Review_Answer_ID & "']"))

                        If Not oCheckBox.aObject Is Nothing Then
                            oCheckBox.aElement = DirectCast(oCheckBox.aObject, IWebElement)
                            If oCheckBox.aElement.Selected = True Then
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Checkbox: " & sSecond_Review_Answer & " already checked as requested.", myLogPath, , actionHistoryRecordID)
                                'proper state
                            Else
                                oCheckBox.aElement.Click()
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked checkbox: " & sSecond_Review_Answer, myLogPath, , actionHistoryRecordID)
                            End If
                            If Not sSecond_Review_Comment = String.Empty Then
                                Dim sTextAreaXPath As String = "//Input [@name='f06' and @value='"
                                sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::textarea[1]"
                                'Dim FindTextArea_Object As Object = driver.FindElement(By.XPath("//Input [@name='f06' and @value='209']/following::textarea[1]"))
                                Dim FindTextArea_Object As Object = driver.FindElement(By.XPath(sTextAreaXPath))
                                If Not FindTextArea_Object Is Nothing Then
                                    Dim FindTextArea_Element As IWebElement = DirectCast(FindTextArea_Object, IWebElement)
                                    FindTextArea_Object.SendKeys(Keys.Control + "a")
                                    FindTextArea_Object.SendKeys(sSecond_Review_Comment)
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Entered Comment for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                Else
                                    returnValues(0) = executionStatusFailed
                                    returnValues(1) = returnValues(1) & "Could not enter comment for question: " & sQuestion
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter comment for checkbox question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                End If
                            End If


                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Could not click the check box: " & sSecond_Review_Answer & " for question: " & sQuestion
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click the check box for: " & sSecond_Review_Answer & "for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                        End If
                    End If


                Case Is = "RADIOBUTTON"
                    If Not sSecond_Review_Answer_ID = String.Empty Then
                        Dim oRadioButton As New AutomationObject
                        oRadioButton.aObject = driver.FindElement(By.XPath("//Input[@value='" & sSecond_Review_Answer_ID & "']"))

                        If Not oRadioButton.aObject Is Nothing Then
                            oRadioButton.aElement = DirectCast(oRadioButton.aObject, IWebElement)
                            oRadioButton.aElement.Click()
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked radio button: " & sSecond_Review_Answer & " for " & sQuestion, myLogPath, , actionHistoryRecordID)

                            If Not sSecond_Review_Comment = String.Empty Then
                                Dim sTextAreaXPath As String = "//Input [@name='f06' and @value='"
                                sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::textarea[1]"
                                'Dim FindTextArea_Object As Object = driver.FindElement(By.XPath("//Input [@name='f06' and @value='209']/following::textarea[1]"))
                                Dim FindTextArea_Object As Object = driver.FindElement(By.XPath(sTextAreaXPath))
                                If Not FindTextArea_Object Is Nothing Then
                                    Dim FindTextArea_Element As IWebElement = DirectCast(FindTextArea_Object, IWebElement)
                                    FindTextArea_Object.SendKeys(Keys.Control + "a")
                                    FindTextArea_Object.SendKeys(sSecond_Review_Comment)
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Entered comment for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                Else
                                    returnValues(0) = executionStatusFailed
                                    returnValues(1) = returnValues(1) & ""
                                    mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter comment for checkbox question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                                End If
                            End If
                        Else
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Could not click radio button " & sSecond_Review_Answer & "for question: " & sQuestion
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click radio button " & sSecond_Review_Answer & "for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                        End If
                    Else

                    End If
                    '<input type'="hidden" name="f07" value="265"  /><input type="text" name="f04" size="20" maxlength="2000" value=""  />
                    'input type="hidden" name="f06" value="44"  /><textarea name="f03" rows="4" cols="80" wrap="VIRTUAL" >Of course</textarea>
                Case Is = "TEXTBOX"

                    If Not sQuestionID = String.Empty Then
                        If Not sSecond_Review_Answer = String.Empty Then
                            Dim FindTextArea As New AutomationObject
                            Dim sTextAreaXPath As String = "//Input [@name='f07' and @value='"
                            sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::input[1]"
                            FindTextArea.aObject = driver.FindElement(By.XPath(sTextAreaXPath))

                            If Not FindTextArea.aObject Is Nothing Then
                                FindTextArea.aElement = DirectCast(FindTextArea.aObject, IWebElement)
                                FindTextArea.aElement.SendKeys(Keys.Control + "a")
                                FindTextArea.aElement.SendKeys(sSecond_Review_Answer)
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered " & sSecond_Review_Answer & " in text box for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            Else
                                returnValues(0) = executionStatusFailed
                                returnValues(1) = returnValues(1) & "Could not enter enter " & sSecond_Review_Answer & " in text box for question: " & sQuestion
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter enter " & sSecond_Review_Answer & " in text box for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            End If
                        End If
                    End If

                Case Is = "TEXTAREA"

                    If Not sQuestionID = String.Empty Then
                        If Not sSecond_Review_Answer = String.Empty Then
                            Dim FindTextArea As New AutomationObject
                            Dim sTextAreaXPath As String = "//Input [@name='f06' and @value='"
                            sTextAreaXPath = sTextAreaXPath & sQuestionID & "']/following::textarea[1]"
                            FindTextArea.aObject = driver.FindElement(By.XPath(sTextAreaXPath))
                            If Not FindTextArea.aObject Is Nothing Then
                                FindTextArea.aElement = DirectCast(FindTextArea.aObject, IWebElement)
                                FindTextArea.aElement.SendKeys(Keys.Control + "a")
                                FindTextArea.aElement.SendKeys(sSecond_Review_Answer)
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Entered answer in text area for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            Else
                                returnValues(0) = executionStatusFailed
                                returnValues(1) = returnValues(1) & "Could not enter answer in text area for question: " & sQuestion
                                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not enter answer in text area for question: " & sQuestion, myLogPath, , actionHistoryRecordID)
                            End If
                        End If
                    End If


            End Select




ThresholdFinalQuestion:
            Dim SCompleteXPath As String = Nothing
            Dim SFullFilledXPath As String = Nothing
            If CleanString(sReview_Phase) = "THRESHOLD" Then
                If CleanString(sReview_Complete) = "YES" Then

                    SCompleteXPath = "//input[@id='P7019_IS_COMPLETE_0']"
                Else
                    If CleanString(sReview_Complete) = "NO" Then
                        SCompleteXPath = "//input[@id='P7019_IS_COMPLETE_1']"
                    Else
                        If Not String.IsNullOrEmpty(sReview_Complete) Then
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No."
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                        Else
                            GoTo IsFulfilled
                        End If
                    End If
                End If
            Else
                GoTo ClickScoringComplete
            End If

            'Dim sFullFilledXPath As String = "//input[@id='P7019_IS_COMPLETE_0']"
            'Click the action button
            Dim aoThreshTypeComplete As New AutomationObject
            aoThreshTypeComplete.aObject = WaitForElement(driver, WaitForTime, By.XPath(SCompleteXPath))
            If Not aoThreshTypeComplete.aObject Is Nothing Then
                aoThreshTypeComplete.aElement = DirectCast(aoThreshTypeComplete.aObject, IWebElement)
                If aoThreshTypeComplete.aElement.Selected = True Then
                    'Okay as is
                Else
                    aoThreshTypeComplete.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked " & sReview_Complete & " radio button for Is the Review Complete?", myLogPath, , actionHistoryRecordID)
                End If
            Else
                returnValues(0) = executionStatusFailedAbort
                returnValues(1) = returnValues(1) & "Could not click " & sReview_Complete & " for Is the Review Complete?: "
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not click " & sReview_Complete & " for Is the Review Complete?: ", myLogPath, , actionHistoryRecordID)
            End If

IsFulfilled:
            If CleanString(sFulFill_Guidelines) = "YES" Then

                SFullFilledXPath = "//input[@id='P7019_IS_FULFILLED_0']"
            Else
                If CleanString(sFulFill_Guidelines) = "NO" Then
                    SFullFilledXPath = "//input[@id='P7019_IS_FULFILLED_1']"
                ElseIf Not String.IsNullOrEmpty(sFulFill_Guidelines) Then
                    returnValues(0) = executionStatusFailed
                    returnValues(1) = returnValues(1) & "Invalid value specified for if threshold fulfilled: " & sFulFill_Guidelines & ". Expected Yes or No."
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for if threshold fulfilled: " & sFulFill_Guidelines & ". Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                Else
                    GoTo ClickApplyChanges
                End If
            End If
            Dim aoThreshTypeFulFilled As New AutomationObject
            aoThreshTypeFulFilled.aObject = WaitForElement(driver, WaitForTime, By.XPath(SFullFilledXPath))
            If Not aoThreshTypeFulFilled.aObject Is Nothing Then
                aoThreshTypeFulFilled.aElement = DirectCast(aoThreshTypeFulFilled.aObject, IWebElement)
                If aoThreshTypeFulFilled.aElement.Selected = True Then
                    'Okay as is
                Else
                    aoThreshTypeFulFilled.aElement.Click()
                    mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked " & sFulFill_Guidelines & " radio button for Is the Threshold Fulfilled?", myLogPath, , actionHistoryRecordID)

                End If
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not find click " & sFulFill_Guidelines & " radio button for Is the Threshold Fulfilled?"
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not find click " & sFulFill_Guidelines & " radio button for Is the Threshold Fulfilled?", myLogPath, , actionHistoryRecordID)
            End If
            GoTo ClickApplyChanges

ClickScoringComplete:
            Dim SScoreCompleteXPath As String = Nothing
            If CleanString(sReview_Phase) = "SCORING" Then
                If CleanString(sReview_Complete) = "YES" Then

                    SCompleteXPath = "//input[@id='P7023_IS_COMPLETE_0']"
                Else
                    If CleanString(sReview_Complete) = "NO" Then
                        SCompleteXPath = "//input[@id='P7023_IS_COMPLETE_1']"
                    Else
                        If Not String.IsNullOrEmpty(sReview_Complete) Then
                            returnValues(0) = executionStatusFailed
                            returnValues(1) = returnValues(1) & "Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No."
                            mosaicDll.Logger(senderMCPAction, "Actual Result| Invalid value specified for if review complete: " & sReview_Complete & ". Expected Yes or No.", myLogPath, , actionHistoryRecordID)
                        Else
                            GoTo ClickApplyChanges
                        End If
                    End If
                End If
            End If


ClickApplyChanges:
            Dim sApplChangesXpath As String = Nothing

            If CleanString(sReview_Phase) = "SCORING" Then
                sApplChangesXpath = "//a[@id='P7023_APPLY_CHANGES']/font/span"
            Else
                sApplChangesXpath = "//a[@id='P7019_APPLY_CHANGES']/font/span"
            End If

            'Dim sApplChangesXpath As String = "/html/body/form/table[2]/tbody/tr[6]/td[2]/table/tbody/tr/td[2]/div[2]/table[2]/tbody/tr[2]/td/table/tbody/tr/td[2]/a/font/span"
            Dim aApplyChanges As New AutomationObject
            aApplyChanges.aObject = WaitForElement(driver, WaitForTime, By.XPath(sApplChangesXpath))
            If Not aApplyChanges.aObject Is Nothing Then
                aApplyChanges.aElement = DirectCast(aApplyChanges.aObject, IWebElement)
                aApplyChanges.aElement.Click()
                mosaicDll.Logger(senderMCPAction, "Actual Result| Clicked Apply Changes", myLogPath, , actionHistoryRecordID)
            Else
                returnValues(0) = executionStatusFailed
                returnValues(1) = returnValues(1) & "Could not find click Apply Changes "
                mosaicDll.Logger(senderMCPAction, "Actual Result| Could not find click Apply Changes ", myLogPath, , actionHistoryRecordID)
            End If
            Return returnValues
        Catch ex As Exception
            returnValues(0) = executionStatusFailed
            returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
            mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
            mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
            Return returnValues
        End Try
    End Function

#End Region

    Protected Overrides Sub Finalize()
        MyBase.Finalize()
    End Sub

End Class

Public Function ta_NAV_navigate_to_ahaonlinestore(ByVal mcpParameters() As Object) As Object()
    Dim returnValues() As Object = New Object() {executionStatusPassed, ""}
    Dim excelPath As String = CType(mcpParameters(0), String)
    Dim iteration As Integer = CType(mcpParameters(1), Integer)
    Dim actionHistoryRecordID As Integer = CType(mcpParameters(2), Integer)
    Try
        '        ''''''''''''''''''''
        ' Do something here.
        ''''''''''''''''''''
        '        ' ( **** Remove the next 2 (or 3) lines once the test action function is ready for testing. ****)
        returnValues(1) = "(* Dummy action *)"
        mosaicDll.Logger(senderMCPAction, "Actual Result|Dummy action", myLogPath, , actionHistoryRecordID)
        Return returnValues
    Catch ex As Exception
        returnValues(0) = executionStatusFailed
        returnValues(1) = CStr(returnValues(1)) & " Exception: " & ex.Message
        mosaicDll.Logger(senderMCPAction, exceptionErrorMsg, myLogPath, , actionHistoryRecordID)
        mosaicDll.Logger(senderMCPAction, "Error|Exception: '" & ex.Message & "'", myLogPath, , actionHistoryRecordID)
        Return returnValues
    End Try
End Function